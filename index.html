<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Ruby Style Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .cd {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Ruby Style Guide</h1>
<div id="toc" class="toc2">
<div id="toctitle"><h2>Table of Contents</h2></div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#guiding-principles">Guiding Principles</a></li>
<li><a href="#a-note-about-consistency">A Note about Consistency</a></li>
<li><a href="#translations">Translations</a></li>
</ul>
</li>
<li><a href="#source-code-layout">Source Code Layout</a>
<ul class="sectlevel2">
<li><a href="#utf-8">Source Encoding</a></li>
<li><a href="#tabs-or-spaces">Tabs or Spaces?</a></li>
<li><a href="#spaces-indentation">Indentation</a></li>
<li><a href="#max-line-length">Maximum Line Length</a></li>
<li><a href="#no-trailing-whitespace">No Trailing Whitespace</a></li>
<li><a href="#crlf">Line Endings</a></li>
<li><a href="#newline-eof">Should I Terminate Files with a Newline?</a></li>
<li><a href="#no-semicolon">Should I Terminate Expressions with <code>;</code>?</a></li>
<li><a href="#one-expression-per-line">One Expression Per Line</a></li>
<li><a href="#operator-method-call">Operator Method Call</a></li>
<li><a href="#spaces-operators">Spaces and Operators</a></li>
<li><a href="#safe-navigation">Safe navigation</a></li>
<li><a href="#spaces-braces">Spaces and Braces</a></li>
<li><a href="#no-space-bang">No Space after Bang</a></li>
<li><a href="#no-space-inside-range-literals">No Space inside Range Literals</a></li>
<li><a href="#indent-when-to-case">Indent <code>when</code> to <code>case</code></a></li>
<li><a href="#indent-conditional-assignment">Indent Conditional Assignment</a></li>
<li><a href="#empty-lines-between-methods">Empty Lines between Methods</a></li>
<li><a href="#two-or-more-empty-lines">Two or More Empty Lines</a></li>
<li><a href="#empty-lines-around-attribute-accessor">Empty Lines around Attribute Accessor</a></li>
<li><a href="#empty-lines-around-access-modifier">Empty Lines around Access Modifier</a></li>
<li><a href="#empty-lines-around-bodies">Empty Lines around Bodies</a></li>
<li><a href="#no-trailing-params-comma">Trailing Comma in Method Arguments</a></li>
<li><a href="#spaces-around-equals">Spaces around Equals</a></li>
<li><a href="#no-trailing-backslash">Line Continuation in Expressions</a></li>
<li><a href="#consistent-multi-line-chains">Multi-line Method Chains</a></li>
<li><a href="#no-double-indent">Method Arguments Alignment</a></li>
<li><a href="#no-braces-opts-hash">Implicit Options Hash</a></li>
<li><a href="#no-dsl-decorating">DSL Method Calls</a></li>
<li><a href="#parens-no-spaces">Space in Method Calls</a></li>
<li><a href="#space-in-brackets-access">Space in Brackets Access</a></li>
<li><a href="#align-multiline-arrays">Multi-line Arrays Alignment</a></li>
</ul>
</li>
<li><a href="#naming-conventions">Naming Conventions</a>
<ul class="sectlevel2">
<li><a href="#english-identifiers">English for Identifiers</a></li>
<li><a href="#snake-case-symbols-methods-vars">Snake Case for Symbols, Methods and Variables</a></li>
<li><a href="#snake-case-symbols-methods-vars-with-numbers">Identifiers with a Numeric Suffix</a></li>
<li><a href="#camelcase-classes">CapitalCase for Classes and Modules</a></li>
<li><a href="#snake-case-files">Snake Case for Files</a></li>
<li><a href="#snake-case-dirs">Snake Case for Directories</a></li>
<li><a href="#one-class-per-file">One Class per File</a></li>
<li><a href="#screaming-snake-case">Screaming Snake Case for Constants</a></li>
<li><a href="#bool-methods-qmark">Predicate Methods Suffix</a></li>
<li><a href="#bool-methods-prefix">Predicate Methods Prefix</a></li>
<li><a href="#dangerous-method-bang">Dangerous Method Suffix</a></li>
<li><a href="#safe-because-unsafe">Relationship between Safe and Dangerous Methods</a></li>
<li><a href="#underscore-unused-vars">Unused Variables Prefix</a></li>
<li><a href="#other-arg"><code>other</code> Parameter</a></li>
</ul>
</li>
<li><a href="#flow-of-control">Flow of Control</a>
<ul class="sectlevel2">
<li><a href="#no-for-loops"><code>for</code> Loops</a></li>
<li><a href="#no-then"><code>then</code> in Multi-line Expression</a></li>
<li><a href="#same-line-condition">Condition Placement</a></li>
<li><a href="#ternary-operator">Ternary Operator vs <code>if</code></a></li>
<li><a href="#no-nested-ternary">Nested Ternary Operators</a></li>
<li><a href="#no-semicolon-ifs">Semicolon in <code>if</code></a></li>
<li><a href="#case-vs-if-else"><code>case</code> vs <code>if-else</code></a></li>
<li><a href="#use-if-case-returns">Returning Result from <code>if</code>/<code>case</code></a></li>
<li><a href="#one-line-cases">One-line Cases</a></li>
<li><a href="#no-when-semicolons">Semicolon in <code>when</code></a></li>
<li><a href="#no-in-pattern-semicolons">Semicolon in <code>in</code></a></li>
<li><a href="#bang-not-not"><code>!</code> vs <code>not</code></a></li>
<li><a href="#no-bang-bang">Double Negation</a></li>
<li><a href="#and-or-flow"><code>and</code>/<code>or</code> </a></li>
<li><a href="#no-multiline-ternary">Multi-line Ternary Operator</a></li>
<li><a href="#if-as-a-modifier"><code>if</code> as a Modifier</a></li>
<li><a href="#no-multiline-if-modifiers">Multi-line <code>if</code> Modifiers</a></li>
<li><a href="#no-nested-modifiers">Nested Modifiers</a></li>
<li><a href="#unless-for-negatives"><code>if</code> vs <code>unless</code></a></li>
<li><a href="#no-else-with-unless">Using <code>else</code> with <code>unless</code></a></li>
<li><a href="#no-parens-around-condition">Parentheses around Condition</a></li>
<li><a href="#no-multiline-while-do">Multi-line <code>while do</code></a></li>
<li><a href="#while-as-a-modifier"><code>while</code> as a Modifier</a></li>
<li><a href="#until-for-negatives"><code>while</code> vs <code>until</code></a></li>
<li><a href="#infinite-loop">Infinite Loop</a></li>
<li><a href="#loop-with-break"><code>loop</code> with <code>break</code></a></li>
<li><a href="#no-explicit-return">Explicit <code>return</code></a></li>
<li><a href="#no-self-unless-required">Explicit <code>self</code></a></li>
<li><a href="#no-shadowing">Shadowing Methods</a></li>
<li><a href="#safe-assignment-in-condition">Safe Assignment in Condition</a></li>
<li><a href="#no-BEGIN-blocks"><code>BEGIN</code> Blocks</a></li>
<li><a href="#no-END-blocks"><code>END</code> Blocks</a></li>
<li><a href="#no-nested-conditionals">Nested Conditionals</a></li>
</ul>
</li>
<li><a href="#exceptions">Exceptions</a>
<ul class="sectlevel2">
<li><a href="#prefer-raise-over-fail"><code>raise</code> vs <code>fail</code></a></li>
<li><a href="#no-explicit-runtimeerror">Raising Explicit <code>RuntimeError</code></a></li>
<li><a href="#exception-class-messages">Exception Class Messages</a></li>
<li><a href="#no-return-ensure"><code>return</code> from <code>ensure</code></a></li>
<li><a href="#begin-implicit">Implicit <code>begin</code></a></li>
<li><a href="#contingency-methods">Contingency Methods</a></li>
<li><a href="#dont-hide-exceptions">Suppressing Exceptions</a></li>
<li><a href="#no-rescue-modifiers">Using <code>rescue</code> as a Modifier</a></li>
<li><a href="#no-exceptional-flows">Using Exceptions for Flow of Control</a></li>
<li><a href="#no-blind-rescues">Blind Rescues</a></li>
<li><a href="#exception-ordering">Exception Rescuing Ordering</a></li>
<li><a href="#standard-exceptions">Standard Exceptions</a></li>
</ul>
</li>
<li><a href="#files">Files</a>
<ul class="sectlevel2">
<li><a href="#file-read">Reading from a file</a></li>
<li><a href="#file-write">Writing to a file</a></li>
<li><a href="#release-resources">Release External Resources</a></li>
<li><a href="#auto-release-resources">Auto-release External Resources</a></li>
<li><a href="#atomic-file-operations">Atomic File Operations</a></li>
<li><a href="#null-devices">Null Devices</a></li>
</ul>
</li>
<li><a href="#assignment-comparison">Assignment &amp; Comparison</a>
<ul class="sectlevel2">
<li><a href="#parallel-assignment">Parallel Assignment</a></li>
<li><a href="#values-swapping">Values Swapping</a></li>
<li><a href="#trailing-underscore-variables">Dealing with Trailing Underscore Variables in Destructuring Assignment</a></li>
<li><a href="#self-assignment">Self-assignment</a></li>
<li><a href="#double-pipe-for-uninit">Conditional Variable Initialization Shorthand</a></li>
<li><a href="#double-amper-preprocess">Existence Check Shorthand</a></li>
<li><a href="#identity-comparison">Identity Comparison</a></li>
<li><a href="#no-case-equality">Explicit Use of the Case Equality Operator</a></li>
<li><a href="#is-a-vs-kind-of"><code>is_a?</code> vs <code>kind_of?</code></a></li>
<li><a href="#is-a-vs-instance-of"><code>is_a?</code> vs <code>instance_of?</code></a></li>
<li><a href="#instance-of-vs-class-comparison"><code>instance_of?</code> vs class comparison</a></li>
<li><a href="#eql"><code>==</code> vs <code>eql?</code></a></li>
</ul>
</li>
<li><a href="#blocks-procs-lambdas">Blocks, Procs &amp; Lambdas</a>
<ul class="sectlevel2">
<li><a href="#single-action-blocks">Proc Application Shorthand</a></li>
<li><a href="#single-line-blocks">Single-line Blocks Delimiters</a></li>
<li><a href="#single-line-do-end-block">Single-line <code>do</code>&#8230;&#8203;<code>end</code> block</a></li>
<li><a href="#block-argument">Explicit Block Argument</a></li>
<li><a href="#no-trailing-parameters-comma">Trailing Comma in Block Parameters</a></li>
<li><a href="#no-nested-methods">Nested Method Definitions</a></li>
<li><a href="#lambda-multi-line">Multi-line Lambda Definition</a></li>
<li><a href="#stabby-lambda-with-args">Stabby Lambda Definition with Parameters</a></li>
<li><a href="#stabby-lambda-no-args">Stabby Lambda Definition without Parameters</a></li>
<li><a href="#proc"><code>proc</code> vs <code>Proc.new</code></a></li>
<li><a href="#proc-call">Proc Call</a></li>
</ul>
</li>
<li><a href="#methods">Methods</a>
<ul class="sectlevel2">
<li><a href="#short-methods">Short Methods</a></li>
<li><a href="#top-level-methods">Top-Level Methods</a></li>
<li><a href="#no-single-line-methods">No Single-line Methods</a></li>
<li><a href="#endless-methods">Endless Methods</a></li>
<li><a href="#ambiguous-endless-method-defintions">Ambiguous Endless Method Definitions</a></li>
<li><a href="#double-colons">Double Colons</a></li>
<li><a href="#colon-method-definition">Colon Method Definition</a></li>
<li><a href="#method-parens">Method Definition Parentheses</a></li>
<li><a href="#method-call-parentheses">Method Call Parentheses </a></li>
<li><a href="#too-many-params">Too Many Params</a></li>
<li><a href="#optional-arguments">Optional Arguments</a></li>
<li><a href="#keyword-arguments-order">Keyword Arguments Order</a></li>
<li><a href="#boolean-keyword-arguments">Boolean Keyword Arguments</a></li>
<li><a href="#keyword-arguments-vs-optional-arguments">Keyword Arguments vs Optional Arguments</a></li>
<li><a href="#keyword-arguments-vs-option-hashes">Keyword Arguments vs Option Hashes</a></li>
<li><a href="#merging-keyword-arguments">Merging Keyword Arguments</a></li>
<li><a href="#arguments-forwarding">Arguments Forwarding</a></li>
<li><a href="#block-forwarding">Block Forwarding</a></li>
<li><a href="#private-global-methods">Private Global Methods</a></li>
</ul>
</li>
<li><a href="#classes-modules">Classes &amp; Modules</a>
<ul class="sectlevel2">
<li><a href="#consistent-classes">Consistent Classes</a></li>
<li><a href="#mixin-grouping">Mixin Grouping</a></li>
<li><a href="#single-line-classes">Single-line Classes</a></li>
<li><a href="#file-classes">File Classes</a></li>
<li><a href="#namespace-definition">Namespace Definition</a></li>
<li><a href="#modules-vs-classes">Modules vs Classes</a></li>
<li><a href="#module-function"><code>module_function</code></a></li>
<li><a href="#liskov">Liskov</a></li>
<li><a href="#solid-design">SOLID design</a></li>
<li><a href="#define-to-s">Define <code>to_s</code></a></li>
<li><a href="#attr_family"><code>attr</code> Family</a></li>
<li><a href="#accessor_mutator_method_names">Accessor/Mutator Method Names</a></li>
<li><a href="#attr"><code>attr</code></a></li>
<li><a href="#struct-new"><code>Struct.new</code></a></li>
<li><a href="#no-extend-struct-new">Don&#8217;t Extend <code>Struct.new</code></a></li>
<li><a href="#no-extend-data-define">Don&#8217;t Extend <code>Data.define</code></a></li>
<li><a href="#duck-typing">Duck Typing</a></li>
<li><a href="#no-class-vars">No Class Vars</a></li>
<li><a href="#visibility">Leverage Access Modifiers (e.g. <code>private</code> and <code>protected</code>)</a></li>
<li><a href="#indent-public-private-protected">Access Modifiers Indentation</a></li>
<li><a href="#def-self-class-methods">Defining Class Methods</a></li>
<li><a href="#alias-method-lexically">Alias Method Lexically</a></li>
<li><a href="#alias-method"><code>alias_method</code></a></li>
<li><a href="#class-and-self">Class and <code>self</code></a></li>
<li><a href="#no-constant-definition-in-block">Defining Constants within a Block</a></li>
</ul>
</li>
<li><a href="#classes-constructors">Classes: Constructors</a>
<ul class="sectlevel2">
<li><a href="#factory-methods">Factory Methods</a></li>
<li><a href="#disjunctive-assignment-in-constructor">Disjunctive Assignment in Constructor</a></li>
</ul>
</li>
<li><a href="#comments">Comments</a>
<ul class="sectlevel2">
<li><a href="#no-comments">No Comments</a></li>
<li><a href="#rationale-comments">Rationale Comments</a></li>
<li><a href="#english-comments">English Comments</a></li>
<li><a href="#hash-space">Hash Space</a></li>
<li><a href="#english-syntax">English Syntax</a></li>
<li><a href="#no-superfluous-comments">No Superfluous Comments</a></li>
<li><a href="#comment-upkeep">Comment Upkeep</a></li>
<li><a href="#refactor-dont-comment">Refactor, Don&#8217;t Comment</a></li>
</ul>
</li>
<li><a href="#comment-annotations">Comment Annotations</a>
<ul class="sectlevel2">
<li><a href="#annotate-above">Annotations Placement</a></li>
<li><a href="#annotate-keywords">Annotations Keyword Format</a></li>
<li><a href="#indent-annotations">Multi-line Annotations Indentation</a></li>
<li><a href="#rare-eol-annotations">Inline Annotations</a></li>
<li><a href="#todo"><code>TODO</code></a></li>
<li><a href="#fixme"><code>FIXME</code></a></li>
<li><a href="#optimize"><code>OPTIMIZE</code></a></li>
<li><a href="#hack"><code>HACK</code></a></li>
<li><a href="#review"><code>REVIEW</code></a></li>
<li><a href="#document-annotations">Document Annotations</a></li>
</ul>
</li>
<li><a href="#magic-comments">Magic Comments</a>
<ul class="sectlevel2">
<li><a href="#magic-comments-first">Magic Comments First</a></li>
<li><a href="#below-shebang">Below Shebang</a></li>
<li><a href="#one-magic-comment-per-line">One Magic Comment per Line</a></li>
<li><a href="#separate-magic-comments-from-code">Separate Magic Comments from Code</a></li>
</ul>
</li>
<li><a href="#collections">Collections</a>
<ul class="sectlevel2">
<li><a href="#literal-array-hash">Literal Array and Hash</a></li>
<li><a href="#percent-w"><code>%w</code></a></li>
<li><a href="#percent-i"><code>%i</code></a></li>
<li><a href="#no-trailing-array-commas">No Trailing Array Commas</a></li>
<li><a href="#no-gappy-arrays">No Gappy Arrays</a></li>
<li><a href="#first-and-last"><code>first</code> and <code>last</code></a></li>
<li><a href="#set-vs-array">Set vs Array</a></li>
<li><a href="#symbols-as-keys">Symbols as Keys</a></li>
<li><a href="#no-mutable-keys">No Mutable Keys</a></li>
<li><a href="#no-mutable-defaults">No Mutable Defaults</a></li>
<li><a href="#hash-literals">Hash Literals</a></li>
<li><a href="#hash-literal-values">Hash Literal Values</a></li>
<li><a href="#hash-literal-as-last-array-item">Hash Literal as Last Array Item</a></li>
<li><a href="#no-mixed-hash-syntaxes">No Mixed Hash Syntaxes</a></li>
<li><a href="#avoid-hash-constructor">Avoid Hash[] constructor</a></li>
<li><a href="#hash-key"><code>Hash#key?</code></a></li>
<li><a href="#hash-each"><code>Hash#each</code></a></li>
<li><a href="#hash-fetch"><code>Hash#fetch</code></a></li>
<li><a href="#hash-fetch-defaults"><code>Hash#fetch</code> defaults</a></li>
<li><a href="#use-hash-blocks">Use Hash Blocks</a></li>
<li><a href="#hash-values-at-and-hash-fetch-values"><code>Hash#values_at</code> and <code>Hash#fetch_values</code></a></li>
<li><a href="#hash-transform-methods"><code>Hash#transform_keys</code> and <code>Hash#transform_values</code></a></li>
<li><a href="#ordered-hashes">Ordered Hashes</a></li>
<li><a href="#no-modifying-collections">No Modifying Collections</a></li>
<li><a href="#accessing-elements-directly">Accessing Elements Directly</a></li>
<li><a href="#provide-alternate-accessor-to-collections">Provide Alternate Accessor to Collections</a></li>
<li><a href="#map-find-select-reduce-include-size"><code>map</code>/<code>find</code>/<code>select</code>/<code>reduce</code>/<code>include?</code>/<code>size</code></a></li>
<li><a href="#count-vs-size"><code>count</code> vs <code>size</code></a></li>
<li><a href="#flat-map"><code>flat_map</code></a></li>
<li><a href="#reverse-each"><code>reverse_each</code></a></li>
<li><a href="#object-yield-self-vs-object-then"><code>Object#yield_self</code> vs <code>Object#then</code></a></li>
<li><a href="#slicing-with-ranges">Slicing with Ranges</a></li>
</ul>
</li>
<li><a href="#numbers">Numbers</a>
<ul class="sectlevel2">
<li><a href="#underscores-in-numerics">Underscores in Numerics</a></li>
<li><a href="#numeric-literal-prefixes">Numeric Literal Prefixes</a></li>
<li><a href="#integer-type-checking">Integer Type Checking</a></li>
<li><a href="#random-numbers">Random Numbers</a></li>
<li><a href="#float-division">Float Division</a></li>
<li><a href="#float-comparison">Float Comparison</a></li>
<li><a href="#exponential-notation">Exponential Notation</a></li>
</ul>
</li>
<li><a href="#strings">Strings</a>
<ul class="sectlevel2">
<li><a href="#string-interpolation">String Interpolation</a></li>
<li><a href="#consistent-string-literals">Consistent String Literals</a></li>
<li><a href="#no-character-literals">No Character Literals</a></li>
<li><a href="#curlies-interpolate">Curlies Interpolate</a></li>
<li><a href="#no-to-s">No <code>to_s</code></a></li>
<li><a href="#concat-strings">String Concatenation</a></li>
<li><a href="#dont-abuse-gsub">Don&#8217;t Abuse <code>gsub</code></a></li>
<li><a href="#string-chars"><code>String#chars</code></a></li>
<li><a href="#sprintf"><code>sprintf</code></a></li>
<li><a href="#named-format-tokens">Named Format Tokens</a></li>
<li><a href="#heredoc-long-strings">Long Strings</a></li>
</ul>
</li>
<li><a href="#heredocs">Heredocs</a>
<ul class="sectlevel2">
<li><a href="#squiggly-heredocs">Squiggly Heredocs</a></li>
<li><a href="#heredoc-delimiters">Heredoc Delimiters</a></li>
<li><a href="#heredoc-method-calls">Heredoc Method Calls</a></li>
<li><a href="#heredoc-argument-closing-parentheses">Heredoc Argument Closing Parentheses</a></li>
</ul>
</li>
<li><a href="#date-time">Date &amp; Time</a>
<ul class="sectlevel2">
<li><a href="#time-now"><code>Time.now</code></a></li>
<li><a href="#no-datetime">No <code>DateTime</code></a></li>
</ul>
</li>
<li><a href="#regular-expressions">Regular Expressions</a>
<ul class="sectlevel2">
<li><a href="#no-regexp-for-plaintext">Plain Text Search</a></li>
<li><a href="#regexp-string-index">Using Regular Expressions as String Indexes</a></li>
<li><a href="#non-capturing-regexp">Prefer Non-capturing Groups</a></li>
<li><a href="#do-not-mix-named-and-numbered-captures">Do not mix named and numbered captures</a></li>
<li><a href="#refer-named-regexp-captures-by-name">Refer named regexp captures by name</a></li>
<li><a href="#no-perl-regexp-last-matchers">Avoid Perl-style Last Regular Expression Group Matchers</a></li>
<li><a href="#no-numbered-regexes">Avoid Numbered Groups</a></li>
<li><a href="#limit-escapes">Limit Escapes</a></li>
<li><a href="#caret-and-dollar-regexp">Caret and Dollar Regexp</a></li>
<li><a href="#multi-line-regexes">Multi-line Regular Expressions</a></li>
<li><a href="#comment-regexes">Comment Complex Regular Expressions</a></li>
<li><a href="#gsub-blocks">Use <code>gsub</code> with a Block or a Hash for Complex Replacements</a></li>
</ul>
</li>
<li><a href="#percent-literals">Percent Literals</a>
<ul class="sectlevel2">
<li><a href="#percent-q-shorthand"><code>%q</code> shorthand</a></li>
<li><a href="#percent-q"><code>%q</code></a></li>
<li><a href="#percent-r"><code>%r</code></a></li>
<li><a href="#percent-x"><code>%x</code></a></li>
<li><a href="#percent-s"><code>%s</code></a></li>
<li><a href="#percent-literal-braces">Percent Literal Braces</a></li>
</ul>
</li>
<li><a href="#metaprogramming">Metaprogramming</a>
<ul class="sectlevel2">
<li><a href="#no-needless-metaprogramming">No Needless Metaprogramming</a></li>
<li><a href="#no-monkey-patching">No Monkey Patching</a></li>
<li><a href="#block-class-eval">Block <code>class_eval</code></a></li>
<li><a href="#eval-comment-docs"><code>eval</code> Comment Docs</a></li>
<li><a href="#no-method-missing">No <code>method_missing</code></a></li>
<li><a href="#prefer-public-send">Prefer <code>public_send</code></a></li>
<li><a href="#prefer-__send__">Prefer <code>__send__</code></a></li>
</ul>
</li>
<li><a href="#api-documentation">API Documentation</a>
<ul class="sectlevel2">
<li><a href="#yard">YARD</a></li>
<li><a href="#no-block-comments">RD (Block) Comments</a></li>
</ul>
</li>
<li><a href="#gemfile-and-gemspec">Gemfile and Gemspec</a>
<ul class="sectlevel2">
<li><a href="#no-ruby-version-in-the-gemspec">No <code>RUBY_VERSION</code> in the gemspec</a></li>
<li><a href="#add_dependency_vs_add_runtime_dependency"><code>add_dependency</code> vs <code>add_runtime_dependency</code></a></li>
</ul>
</li>
<li><a href="#misc">Misc</a>
<ul class="sectlevel2">
<li><a href="#no-flip-flops">No Flip-flops</a></li>
<li><a href="#no-non-nil-checks">No non-<code>nil</code> Checks</a></li>
<li><a href="#global-stdout">Global Input/Output Streams</a></li>
<li><a href="#warn">Warn</a></li>
<li><a href="#array-join"><code>Array#join</code></a></li>
<li><a href="#array-coercion">Array Coercion</a></li>
<li><a href="#ranges-or-between">Ranges or <code>between</code></a></li>
<li><a href="#predicate-methods">Predicate Methods</a></li>
<li><a href="#bitwise-predicate-methods">Bitwise Predicate Methods</a></li>
<li><a href="#no-cryptic-perlisms">No Cryptic Perlisms</a></li>
<li><a href="#use-require_relative-whenever-possible">Use <code>require_relative</code> whenever possible</a></li>
<li><a href="#always-warn">Always Warn</a></li>
<li><a href="#no-optional-hash-params">No Optional Hash Params</a></li>
<li><a href="#instance-vars">Instance Vars</a></li>
<li><a href="#optionparser"><code>OptionParser</code></a></li>
<li><a href="#no-param-mutations">No Param Mutations</a></li>
<li><a href="#three-is-the-number-thou-shalt-count">Three is the Number Thou Shalt Count</a></li>
<li><a href="#functional-code">Functional Code</a></li>
<li><a href="#no-explicit-rb-to-require">No explicit <code>.rb</code> to <code>require</code></a></li>
<li><a href="#avoid-tap">Avoid <code>tap</code></a></li>
</ul>
</li>
<li><a href="#tools">Tools</a>
<ul class="sectlevel2">
<li><a href="#rubocop">RuboCop</a></li>
<li><a href="#rubymine">RubyMine</a></li>
</ul>
</li>
<li><a href="#history">History</a></li>
<li><a href="#sources-of-inspiration">Sources of Inspiration</a></li>
<li><a href="#contributing">Contributing</a>
<ul class="sectlevel2">
<li><a href="#how-to-contribute">How to Contribute?</a></li>
</ul>
</li>
<li><a href="#colophon">Colophon</a></li>
<li><a href="#license">License</a></li>
<li><a href="#spread-the-word">Spread the Word</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a><a class="link" href="#introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Role models are important.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Officer Alex J. Murphy / RoboCop
</div>
</div>
<div class="paragraph">
<p>This Ruby style guide recommends best practices so that real-world Ruby programmers can write code that can be maintained by other real-world Ruby programmers.
A style guide that reflects real-world usage gets used, while a style guide that holds to an ideal that has been rejected by the people it is supposed to help risks not getting used at all - no matter how good it is.</p>
</div>
<div class="paragraph">
<p>The guide is separated into several sections of related guidelines.
We&#8217;ve tried to add the rationale behind the guidelines (if it&#8217;s omitted we&#8217;ve assumed it&#8217;s pretty obvious).</p>
</div>
<div class="paragraph">
<p>We didn&#8217;t come up with all the guidelines out of nowhere - they are mostly based on the professional experience of the editors, feedback and suggestions from members of the Ruby community and various highly regarded Ruby programming resources, such as <a href="https://pragprog.com/book/ruby4/programming-ruby-1-9-2-0">"Programming Ruby"</a> and <a href="https://www.amazon.com/Ruby-Programming-Language-David-Flanagan/dp/0596516177">"The Ruby Programming Language"</a>.</p>
</div>
<div class="paragraph">
<p>This style guide evolves over time as additional conventions are identified and past conventions are rendered obsolete by changes in Ruby itself.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you&#8217;re into Rails or RSpec you might want to check out the complementary <a href="https://github.com/rubocop/rails-style-guide">Ruby on Rails Style Guide</a> and <a href="https://github.com/rubocop/rspec-style-guide">RSpec Style Guide</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<a href="https://github.com/rubocop/rubocop">RuboCop</a> is a static code analyzer (linter) and formatter, based on this style guide.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="guiding-principles"><a class="anchor" href="#guiding-principles"></a><a class="link" href="#guiding-principles">Guiding Principles</a></h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Programs must be written for people to read, and only incidentally for machines to execute.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Harold Abelson<br>
<cite>Structure and Interpretation of Computer Programs</cite>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s common knowledge that code is read much more often than it is written.
The guidelines provided here are intended to improve the readability of code and make it consistent across the wide spectrum of Ruby code.
They are also meant to reflect real-world usage of Ruby instead of a random ideal. When we had to choose between a very established practice
and a subjectively better alternative we&#8217;ve opted to recommend the established practice.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
<div class="paragraph">
<p>There are some areas in which there is no clear consensus in the Ruby community regarding a particular style (like string literal quoting, spacing inside hash literals, dot position in multi-line method chaining, etc.).
In such scenarios all popular styles are acknowledged and it&#8217;s up to you to pick one and apply it consistently.</p>
</div>
<div class="paragraph">
<p>Ruby had existed for over 15 years by the time
the guide was created, and the language&#8217;s flexibility and lack of common standards have contributed to the
creation of numerous styles for just about everything. Rallying people around the cause of community standards
took a lot of time and energy, and we still have a lot of ground to cover.</p>
</div>
<div class="paragraph">
<p>Ruby is famously optimized for programmer happiness. We&#8217;d like to believe that this guide is going to help you optimize for maximum
programmer happiness.</p>
</div>
</div>
<div class="sect2">
<h3 id="a-note-about-consistency"><a class="anchor" href="#a-note-about-consistency"></a><a class="link" href="#a-note-about-consistency">A Note about Consistency</a></h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A foolish consistency is the hobgoblin of little minds, adored by little statesmen and philosophers and divines.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Ralph Waldo Emerson
</div>
</div>
<div class="paragraph">
<p>A style guide is about consistency.
Consistency with this style guide is important.
Consistency within a project is more important.
Consistency within one class or method is the most important.</p>
</div>
<div class="paragraph">
<p>However, know when to be inconsistent&#8201;&#8212;&#8201;sometimes style guide recommendations just aren&#8217;t applicable. When in doubt, use your best judgment.
Look at other examples and decide what looks best. And don&#8217;t hesitate to ask!</p>
</div>
<div class="paragraph">
<p>In particular: do not break backwards compatibility just to comply with this guide!</p>
</div>
<div class="paragraph">
<p>Some other good reasons to ignore a particular guideline:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When applying the guideline would make the code less readable, even for someone who is used to reading code that follows this style guide.</p>
</li>
<li>
<p>To be consistent with surrounding code that also breaks it (maybe for historic reasons)&#8201;&#8212;&#8201;although this is also an opportunity to clean up someone else&#8217;s mess (in true XP style).</p>
</li>
<li>
<p>Because the code in question predates the introduction of the guideline and there is no other reason to be modifying that code.</p>
</li>
<li>
<p>When the code needs to remain compatible with older versions of Ruby that don&#8217;t support the feature recommended by the style guide.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="translations"><a class="anchor" href="#translations"></a><a class="link" href="#translations">Translations</a></h3>
<div class="paragraph">
<p>Translations of the guide are available in the following languages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/JuanitoFatas/ruby-style-guide/blob/master/README-zhCN.md">Chinese Simplified</a></p>
</li>
<li>
<p><a href="https://github.com/JuanitoFatas/ruby-style-guide/blob/master/README-zhTW.md">Chinese Traditional</a></p>
</li>
<li>
<p><a href="https://github.com/HassanTC/ruby-style-guide/blob/master/README-EgAr.md">Egyptian Arabic</a></p>
</li>
<li>
<p><a href="https://github.com/gauthier-delacroix/ruby-style-guide/blob/master/README-frFR.md">French</a></p>
</li>
<li>
<p><a href="https://github.com/fortissimo1997/ruby-style-guide/blob/japanese/README.ja.md">Japanese</a></p>
</li>
<li>
<p><a href="https://github.com/dalzony/ruby-style-guide/blob/master/README-koKR.md">Korean</a></p>
</li>
<li>
<p><a href="https://github.com/rubensmabueno/ruby-style-guide/blob/master/README-PT-BR.md">Portuguese (pt-BR)</a></p>
</li>
<li>
<p><a href="https://github.com/arbox/ruby-style-guide/blob/master/README-ruRU.md">Russian</a></p>
</li>
<li>
<p><a href="https://github.com/alemohamad/ruby-style-guide/blob/master/README-esLA.md">Spanish</a></p>
</li>
<li>
<p><a href="https://github.com/CQBinh/ruby-style-guide/blob/master/README-viVN.md">Vietnamese</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These translations are not maintained by our editor team, so their quality
and level of completeness may vary. The translated versions of the guide often
lag behind the upstream English version.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="source-code-layout"><a class="anchor" href="#source-code-layout"></a><a class="link" href="#source-code-layout">Source Code Layout</a></h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Nearly everybody is convinced that every style but their own is
ugly and unreadable. Leave out the "but their own" and they&#8217;re
probably right&#8230;&#8203;</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Jerry Coffin (on indentation)
</div>
</div>
<div class="sect2">
<h3 id="utf-8"><a class="anchor" href="#utf-8"></a><a class="link" href="#utf-8">Source Encoding</a></h3>
<div class="paragraph">
<p>Use <code>UTF-8</code> as the source file encoding.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
UTF-8 has been the default source file encoding since Ruby 2.0.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="tabs-or-spaces"><a class="anchor" href="#tabs-or-spaces"></a><a class="link" href="#tabs-or-spaces">Tabs or Spaces?</a></h3>
<div class="paragraph">
<p>Use only spaces for indentation. No hard tabs.</p>
</div>
</div>
<div class="sect2">
<h3 id="spaces-indentation"><a class="anchor" href="#spaces-indentation"></a><a class="link" href="#spaces-indentation">Indentation</a></h3>
<div class="paragraph">
<p>Use two <strong>spaces</strong> per indentation level (aka soft tabs).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - four spaces</span>
<span class="k">def</span> <span class="nf">some_method</span>
    <span class="n">do_something</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span>
  <span class="n">do_something</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="max-line-length"><a class="anchor" href="#max-line-length"></a><a class="link" href="#max-line-length">Maximum Line Length</a></h3>
<div class="paragraph">
<p>Limit lines to 80 characters.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Most editors and IDEs have configuration options to help you with that.
They would typically highlight lines that exceed the length limit.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Why Bother with 80 characters in a World of Modern Widescreen Displays?</div>
<div class="paragraph">
<p>A lot of people these days feel that a maximum line length of 80 characters is
just a remnant of the past and makes little sense today. After all - modern
displays can easily fit 200+ characters on a single line.  Still, there are some
important benefits to be gained from sticking to shorter lines of code.</p>
</div>
<div class="paragraph">
<p>First, and foremost - numerous studies have shown that humans read much faster
vertically and very long lines of text impede the reading process. As noted
earlier, one of the guiding principles of this style guide is to optimize the
code we write for human consumption.</p>
</div>
<div class="paragraph">
<p>Additionally, limiting the required editor window width makes it possible to
have several files open side-by-side, and works well when using code review
tools that present the two versions in adjacent columns.</p>
</div>
<div class="paragraph">
<p>The default wrapping in most tools disrupts the visual structure of the code,
making it more difficult to understand. The limits are chosen to avoid wrapping
in editors with the window width set to 80, even if the tool places a marker
glyph in the final column when wrapping lines. Some web based tools may not
offer dynamic line wrapping at all.</p>
</div>
<div class="paragraph">
<p>Some teams strongly prefer a longer line length. For code maintained exclusively
or primarily by a team that can reach agreement on this issue, it is okay to
increase the line length limit up to 100 characters, or all the way up
to 120 characters. Please, restrain the urge to go beyond 120 characters.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-trailing-whitespace"><a class="anchor" href="#no-trailing-whitespace"></a><a class="link" href="#no-trailing-whitespace">No Trailing Whitespace</a></h3>
<div class="paragraph">
<p>Avoid trailing whitespace.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Most editors and IDEs have configuration options to visualize trailing whitespace and
to remove it automatically on save.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="crlf"><a class="anchor" href="#crlf"></a><a class="link" href="#crlf">Line Endings</a></h3>
<div class="paragraph">
<p>Use Unix-style line endings.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you&#8217;re using Git you might want to add the following configuration setting to protect your project from Windows line endings creeping in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span> git config <span class="nt">--global</span> core.autocrlf <span class="nb">true</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="newline-eof"><a class="anchor" href="#newline-eof"></a><a class="link" href="#newline-eof">Should I Terminate Files with a Newline?</a></h3>
<div class="paragraph">
<p>End each file with a newline.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
This should be done via editor configuration, not manually.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="no-semicolon"><a class="anchor" href="#no-semicolon"></a><a class="link" href="#no-semicolon">Should I Terminate Expressions with <code>;</code>?</a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>;</code> to terminate statements and expressions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">puts</span> <span class="s1">'foobar'</span><span class="p">;</span> <span class="c1"># superfluous semicolon</span>

<span class="c1"># good</span>
<span class="nb">puts</span> <span class="s1">'foobar'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="one-expression-per-line"><a class="anchor" href="#one-expression-per-line"></a><a class="link" href="#one-expression-per-line">One Expression Per Line</a></h3>
<div class="paragraph">
<p>Use one expression per line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">puts</span> <span class="s1">'foo'</span><span class="p">;</span> <span class="nb">puts</span> <span class="s1">'bar'</span> <span class="c1"># two expressions on the same line</span>

<span class="c1"># good</span>
<span class="nb">puts</span> <span class="s1">'foo'</span>
<span class="nb">puts</span> <span class="s1">'bar'</span>

<span class="nb">puts</span> <span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span> <span class="c1"># this applies to puts in particular</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="operator-method-call"><a class="anchor" href="#operator-method-call"></a><a class="link" href="#operator-method-call">Operator Method Call</a></h3>
<div class="paragraph">
<p>Avoid dot where not required for operator method calls.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">num</span><span class="p">.</span><span class="nf">+</span> <span class="mi">42</span>

<span class="c1"># good</span>
<span class="n">num</span> <span class="o">+</span> <span class="mi">42</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spaces-operators"><a class="anchor" href="#spaces-operators"></a><a class="link" href="#spaces-operators">Spaces and Operators</a></h3>
<div class="paragraph">
<p>Use spaces around operators, after commas, colons and semicolons.
Whitespace might be (mostly) irrelevant to the Ruby interpreter, but its proper use is the key to writing easily readable code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">sum</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="k">class</span> <span class="nc">FooError</span><span class="o">&lt;</span><span class="no">StandardError</span><span class="p">;</span><span class="k">end</span>

<span class="c1"># good</span>
<span class="n">sum</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">class</span> <span class="nc">FooError</span> <span class="o">&lt;</span> <span class="no">StandardError</span><span class="p">;</span> <span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a few exceptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exponent operator:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">e</span> <span class="o">=</span> <span class="no">M</span> <span class="o">*</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># good</span>
<span class="n">e</span> <span class="o">=</span> <span class="no">M</span> <span class="o">*</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Slash in rational literals:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">o_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">48</span><span class="n">r</span>

<span class="c1"># good</span>
<span class="n">o_scale</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="n">r</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Safe navigation operator:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">foo</span> <span class="o">&amp;</span><span class="p">.</span> <span class="nf">bar</span>
<span class="n">foo</span> <span class="o">&amp;</span><span class="p">.</span><span class="nf">bar</span>
<span class="n">foo</span><span class="o">&amp;</span><span class="p">.</span> <span class="nf">bar</span>

<span class="c1"># good</span>
<span class="n">foo</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">bar</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="safe-navigation"><a class="anchor" href="#safe-navigation"></a><a class="link" href="#safe-navigation">Safe navigation</a></h3>
<div class="paragraph">
<p>Avoid chaining of <code>&amp;.</code>. Replace with <code>.</code> and an explicit check.
E.g. if users are guaranteed to have an address and addresses are guaranteed to have a zip code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">user</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">address</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">zip</span>

<span class="c1"># good</span>
<span class="n">user</span> <span class="o">&amp;&amp;</span> <span class="n">user</span><span class="p">.</span><span class="nf">address</span><span class="p">.</span><span class="nf">zip</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If such a change introduces excessive conditional logic, consider other approaches, such as delegation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">user</span> <span class="o">&amp;&amp;</span> <span class="n">user</span><span class="p">.</span><span class="nf">address</span> <span class="o">&amp;&amp;</span> <span class="n">user</span><span class="p">.</span><span class="nf">address</span><span class="p">.</span><span class="nf">zip</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">User</span>
  <span class="k">def</span> <span class="nf">zip</span>
    <span class="n">address</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">zip</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">user</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">zip</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spaces-braces"><a class="anchor" href="#spaces-braces"></a><a class="link" href="#spaces-braces">Spaces and Braces</a></h3>
<div class="paragraph">
<p>No spaces after <code>(</code>, <code>[</code> or before <code>]</code>, <code>)</code>.
Use spaces around <code>{</code> and before <code>}</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">some</span><span class="p">(</span> <span class="n">arg</span> <span class="p">).</span><span class="nf">other</span>
<span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">].</span><span class="nf">each</span><span class="p">{</span><span class="o">|</span><span class="n">e</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">e</span><span class="p">}</span>

<span class="c1"># good</span>
<span class="n">some</span><span class="p">(</span><span class="n">arg</span><span class="p">).</span><span class="nf">other</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">e</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>{</code> and <code>}</code> deserve a bit of clarification, since they are used for block and hash literals, as well as string interpolation.</p>
</div>
<div class="paragraph">
<p>For hash literals two styles are considered acceptable.
The first variant is slightly more readable (and arguably more popular in the Ruby community in general).
The second variant has the advantage of adding visual difference between block and hash literals.
Whichever one you pick - apply it consistently.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good - space after { and before }</span>
<span class="p">{</span> <span class="ss">one: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">two: </span><span class="mi">2</span> <span class="p">}</span>

<span class="c1"># good - no space after { and before }</span>
<span class="p">{</span><span class="ss">one: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">two: </span><span class="mi">2</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With interpolated expressions, there should be no padded-spacing inside the braces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="s2">"From: </span><span class="si">#{</span> <span class="n">user</span><span class="p">.</span><span class="nf">first_name</span> <span class="si">}</span><span class="s2">, </span><span class="si">#{</span> <span class="n">user</span><span class="p">.</span><span class="nf">last_name</span> <span class="si">}</span><span class="s2">"</span>

<span class="c1"># good</span>
<span class="s2">"From: </span><span class="si">#{</span><span class="n">user</span><span class="p">.</span><span class="nf">first_name</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">user</span><span class="p">.</span><span class="nf">last_name</span><span class="si">}</span><span class="s2">"</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-space-bang"><a class="anchor" href="#no-space-bang"></a><a class="link" href="#no-space-bang">No Space after Bang</a></h3>
<div class="paragraph">
<p>No space after <code>!</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="o">!</span> <span class="n">something</span>

<span class="c1"># good</span>
<span class="o">!</span><span class="n">something</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-space-inside-range-literals"><a class="anchor" href="#no-space-inside-range-literals"></a><a class="link" href="#no-space-inside-range-literals">No Space inside Range Literals</a></h3>
<div class="paragraph">
<p>No space inside range literals.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="mi">1</span> <span class="o">..</span> <span class="mi">3</span>
<span class="s1">'a'</span> <span class="o">...</span> <span class="s1">'z'</span>

<span class="c1"># good</span>
<span class="mi">1</span><span class="o">..</span><span class="mi">3</span>
<span class="s1">'a'</span><span class="o">...</span><span class="s1">'z'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="indent-when-to-case"><a class="anchor" href="#indent-when-to-case"></a><a class="link" href="#indent-when-to-case">Indent <code>when</code> to <code>case</code></a></h3>
<div class="paragraph">
<p>Indent <code>when</code> as deep as <code>case</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">case</span>
  <span class="k">when</span> <span class="n">song</span><span class="p">.</span><span class="nf">name</span> <span class="o">==</span> <span class="s1">'Misty'</span>
    <span class="nb">puts</span> <span class="s1">'Not again!'</span>
  <span class="k">when</span> <span class="n">song</span><span class="p">.</span><span class="nf">duration</span> <span class="o">&gt;</span> <span class="mi">120</span>
    <span class="nb">puts</span> <span class="s1">'Too long!'</span>
  <span class="k">when</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">hour</span> <span class="o">&gt;</span> <span class="mi">21</span>
    <span class="nb">puts</span> <span class="s2">"It's too late"</span>
  <span class="k">else</span>
    <span class="n">song</span><span class="p">.</span><span class="nf">play</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">case</span>
<span class="k">when</span> <span class="n">song</span><span class="p">.</span><span class="nf">name</span> <span class="o">==</span> <span class="s1">'Misty'</span>
  <span class="nb">puts</span> <span class="s1">'Not again!'</span>
<span class="k">when</span> <span class="n">song</span><span class="p">.</span><span class="nf">duration</span> <span class="o">&gt;</span> <span class="mi">120</span>
  <span class="nb">puts</span> <span class="s1">'Too long!'</span>
<span class="k">when</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">hour</span> <span class="o">&gt;</span> <span class="mi">21</span>
  <span class="nb">puts</span> <span class="s2">"It's too late"</span>
<span class="k">else</span>
  <span class="n">song</span><span class="p">.</span><span class="nf">play</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">A Bit of History</div>
<div class="paragraph">
<p>This is the style established in both "The Ruby Programming Language" and "Programming Ruby".
Historically it is derived from the fact that <code>case</code> and <code>switch</code> statements are not blocks, hence should not be indented, and the <code>when</code> and <code>else</code> keywords are labels (compiled in the C language, they are literally labels for <code>JMP</code> calls).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="indent-conditional-assignment"><a class="anchor" href="#indent-conditional-assignment"></a><a class="link" href="#indent-conditional-assignment">Indent Conditional Assignment</a></h3>
<div class="paragraph">
<p>When assigning the result of a conditional expression to a variable, preserve the usual alignment of its branches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - pretty convoluted</span>
<span class="n">kind</span> <span class="o">=</span> <span class="k">case</span> <span class="n">year</span>
<span class="k">when</span> <span class="mi">1850</span><span class="o">..</span><span class="mi">1889</span> <span class="k">then</span> <span class="s1">'Blues'</span>
<span class="k">when</span> <span class="mi">1890</span><span class="o">..</span><span class="mi">1909</span> <span class="k">then</span> <span class="s1">'Ragtime'</span>
<span class="k">when</span> <span class="mi">1910</span><span class="o">..</span><span class="mi">1929</span> <span class="k">then</span> <span class="s1">'New Orleans Jazz'</span>
<span class="k">when</span> <span class="mi">1930</span><span class="o">..</span><span class="mi">1939</span> <span class="k">then</span> <span class="s1">'Swing'</span>
<span class="k">when</span> <span class="mi">1940</span><span class="o">..</span><span class="mi">1950</span> <span class="k">then</span> <span class="s1">'Bebop'</span>
<span class="k">else</span> <span class="s1">'Jazz'</span>
<span class="k">end</span>

<span class="n">result</span> <span class="o">=</span> <span class="k">if</span> <span class="n">some_cond</span>
  <span class="n">calc_something</span>
<span class="k">else</span>
  <span class="n">calc_something_else</span>
<span class="k">end</span>

<span class="c1"># good - it's apparent what's going on</span>
<span class="n">kind</span> <span class="o">=</span> <span class="k">case</span> <span class="n">year</span>
       <span class="k">when</span> <span class="mi">1850</span><span class="o">..</span><span class="mi">1889</span> <span class="k">then</span> <span class="s1">'Blues'</span>
       <span class="k">when</span> <span class="mi">1890</span><span class="o">..</span><span class="mi">1909</span> <span class="k">then</span> <span class="s1">'Ragtime'</span>
       <span class="k">when</span> <span class="mi">1910</span><span class="o">..</span><span class="mi">1929</span> <span class="k">then</span> <span class="s1">'New Orleans Jazz'</span>
       <span class="k">when</span> <span class="mi">1930</span><span class="o">..</span><span class="mi">1939</span> <span class="k">then</span> <span class="s1">'Swing'</span>
       <span class="k">when</span> <span class="mi">1940</span><span class="o">..</span><span class="mi">1950</span> <span class="k">then</span> <span class="s1">'Bebop'</span>
       <span class="k">else</span> <span class="s1">'Jazz'</span>
       <span class="k">end</span>

<span class="n">result</span> <span class="o">=</span> <span class="k">if</span> <span class="n">some_cond</span>
           <span class="n">calc_something</span>
         <span class="k">else</span>
           <span class="n">calc_something_else</span>
         <span class="k">end</span>

<span class="c1"># good (and a bit more width efficient)</span>
<span class="n">kind</span> <span class="o">=</span>
  <span class="k">case</span> <span class="n">year</span>
  <span class="k">when</span> <span class="mi">1850</span><span class="o">..</span><span class="mi">1889</span> <span class="k">then</span> <span class="s1">'Blues'</span>
  <span class="k">when</span> <span class="mi">1890</span><span class="o">..</span><span class="mi">1909</span> <span class="k">then</span> <span class="s1">'Ragtime'</span>
  <span class="k">when</span> <span class="mi">1910</span><span class="o">..</span><span class="mi">1929</span> <span class="k">then</span> <span class="s1">'New Orleans Jazz'</span>
  <span class="k">when</span> <span class="mi">1930</span><span class="o">..</span><span class="mi">1939</span> <span class="k">then</span> <span class="s1">'Swing'</span>
  <span class="k">when</span> <span class="mi">1940</span><span class="o">..</span><span class="mi">1950</span> <span class="k">then</span> <span class="s1">'Bebop'</span>
  <span class="k">else</span> <span class="s1">'Jazz'</span>
  <span class="k">end</span>

<span class="n">result</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">some_cond</span>
    <span class="n">calc_something</span>
  <span class="k">else</span>
    <span class="n">calc_something_else</span>
  <span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="empty-lines-between-methods"><a class="anchor" href="#empty-lines-between-methods"></a><a class="link" href="#empty-lines-between-methods">Empty Lines between Methods</a></h3>
<div class="paragraph">
<p>Use empty lines between method definitions and also to break up methods into logical paragraphs internally.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
  <span class="n">data</span><span class="p">.</span><span class="nf">manipulate!</span>
  <span class="n">data</span><span class="p">.</span><span class="nf">result</span>
<span class="k">end</span>
<span class="k">def</span> <span class="nf">some_other_method</span>
  <span class="n">result</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

  <span class="n">data</span><span class="p">.</span><span class="nf">manipulate!</span>

  <span class="n">data</span><span class="p">.</span><span class="nf">result</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">some_other_method</span>
  <span class="n">result</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="two-or-more-empty-lines"><a class="anchor" href="#two-or-more-empty-lines"></a><a class="link" href="#two-or-more-empty-lines">Two or More Empty Lines</a></h3>
<div class="paragraph">
<p>Don&#8217;t use several empty lines in a row.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - It has two empty lines.</span>
<span class="n">some_method</span>


<span class="n">some_method</span>

<span class="c1"># good</span>
<span class="n">some_method</span>

<span class="n">some_method</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="empty-lines-around-attribute-accessor"><a class="anchor" href="#empty-lines-around-attribute-accessor"></a><a class="link" href="#empty-lines-around-attribute-accessor">Empty Lines around Attribute Accessor</a></h3>
<div class="paragraph">
<p>Use empty lines around attribute accessor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="nb">attr_reader</span> <span class="ss">:foo</span>
  <span class="k">def</span> <span class="nf">foo</span>
    <span class="c1"># do something...</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="nb">attr_reader</span> <span class="ss">:foo</span>

  <span class="k">def</span> <span class="nf">foo</span>
    <span class="c1"># do something...</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="empty-lines-around-access-modifier"><a class="anchor" href="#empty-lines-around-access-modifier"></a><a class="link" href="#empty-lines-around-access-modifier">Empty Lines around Access Modifier</a></h3>
<div class="paragraph">
<p>Use empty lines around access modifier.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">def</span> <span class="nf">bar</span><span class="p">;</span> <span class="k">end</span>
  <span class="kp">private</span>
  <span class="k">def</span> <span class="nf">baz</span><span class="p">;</span> <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">def</span> <span class="nf">bar</span><span class="p">;</span> <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">baz</span><span class="p">;</span> <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="empty-lines-around-bodies"><a class="anchor" href="#empty-lines-around-bodies"></a><a class="link" href="#empty-lines-around-bodies">Empty Lines around Bodies</a></h3>
<div class="paragraph">
<p>Don&#8217;t use empty lines around method, class, module, block bodies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Foo</span>

  <span class="k">def</span> <span class="nf">foo</span>

    <span class="k">begin</span>

      <span class="n">do_something</span> <span class="k">do</span>

        <span class="n">something</span>

      <span class="k">end</span>

    <span class="k">rescue</span>

      <span class="n">something</span>

    <span class="k">end</span>

    <span class="kp">true</span>

  <span class="k">end</span>

<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">def</span> <span class="nf">foo</span>
    <span class="k">begin</span>
      <span class="n">do_something</span> <span class="k">do</span>
        <span class="n">something</span>
      <span class="k">end</span>
    <span class="k">rescue</span>
      <span class="n">something</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-trailing-params-comma"><a class="anchor" href="#no-trailing-params-comma"></a><a class="link" href="#no-trailing-params-comma">Trailing Comma in Method Arguments</a></h3>
<div class="paragraph">
<p>Avoid comma after the last parameter in a method call, especially when the parameters are not on separate lines.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - easier to move/add/remove parameters, but still not preferred</span>
<span class="n">some_method</span><span class="p">(</span>
  <span class="n">size</span><span class="p">,</span>
  <span class="n">count</span><span class="p">,</span>
  <span class="n">color</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># bad</span>
<span class="n">some_method</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="p">)</span>

<span class="c1"># good</span>
<span class="n">some_method</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spaces-around-equals"><a class="anchor" href="#spaces-around-equals"></a><a class="link" href="#spaces-around-equals">Spaces around Equals</a></h3>
<div class="paragraph">
<p>Use spaces around the <code>=</code> operator when assigning default values to method parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">arg1</span><span class="o">=</span><span class="ss">:default</span><span class="p">,</span> <span class="n">arg2</span><span class="o">=</span><span class="kp">nil</span><span class="p">,</span> <span class="n">arg3</span><span class="o">=</span><span class="p">[])</span>
  <span class="c1"># do something...</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">arg1</span> <span class="o">=</span> <span class="ss">:default</span><span class="p">,</span> <span class="n">arg2</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">arg3</span> <span class="o">=</span> <span class="p">[])</span>
  <span class="c1"># do something...</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>While several Ruby books suggest the first style, the second is much more
prominent in practice (and arguably a bit more readable).</p>
</div>
</div>
<div class="sect2">
<h3 id="no-trailing-backslash"><a class="anchor" href="#no-trailing-backslash"></a><a class="link" href="#no-trailing-backslash">Line Continuation in Expressions</a></h3>
<div class="paragraph">
<p>Avoid line continuation with <code>\</code> where not required.
In practice, avoid using line continuations for anything but string concatenation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad (\ is not needed here)</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">\</span>
         <span class="mi">2</span>

<span class="c1"># bad (\ is required, but still ugly as hell)</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">\</span>
         <span class="o">-</span> <span class="mi">2</span>

<span class="c1"># good</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span>
         <span class="mi">2</span>

<span class="n">long_string</span> <span class="o">=</span> <span class="s1">'First part of the long string'</span> <span class="p">\</span>
              <span class="s1">' and second part of the long string'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="consistent-multi-line-chains"><a class="anchor" href="#consistent-multi-line-chains"></a><a class="link" href="#consistent-multi-line-chains">Multi-line Method Chains</a></h3>
<div class="paragraph">
<p>Adopt a consistent multi-line method chaining style.
There are two popular styles in the Ruby community, both of which are considered good - leading <code>.</code>  and trailing <code>.</code>.</p>
</div>
<div class="sect3">
<h4 id="leading-dot-in-multi-line-chains"><a class="anchor" href="#leading-dot-in-multi-line-chains"></a><a class="link" href="#leading-dot-in-multi-line-chains">Leading <code>.</code></a></h4>
<div class="paragraph">
<p>When continuing a chained method call on another line, keep the <code>.</code> on the second line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - need to consult first line to understand second line</span>
<span class="n">one</span><span class="p">.</span><span class="nf">two</span><span class="p">.</span><span class="nf">three</span><span class="p">.</span>
  <span class="nf">four</span>

<span class="c1"># good - it's immediately clear what's going on the second line</span>
<span class="n">one</span><span class="p">.</span><span class="nf">two</span><span class="p">.</span><span class="nf">three</span>
  <span class="p">.</span><span class="nf">four</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trailing-dot-in-multi-line-chains"><a class="anchor" href="#trailing-dot-in-multi-line-chains"></a><a class="link" href="#trailing-dot-in-multi-line-chains">Trailing <code>.</code></a></h4>
<div class="paragraph">
<p>When continuing a chained method call on another line, include the <code>.</code> on the first line to indicate that the expression continues.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - need to read ahead to the second line to know that the chain continues</span>
<span class="n">one</span><span class="p">.</span><span class="nf">two</span><span class="p">.</span><span class="nf">three</span>
  <span class="p">.</span><span class="nf">four</span>

<span class="c1"># good - it's immediately clear that the expression continues beyond the first line</span>
<span class="n">one</span><span class="p">.</span><span class="nf">two</span><span class="p">.</span><span class="nf">three</span><span class="p">.</span>
  <span class="nf">four</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A discussion on the merits of both alternative styles can be found <a href="https://github.com/rubocop/ruby-style-guide/pull/176">here</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-double-indent"><a class="anchor" href="#no-double-indent"></a><a class="link" href="#no-double-indent">Method Arguments Alignment</a></h3>
<div class="paragraph">
<p>Align the arguments of a method call if they span more than one line.
When aligning arguments is not appropriate due to line-length constraints, single indent for the lines after the first is also acceptable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># starting point (line is too long)</span>
<span class="k">def</span> <span class="nf">send_mail</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
  <span class="no">Mailer</span><span class="p">.</span><span class="nf">deliver</span><span class="p">(</span><span class="ss">to: </span><span class="s1">'bob@example.com'</span><span class="p">,</span> <span class="ss">from: </span><span class="s1">'us@example.com'</span><span class="p">,</span> <span class="ss">subject: </span><span class="s1">'Important message'</span><span class="p">,</span> <span class="ss">body: </span><span class="n">source</span><span class="p">.</span><span class="nf">text</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># bad (double indent)</span>
<span class="k">def</span> <span class="nf">send_mail</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
  <span class="no">Mailer</span><span class="p">.</span><span class="nf">deliver</span><span class="p">(</span>
      <span class="ss">to: </span><span class="s1">'bob@example.com'</span><span class="p">,</span>
      <span class="ss">from: </span><span class="s1">'us@example.com'</span><span class="p">,</span>
      <span class="ss">subject: </span><span class="s1">'Important message'</span><span class="p">,</span>
      <span class="ss">body: </span><span class="n">source</span><span class="p">.</span><span class="nf">text</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">send_mail</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
  <span class="no">Mailer</span><span class="p">.</span><span class="nf">deliver</span><span class="p">(</span><span class="ss">to: </span><span class="s1">'bob@example.com'</span><span class="p">,</span>
                 <span class="ss">from: </span><span class="s1">'us@example.com'</span><span class="p">,</span>
                 <span class="ss">subject: </span><span class="s1">'Important message'</span><span class="p">,</span>
                 <span class="ss">body: </span><span class="n">source</span><span class="p">.</span><span class="nf">text</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good (normal indent)</span>
<span class="k">def</span> <span class="nf">send_mail</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
  <span class="no">Mailer</span><span class="p">.</span><span class="nf">deliver</span><span class="p">(</span>
    <span class="ss">to: </span><span class="s1">'bob@example.com'</span><span class="p">,</span>
    <span class="ss">from: </span><span class="s1">'us@example.com'</span><span class="p">,</span>
    <span class="ss">subject: </span><span class="s1">'Important message'</span><span class="p">,</span>
    <span class="ss">body: </span><span class="n">source</span><span class="p">.</span><span class="nf">text</span>
  <span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-braces-opts-hash"><a class="anchor" href="#no-braces-opts-hash"></a><a class="link" href="#no-braces-opts-hash">Implicit Options Hash</a></h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
As of Ruby 2.7 braces around an options hash are no longer
optional.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Omit the outer braces around an implicit options hash.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">user</span><span class="p">.</span><span class="nf">set</span><span class="p">({</span> <span class="ss">name: </span><span class="s1">'John'</span><span class="p">,</span> <span class="ss">age: </span><span class="mi">45</span><span class="p">,</span> <span class="ss">permissions: </span><span class="p">{</span> <span class="ss">read: </span><span class="kp">true</span> <span class="p">}</span> <span class="p">})</span>

<span class="c1"># good</span>
<span class="n">user</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="ss">name: </span><span class="s1">'John'</span><span class="p">,</span> <span class="ss">age: </span><span class="mi">45</span><span class="p">,</span> <span class="ss">permissions: </span><span class="p">{</span> <span class="ss">read: </span><span class="kp">true</span> <span class="p">})</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-dsl-decorating"><a class="anchor" href="#no-dsl-decorating"></a><a class="link" href="#no-dsl-decorating">DSL Method Calls</a></h3>
<div class="paragraph">
<p>Omit both the outer braces and parentheses for methods that are part of an internal DSL (e.g., Rake, Rails, RSpec).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># bad</span>
  <span class="nb">attr_reader</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span><span class="p">)</span>
  <span class="c1"># good</span>
  <span class="nb">attr_reader</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span>

  <span class="c1"># bad</span>
  <span class="n">validates</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="p">{</span> <span class="ss">presence: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">length: </span><span class="p">{</span> <span class="ss">within: </span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span> <span class="p">}</span> <span class="p">})</span>
  <span class="c1"># good</span>
  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">length: </span><span class="p">{</span> <span class="ss">within: </span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span> <span class="p">}</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="parens-no-spaces"><a class="anchor" href="#parens-no-spaces"></a><a class="link" href="#parens-no-spaces">Space in Method Calls</a></h3>
<div class="paragraph">
<p>Do not put a space between a method name and the opening parenthesis.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">puts</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="nb">puts</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="space-in-brackets-access"><a class="anchor" href="#space-in-brackets-access"></a><a class="link" href="#space-in-brackets-access">Space in Brackets Access</a></h3>
<div class="paragraph">
<p>Do not put a space between a receiver name and the opening brackets.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">collection</span> <span class="p">[</span><span class="n">index_or_key</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="n">collection</span><span class="p">[</span><span class="n">index_or_key</span><span class="p">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="align-multiline-arrays"><a class="anchor" href="#align-multiline-arrays"></a><a class="link" href="#align-multiline-arrays">Multi-line Arrays Alignment</a></h3>
<div class="paragraph">
<p>Align the elements of array literals spanning multiple lines.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - single indent</span>
<span class="n">menu_item</span> <span class="o">=</span> <span class="sx">%w[Spam Spam Spam Spam Spam Spam Spam Spam
  Baked beans Spam Spam Spam Spam Spam]</span>

<span class="c1"># good</span>
<span class="n">menu_item</span> <span class="o">=</span> <span class="sx">%w[
  Spam Spam Spam Spam Spam Spam Spam Spam
  Baked beans Spam Spam Spam Spam Spam
]</span>

<span class="c1"># good</span>
<span class="n">menu_item</span> <span class="o">=</span>
  <span class="sx">%w[Spam Spam Spam Spam Spam Spam Spam Spam
     Baked beans Spam Spam Spam Spam Spam]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="naming-conventions"><a class="anchor" href="#naming-conventions"></a><a class="link" href="#naming-conventions">Naming Conventions</a></h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The only real difficulties in programming are cache invalidation and naming things.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Phil Karlton
</div>
</div>
<div class="sect2">
<h3 id="english-identifiers"><a class="anchor" href="#english-identifiers"></a><a class="link" href="#english-identifiers">English for Identifiers</a></h3>
<div class="paragraph">
<p>Name identifiers in English.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - identifier is a Bulgarian word, using non-ascii (Cyrillic) characters</span>
<span class="err">заплата</span> <span class="o">=</span> <span class="mi">1_000</span>

<span class="c1"># bad - identifier is a Bulgarian word, written with Latin letters (instead of Cyrillic)</span>
<span class="n">zaplata</span> <span class="o">=</span> <span class="mi">1_000</span>

<span class="c1"># good</span>
<span class="n">salary</span> <span class="o">=</span> <span class="mi">1_000</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="snake-case-symbols-methods-vars"><a class="anchor" href="#snake-case-symbols-methods-vars"></a><a class="link" href="#snake-case-symbols-methods-vars">Snake Case for Symbols, Methods and Variables</a></h3>
<div class="paragraph">
<p>Use <code>snake_case</code> for symbols, methods and variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="ss">:'some symbol'</span>
<span class="ss">:SomeSymbol</span>
<span class="ss">:someSymbol</span>

<span class="n">someVar</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">def</span> <span class="nf">someMethod</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">SomeMethod</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="ss">:some_symbol</span>

<span class="n">some_var</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">def</span> <span class="nf">some_method</span>
  <span class="c1"># some code</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="snake-case-symbols-methods-vars-with-numbers"><a class="anchor" href="#snake-case-symbols-methods-vars-with-numbers"></a><a class="link" href="#snake-case-symbols-methods-vars-with-numbers">Identifiers with a Numeric Suffix</a></h3>
<div class="paragraph">
<p>Do not separate numbers from letters on symbols, methods and variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="ss">:some_sym_1</span>

<span class="n">some_var_1</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">var_10</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">def</span> <span class="nf">some_method_1</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="ss">:some_sym1</span>

<span class="n">some_var1</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">var10</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">def</span> <span class="nf">some_method1</span>
  <span class="c1"># some code</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="camelcase-classes"><a class="anchor" href="#camelcase-classes"></a><a class="link" href="#camelcase-classes">CapitalCase for Classes and Modules</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>CapitalCase</code> is also known as <code>UpperCamelCase</code>, <code>CapitalWords</code>
and <code>PascalCase</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use <code>CapitalCase</code> for classes and modules.
(Keep acronyms like HTTP, RFC, XML uppercase).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Someclass</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Some_Class</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">SomeXml</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">XmlSomething</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">SomeClass</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">SomeXML</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">XMLSomething</span>
  <span class="c1"># some code</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="snake-case-files"><a class="anchor" href="#snake-case-files"></a><a class="link" href="#snake-case-files">Snake Case for Files</a></h3>
<div class="paragraph">
<p>Use <code>snake_case</code> for naming files, e.g. <code>hello_world.rb</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="snake-case-dirs"><a class="anchor" href="#snake-case-dirs"></a><a class="link" href="#snake-case-dirs">Snake Case for Directories</a></h3>
<div class="paragraph">
<p>Use <code>snake_case</code> for naming directories, e.g. <code>lib/hello_world/hello_world.rb</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="one-class-per-file"><a class="anchor" href="#one-class-per-file"></a><a class="link" href="#one-class-per-file">One Class per File</a></h3>
<div class="paragraph">
<p>Aim to have just a single class/module per source file.
Name the file name as the class/module, but replacing <code>CapitalCase</code> with <code>snake_case</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="screaming-snake-case"><a class="anchor" href="#screaming-snake-case"></a><a class="link" href="#screaming-snake-case">Screaming Snake Case for Constants</a></h3>
<div class="paragraph">
<p>Use <code>SCREAMING_SNAKE_CASE</code> for other constants (those that don&#8217;t refer to classes and modules).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">SomeConst</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># good</span>
<span class="no">SOME_CONST</span> <span class="o">=</span> <span class="mi">5</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bool-methods-qmark"><a class="anchor" href="#bool-methods-qmark"></a><a class="link" href="#bool-methods-qmark">Predicate Methods Suffix</a></h3>
<div class="paragraph">
<p>The names of predicate methods (methods that return a boolean value) should end in a question mark  (i.e. <code>Array#empty?</code>).
Methods that don&#8217;t return a boolean, shouldn&#8217;t end in a question mark.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">even</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">even?</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bool-methods-prefix"><a class="anchor" href="#bool-methods-prefix"></a><a class="link" href="#bool-methods-prefix">Predicate Methods Prefix</a></h3>
<div class="paragraph">
<p>Avoid prefixing predicate methods with the auxiliary verbs such as <code>is</code>, <code>does</code>, or <code>can</code>.
These words are redundant and inconsistent with the style of boolean methods in the Ruby core library, such as <code>empty?</code> and <code>include?</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">is_tall?</span>
    <span class="kp">true</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">can_play_basketball?</span>
    <span class="kp">false</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">does_like_candy?</span>
    <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">tall?</span>
    <span class="kp">true</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">basketball_player?</span>
    <span class="kp">false</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">likes_candy?</span>
    <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dangerous-method-bang"><a class="anchor" href="#dangerous-method-bang"></a><a class="link" href="#dangerous-method-bang">Dangerous Method Suffix</a></h3>
<div class="paragraph">
<p>The names of potentially <em>dangerous</em> methods (i.e. methods that modify <code>self</code> or the arguments, <code>exit!</code> (doesn&#8217;t run the finalizers like <code>exit</code> does), etc) should end with an exclamation mark if there exists a safe version of that <em>dangerous</em> method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - there is no matching 'safe' method</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">update!</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">update</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">update!</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">update</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="safe-because-unsafe"><a class="anchor" href="#safe-because-unsafe"></a><a class="link" href="#safe-because-unsafe">Relationship between Safe and Dangerous Methods</a></h3>
<div class="paragraph">
<p>Define the non-bang (safe) method in terms of the bang (dangerous) one if possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Array</span>
  <span class="k">def</span> <span class="nf">flatten_once!</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
      <span class="p">[</span><span class="o">*</span><span class="n">e</span><span class="p">].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="n">f</span> <span class="p">}</span>
    <span class="k">end</span>

    <span class="n">replace</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">flatten_once</span>
    <span class="nb">dup</span><span class="p">.</span><span class="nf">flatten_once!</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="underscore-unused-vars"><a class="anchor" href="#underscore-unused-vars"></a><a class="link" href="#underscore-unused-vars">Unused Variables Prefix</a></h3>
<div class="paragraph">
<p>Prefix with <code>_</code> unused block parameters and local variables.
It&#8217;s also acceptable to use just <code>_</code> (although it&#8217;s a bit less descriptive).
This convention is recognized by the Ruby interpreter and tools like RuboCop will suppress their unused variable warnings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">result</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">something</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">unused_var</span><span class="p">,</span> <span class="n">used_var</span> <span class="o">=</span> <span class="n">something_else</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">result</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">_k</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">something</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">_unused_var</span><span class="p">,</span> <span class="n">used_var</span> <span class="o">=</span> <span class="n">something_else</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">result</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">_</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">something</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">used_var</span> <span class="o">=</span> <span class="n">something_else</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="c1"># some code</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="other-arg"><a class="anchor" href="#other-arg"></a><a class="link" href="#other-arg"><code>other</code> Parameter</a></h3>
<div class="paragraph">
<p>When defining binary operators and operator-alike methods, name the parameter <code>other</code> for operators with "symmetrical" semantics of operands.
Symmetrical semantics means both sides of the operator are typically of the same or coercible types.</p>
</div>
<div class="paragraph">
<p>Operators and operator-alike methods with symmetrical semantics (the parameter should be named <code>other</code>): <code>`, `-`, `<strong>+</code>, <code>/</code>, <code>%</code>, <code></strong>*</code>, <code>==</code>, <code>&gt;</code>, <code>&lt;</code>, <code>|</code>, <code>&amp;</code>, <code>^</code>, <code>eql?</code>, <code>equal?</code>.</p>
</div>
<div class="paragraph">
<p>Operators with non-symmetrical semantics (the parameter should <strong>not</strong> be named <code>other</code>): <code>&lt;&lt;</code>, <code>[]</code> (collection/item relations between operands), <code>===</code> (pattern/matchable relations).</p>
</div>
<div class="paragraph">
<p>Note that the rule should be followed <strong>only</strong> if both sides of the operator have the same semantics.
Prominent exception in Ruby core is, for example, <code>Array#*(int)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good</span>
<span class="k">def</span> <span class="nf">+</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">&lt;&lt;</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
  <span class="vi">@internal</span> <span class="o">&lt;&lt;</span> <span class="n">other</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">&lt;&lt;</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
  <span class="vi">@internal</span> <span class="o">&lt;&lt;</span> <span class="n">item</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="c1"># Returns some string multiplied `other` times</span>
<span class="k">def</span> <span class="nf">*</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="c1"># Returns some string multiplied `num` times</span>
<span class="k">def</span> <span class="nf">*</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="flow-of-control"><a class="anchor" href="#flow-of-control"></a><a class="link" href="#flow-of-control">Flow of Control</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="no-for-loops"><a class="anchor" href="#no-for-loops"></a><a class="link" href="#no-for-loops"><code>for</code> Loops</a></h3>
<div class="paragraph">
<p>Do not use <code>for</code>, unless you know exactly why.
Most of the time iterators should be used instead.
<code>for</code> is implemented in terms of <code>each</code> (so you&#8217;re adding a level of indirection), but with a twist - <code>for</code> doesn&#8217;t introduce a new scope (unlike <code>each</code>) and variables defined in its block will be visible outside it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># bad</span>
<span class="k">for</span> <span class="n">elem</span> <span class="k">in</span> <span class="n">arr</span> <span class="k">do</span>
  <span class="nb">puts</span> <span class="n">elem</span>
<span class="k">end</span>

<span class="c1"># note that elem is accessible outside of the for loop</span>
<span class="n">elem</span> <span class="c1"># =&gt; 3</span>

<span class="c1"># good</span>
<span class="n">arr</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">elem</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">elem</span> <span class="p">}</span>

<span class="c1"># elem is not accessible outside each block</span>
<span class="n">elem</span> <span class="c1"># =&gt; NameError: undefined local variable or method `elem'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-then"><a class="anchor" href="#no-then"></a><a class="link" href="#no-then"><code>then</code> in Multi-line Expression</a></h3>
<div class="paragraph">
<p>Do not use <code>then</code> for multi-line <code>if</code>/<code>unless</code>/<code>when</code>/<code>in</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span> <span class="n">some_condition</span> <span class="k">then</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="k">case</span> <span class="n">foo</span>
<span class="k">when</span> <span class="n">bar</span> <span class="k">then</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="k">case</span> <span class="n">expression</span>
<span class="k">in</span> <span class="n">pattern</span> <span class="k">then</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">some_condition</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">case</span> <span class="n">foo</span>
<span class="k">when</span> <span class="n">bar</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">case</span> <span class="n">expression</span>
<span class="k">in</span> <span class="n">pattern</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="same-line-condition"><a class="anchor" href="#same-line-condition"></a><a class="link" href="#same-line-condition">Condition Placement</a></h3>
<div class="paragraph">
<p>Always put the condition on the same line as the <code>if</code>/<code>unless</code> in a multi-line conditional.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span>
  <span class="n">some_condition</span>
  <span class="n">do_something</span>
  <span class="n">do_something_else</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">some_condition</span>
  <span class="n">do_something</span>
  <span class="n">do_something_else</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ternary-operator"><a class="anchor" href="#ternary-operator"></a><a class="link" href="#ternary-operator">Ternary Operator vs <code>if</code></a></h3>
<div class="paragraph">
<p>Prefer the ternary operator(<code>?:</code>) over <code>if/then/else/end</code> constructs.
It&#8217;s more common and obviously more concise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">result</span> <span class="o">=</span> <span class="k">if</span> <span class="n">some_condition</span> <span class="k">then</span> <span class="n">something</span> <span class="k">else</span> <span class="n">something_else</span> <span class="k">end</span>

<span class="c1"># good</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">some_condition</span> <span class="p">?</span> <span class="n">something</span> <span class="p">:</span> <span class="n">something_else</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-nested-ternary"><a class="anchor" href="#no-nested-ternary"></a><a class="link" href="#no-nested-ternary">Nested Ternary Operators</a></h3>
<div class="paragraph">
<p>Use one expression per branch in a ternary operator.
This also means that ternary operators must not be nested.
Prefer <code>if/else</code> constructs in these cases.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">some_condition</span> <span class="p">?</span> <span class="p">(</span><span class="n">nested_condition</span> <span class="p">?</span> <span class="n">nested_something</span> <span class="p">:</span> <span class="n">nested_something_else</span><span class="p">)</span> <span class="p">:</span> <span class="n">something_else</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">some_condition</span>
  <span class="n">nested_condition</span> <span class="p">?</span> <span class="n">nested_something</span> <span class="p">:</span> <span class="n">nested_something_else</span>
<span class="k">else</span>
  <span class="n">something_else</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-semicolon-ifs"><a class="anchor" href="#no-semicolon-ifs"></a><a class="link" href="#no-semicolon-ifs">Semicolon in <code>if</code></a></h3>
<div class="paragraph">
<p>Do not use <code>if x; &#8230;&#8203;</code>. Use the ternary operator instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">result</span> <span class="o">=</span> <span class="k">if</span> <span class="n">some_condition</span><span class="p">;</span> <span class="n">something</span> <span class="k">else</span> <span class="n">something_else</span> <span class="k">end</span>

<span class="c1"># good</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">some_condition</span> <span class="p">?</span> <span class="n">something</span> <span class="p">:</span> <span class="n">something_else</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="case-vs-if-else"><a class="anchor" href="#case-vs-if-else"></a><a class="link" href="#case-vs-if-else"><code>case</code> vs <code>if-else</code></a></h3>
<div class="paragraph">
<p>Prefer <code>case</code> over <code>if-elsif</code> when compared value is the same in each clause.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="ss">:active</span>
  <span class="n">perform_action</span>
<span class="k">elsif</span> <span class="n">status</span> <span class="o">==</span> <span class="ss">:inactive</span> <span class="o">||</span> <span class="n">status</span> <span class="o">==</span> <span class="ss">:hibernating</span>
  <span class="n">check_timeout</span>
<span class="k">else</span>
  <span class="n">final_action</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">case</span> <span class="n">status</span>
<span class="k">when</span> <span class="ss">:active</span>
  <span class="n">perform_action</span>
<span class="k">when</span> <span class="ss">:inactive</span><span class="p">,</span> <span class="ss">:hibernating</span>
  <span class="n">check_timeout</span>
<span class="k">else</span>
  <span class="n">final_action</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="use-if-case-returns"><a class="anchor" href="#use-if-case-returns"></a><a class="link" href="#use-if-case-returns">Returning Result from <code>if</code>/<code>case</code></a></h3>
<div class="paragraph">
<p>Leverage the fact that <code>if</code> and <code>case</code> are expressions which return a result.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span> <span class="n">condition</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">x</span>
<span class="k">else</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">y</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">result</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">condition</span>
    <span class="n">x</span>
  <span class="k">else</span>
    <span class="n">y</span>
  <span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="one-line-cases"><a class="anchor" href="#one-line-cases"></a><a class="link" href="#one-line-cases">One-line Cases</a></h3>
<div class="paragraph">
<p>Use <code>when x then &#8230;&#8203;</code> for one-line cases.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The alternative syntax <code>when x: &#8230;&#8203;</code> has been removed as of Ruby 1.9.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="no-when-semicolons"><a class="anchor" href="#no-when-semicolons"></a><a class="link" href="#no-when-semicolons">Semicolon in <code>when</code></a></h3>
<div class="paragraph">
<p>Do not use <code>when x; &#8230;&#8203;</code>. See the previous rule.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-in-pattern-semicolons"><a class="anchor" href="#no-in-pattern-semicolons"></a><a class="link" href="#no-in-pattern-semicolons">Semicolon in <code>in</code></a></h3>
<div class="paragraph">
<p>Do not use <code>in pattern; &#8230;&#8203;</code>. Use <code>in pattern then &#8230;&#8203;</code> for one-line <code>in</code> pattern branches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">case</span> <span class="n">expression</span>
<span class="k">in</span> <span class="n">pattern</span><span class="p">;</span> <span class="n">do_something</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">case</span> <span class="n">expression</span>
<span class="k">in</span> <span class="n">pattern</span> <span class="k">then</span> <span class="n">do_something</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bang-not-not"><a class="anchor" href="#bang-not-not"></a><a class="link" href="#bang-not-not"><code>!</code> vs <code>not</code></a></h3>
<div class="paragraph">
<p>Use <code>!</code> instead of <code>not</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - parentheses are required because of op precedence</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">not</span> <span class="n">something</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">x</span> <span class="o">=</span> <span class="o">!</span><span class="n">something</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-bang-bang"><a class="anchor" href="#no-bang-bang"></a><a class="link" href="#no-bang-bang">Double Negation</a></h3>
<div class="paragraph">
<p>Avoid unnecessary uses of <code>!!</code></p>
</div>
<div class="paragraph">
<p><code>!!</code> converts a value to boolean, but you don&#8217;t need this explicit conversion in the condition of a control expression; using it only obscures your intention.</p>
</div>
<div class="paragraph">
<p>Consider using it only when there is a valid reason to restrict the result <code>true</code> or <code>false</code>. Examples include outputting to a particular format or API like JSON, or as the return value of a <code>predicate?</code> method. In these cases, also consider doing a nil check instead: <code>!something.nil?</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">x</span> <span class="o">=</span> <span class="s1">'test'</span>
<span class="c1"># obscure nil check</span>
<span class="k">if</span> <span class="o">!!</span><span class="n">x</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">x</span> <span class="o">=</span> <span class="s1">'test'</span>
<span class="k">if</span> <span class="n">x</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">named?</span>
  <span class="o">!</span><span class="nb">name</span><span class="p">.</span><span class="nf">nil?</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">banned?</span>
  <span class="o">!!</span><span class="n">banned_until</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">future?</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="and-or-flow"><a class="anchor" href="#and-or-flow"></a><a class="link" href="#and-or-flow"><code>and</code>/<code>or</code> <a id="no-and-or-or"></a></a></h3>
<div class="paragraph">
<p>Do not use <code>and</code> and <code>or</code> in boolean context - <code>and</code> and <code>or</code> are control flow
operators and should be used as such. They have very low precedence, and can be
used as a short form of specifying flow sequences like "evaluate expression 1,
and only if it is not successful (returned <code>nil</code>), evaluate expression 2". This
is especially useful for raising errors or early return without breaking the
reading flow.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good: and/or for control flow</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">extract_arguments</span> <span class="n">or</span> <span class="k">raise</span> <span class="no">ArgumentError</span><span class="p">,</span> <span class="s2">"Not enough arguments!"</span>
<span class="n">user</span><span class="p">.</span><span class="nf">suspended?</span> <span class="n">and</span> <span class="k">return</span> <span class="ss">:denied</span>

<span class="c1"># bad</span>
<span class="c1"># and/or in conditions (their precedence is low, might produce unexpected result)</span>
<span class="k">if</span> <span class="n">got_needed_arguments</span> <span class="n">and</span> <span class="n">arguments_valid</span>
  <span class="c1"># ...body omitted</span>
<span class="k">end</span>
<span class="c1"># in logical expression calculation</span>
<span class="n">ok</span> <span class="o">=</span> <span class="n">got_needed_arguments</span> <span class="n">and</span> <span class="n">arguments_valid</span>

<span class="c1"># good</span>
<span class="c1"># &amp;&amp;/|| in conditions</span>
<span class="k">if</span> <span class="n">got_needed_arguments</span> <span class="o">&amp;&amp;</span> <span class="n">arguments_valid</span>
  <span class="c1"># ...body omitted</span>
<span class="k">end</span>
<span class="c1"># in logical expression calculation</span>
<span class="n">ok</span> <span class="o">=</span> <span class="n">got_needed_arguments</span> <span class="o">&amp;&amp;</span> <span class="n">arguments_valid</span>

<span class="c1"># bad</span>
<span class="c1"># &amp;&amp;/|| for control flow (can lead to very surprising results)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">extract_arguments</span> <span class="o">||</span> <span class="k">raise</span><span class="p">(</span><span class="no">ArgumentError</span><span class="p">,</span> <span class="s2">"Not enough arguments!"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Avoid several control flow operators in one expression, as that quickly
becomes confusing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="c1"># Did author mean conditional return because `#log` could result in `nil`?</span>
<span class="c1"># ...or was it just to have a smart one-liner?</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">extract_arguments</span> <span class="n">and</span> <span class="n">log</span><span class="p">(</span><span class="s2">"extracted"</span><span class="p">)</span> <span class="n">and</span> <span class="k">return</span>

<span class="c1"># good</span>
<span class="c1"># If the intention was conditional return</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">extract_arguments</span>
<span class="k">if</span> <span class="n">x</span>
  <span class="k">return</span> <span class="k">if</span> <span class="n">log</span><span class="p">(</span><span class="s2">"extracted"</span><span class="p">)</span>
<span class="k">end</span>
<span class="c1"># If the intention was just "log, then return"</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">extract_arguments</span>
<span class="k">if</span> <span class="n">x</span>
  <span class="n">log</span><span class="p">(</span><span class="s2">"extracted"</span><span class="p">)</span>
  <span class="k">return</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Whether organizing control flow with <code>and</code> and <code>or</code> is a good idea has been a controversial topic in the community for a long time. But if you do, prefer these operators over <code>&amp;&amp;</code>/<code>||</code>. As the different operators are meant to have different semantics that makes it easier to reason whether you&#8217;re dealing with a logical expression (that will get reduced to a boolean value) or with flow of control.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Why is using <code>and</code> and <code>or</code> as logical operators a bad idea?</div>
<div class="paragraph">
<p>Simply put - because they add some cognitive overhead, as they don&#8217;t behave like similarly named logical operators in other languages.</p>
</div>
<div class="paragraph">
<p>First of all, <code>and</code> and <code>or</code> operators have lower precedence than the <code>=</code> operator, whereas the <code>&amp;&amp;</code> and <code>||</code> operators have higher precedence than the <code>=</code> operator, based on order of operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">foo</span> <span class="o">=</span> <span class="kp">true</span> <span class="n">and</span> <span class="kp">false</span> <span class="c1"># results in foo being equal to true. Equivalent to (foo = true) and false</span>
<span class="n">bar</span> <span class="o">=</span> <span class="kp">false</span> <span class="n">or</span> <span class="kp">true</span>  <span class="c1"># results in bar being equal to false. Equivalent to (bar = false) or true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also <code>&amp;&amp;</code> has higher precedence than <code>||</code>, where as <code>and</code> and <code>or</code> have the same one. Funny enough, even though <code>and</code> and <code>or</code>
were inspired by Perl, they don&#8217;t have different precedence in Perl.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="kp">true</span> <span class="n">or</span> <span class="kp">true</span> <span class="n">and</span> <span class="kp">false</span> <span class="c1"># =&gt; false (it's effectively (true or true) and false)</span>
<span class="kp">true</span> <span class="o">||</span> <span class="kp">true</span> <span class="o">&amp;&amp;</span> <span class="kp">false</span> <span class="c1"># =&gt; true (it's effectively true || (true &amp;&amp; false)</span>
<span class="kp">false</span> <span class="n">or</span> <span class="kp">true</span> <span class="n">and</span> <span class="kp">false</span> <span class="c1"># =&gt; false (it's effectively (false or true) and false)</span>
<span class="kp">false</span> <span class="o">||</span> <span class="kp">true</span> <span class="o">&amp;&amp;</span> <span class="kp">false</span> <span class="c1"># =&gt; false (it's effectively false || (true &amp;&amp; false))</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-multiline-ternary"><a class="anchor" href="#no-multiline-ternary"></a><a class="link" href="#no-multiline-ternary">Multi-line Ternary Operator</a></h3>
<div class="paragraph">
<p>Avoid multi-line <code>?:</code> (the ternary operator); use <code>if</code>/<code>unless</code> instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="if-as-a-modifier"><a class="anchor" href="#if-as-a-modifier"></a><a class="link" href="#if-as-a-modifier"><code>if</code> as a Modifier</a></h3>
<div class="paragraph">
<p>Prefer modifier <code>if</code>/<code>unless</code> usage when you have a single-line body.
Another good alternative is the usage of control flow <code>and</code>/<code>or</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span> <span class="n">some_condition</span>
  <span class="n">do_something</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">some_condition</span>

<span class="c1"># another good option</span>
<span class="n">some_condition</span> <span class="n">and</span> <span class="n">do_something</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-multiline-if-modifiers"><a class="anchor" href="#no-multiline-if-modifiers"></a><a class="link" href="#no-multiline-if-modifiers">Multi-line <code>if</code> Modifiers</a></h3>
<div class="paragraph">
<p>Avoid modifier <code>if</code>/<code>unless</code> usage at the end of a non-trivial multi-line block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="mi">10</span><span class="p">.</span><span class="nf">times</span> <span class="k">do</span>
  <span class="c1"># multi-line body omitted</span>
<span class="k">end</span> <span class="k">if</span> <span class="n">some_condition</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">some_condition</span>
  <span class="mi">10</span><span class="p">.</span><span class="nf">times</span> <span class="k">do</span>
    <span class="c1"># multi-line body omitted</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-nested-modifiers"><a class="anchor" href="#no-nested-modifiers"></a><a class="link" href="#no-nested-modifiers">Nested Modifiers</a></h3>
<div class="paragraph">
<p>Avoid nested modifier <code>if</code>/<code>unless</code>/<code>while</code>/<code>until</code> usage.
Prefer <code>&amp;&amp;</code>/<code>||</code> if appropriate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">other_condition</span> <span class="k">if</span> <span class="n">some_condition</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">some_condition</span> <span class="o">&amp;&amp;</span> <span class="n">other_condition</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="unless-for-negatives"><a class="anchor" href="#unless-for-negatives"></a><a class="link" href="#unless-for-negatives"><code>if</code> vs <code>unless</code></a></h3>
<div class="paragraph">
<p>Prefer <code>unless</code> over <code>if</code> for negative conditions (or control flow <code>||</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="o">!</span><span class="n">some_condition</span>

<span class="c1"># bad</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">not</span> <span class="n">some_condition</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">unless</span> <span class="n">some_condition</span>

<span class="c1"># another good option</span>
<span class="n">some_condition</span> <span class="o">||</span> <span class="n">do_something</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-else-with-unless"><a class="anchor" href="#no-else-with-unless"></a><a class="link" href="#no-else-with-unless">Using <code>else</code> with <code>unless</code></a></h3>
<div class="paragraph">
<p>Do not use <code>unless</code> with <code>else</code>.
Rewrite these with the positive case first.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">unless</span> <span class="n">success?</span>
  <span class="nb">puts</span> <span class="s1">'failure'</span>
<span class="k">else</span>
  <span class="nb">puts</span> <span class="s1">'success'</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">success?</span>
  <span class="nb">puts</span> <span class="s1">'success'</span>
<span class="k">else</span>
  <span class="nb">puts</span> <span class="s1">'failure'</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-parens-around-condition"><a class="anchor" href="#no-parens-around-condition"></a><a class="link" href="#no-parens-around-condition">Parentheses around Condition</a></h3>
<div class="paragraph">
<p>Don&#8217;t use parentheses around the condition of a control expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is an exception to this rule, namely <a href="#safe-assignment-in-condition">safe assignment in condition</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="no-multiline-while-do"><a class="anchor" href="#no-multiline-while-do"></a><a class="link" href="#no-multiline-while-do">Multi-line <code>while do</code></a></h3>
<div class="paragraph">
<p>Do not use <code>while/until condition do</code> for multi-line <code>while/until</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">while</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">do</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="k">until</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">do</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">while</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="k">until</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="while-as-a-modifier"><a class="anchor" href="#while-as-a-modifier"></a><a class="link" href="#while-as-a-modifier"><code>while</code> as a Modifier</a></h3>
<div class="paragraph">
<p>Prefer modifier <code>while/until</code> usage when you have a single-line body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">while</span> <span class="n">some_condition</span>
  <span class="n">do_something</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">while</span> <span class="n">some_condition</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="until-for-negatives"><a class="anchor" href="#until-for-negatives"></a><a class="link" href="#until-for-negatives"><code>while</code> vs <code>until</code></a></h3>
<div class="paragraph">
<p>Prefer <code>until</code> over <code>while</code> for negative conditions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">do_something</span> <span class="k">while</span> <span class="o">!</span><span class="n">some_condition</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">until</span> <span class="n">some_condition</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="infinite-loop"><a class="anchor" href="#infinite-loop"></a><a class="link" href="#infinite-loop">Infinite Loop</a></h3>
<div class="paragraph">
<p>Use <code>Kernel#loop</code> instead of <code>while</code>/<code>until</code> when you need an infinite loop.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">while</span> <span class="kp">true</span>
  <span class="n">do_something</span>
<span class="k">end</span>

<span class="k">until</span> <span class="kp">false</span>
  <span class="n">do_something</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="kp">loop</span> <span class="k">do</span>
  <span class="n">do_something</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="loop-with-break"><a class="anchor" href="#loop-with-break"></a><a class="link" href="#loop-with-break"><code>loop</code> with <code>break</code></a></h3>
<div class="paragraph">
<p>Use <code>Kernel#loop</code> with <code>break</code> rather than <code>begin/end/until</code> or <code>begin/end/while</code> for post-loop tests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">begin</span>
  <span class="nb">puts</span> <span class="n">val</span>
  <span class="n">val</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">end</span> <span class="k">while</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span>

<span class="c1"># good</span>
<span class="kp">loop</span> <span class="k">do</span>
  <span class="nb">puts</span> <span class="n">val</span>
  <span class="n">val</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">break</span> <span class="k">unless</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-explicit-return"><a class="anchor" href="#no-explicit-return"></a><a class="link" href="#no-explicit-return">Explicit <code>return</code></a></h3>
<div class="paragraph">
<p>Avoid <code>return</code> where not required for flow of control.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">some_arr</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">some_arr</span><span class="p">.</span><span class="nf">size</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">some_arr</span><span class="p">)</span>
  <span class="n">some_arr</span><span class="p">.</span><span class="nf">size</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-self-unless-required"><a class="anchor" href="#no-self-unless-required"></a><a class="link" href="#no-self-unless-required">Explicit <code>self</code></a></h3>
<div class="paragraph">
<p>Avoid <code>self</code> where not required.
(It is only required when calling a <code>self</code> write accessor, methods named after reserved words, or overloadable operators.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">ready?</span>
  <span class="k">if</span> <span class="nb">self</span><span class="p">.</span><span class="nf">last_reviewed_at</span> <span class="o">&gt;</span> <span class="nb">self</span><span class="p">.</span><span class="nf">last_updated_at</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">worker</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="nf">content</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="nf">options</span><span class="p">)</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">status</span> <span class="o">=</span> <span class="ss">:in_progress</span>
  <span class="k">end</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">status</span> <span class="o">==</span> <span class="ss">:verified</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">ready?</span>
  <span class="k">if</span> <span class="n">last_reviewed_at</span> <span class="o">&gt;</span> <span class="n">last_updated_at</span>
    <span class="n">worker</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">status</span> <span class="o">=</span> <span class="ss">:in_progress</span>
  <span class="k">end</span>
  <span class="n">status</span> <span class="o">==</span> <span class="ss">:verified</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-shadowing"><a class="anchor" href="#no-shadowing"></a><a class="link" href="#no-shadowing">Shadowing Methods</a></h3>
<div class="paragraph">
<p>As a corollary, avoid shadowing methods with local variables unless they are both equivalent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Foo</span>
  <span class="nb">attr_accessor</span> <span class="ss">:options</span>

  <span class="c1"># ok</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">options</span> <span class="o">=</span> <span class="n">options</span>
    <span class="c1"># both options and self.options are equivalent here</span>
  <span class="k">end</span>

  <span class="c1"># bad</span>
  <span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="k">unless</span> <span class="n">options</span><span class="p">[</span><span class="ss">:when</span><span class="p">]</span> <span class="o">==</span> <span class="ss">:later</span>
      <span class="n">output</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="nf">options</span><span class="p">[</span><span class="ss">:message</span><span class="p">])</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="c1"># good</span>
  <span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="k">unless</span> <span class="n">params</span><span class="p">[</span><span class="ss">:when</span><span class="p">]</span> <span class="o">==</span> <span class="ss">:later</span>
      <span class="n">output</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="ss">:message</span><span class="p">])</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="safe-assignment-in-condition"><a class="anchor" href="#safe-assignment-in-condition"></a><a class="link" href="#safe-assignment-in-condition">Safe Assignment in Condition</a></h3>
<div class="paragraph">
<p>Don&#8217;t use the return value of <code>=</code> (an assignment) in conditional expressions unless the assignment is wrapped in parentheses.
This is a fairly popular idiom among Rubyists that&#8217;s sometimes referred to as <em>safe assignment in condition</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad (+ a warning)</span>
<span class="k">if</span> <span class="n">v</span> <span class="o">=</span> <span class="n">array</span><span class="p">.</span><span class="nf">grep</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">)</span>
  <span class="n">do_something</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="c1"># good (MRI would still complain, but RuboCop won't)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">=</span> <span class="n">array</span><span class="p">.</span><span class="nf">grep</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">))</span>
  <span class="n">do_something</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
  <span class="c1"># some code</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">array</span><span class="p">.</span><span class="nf">grep</span><span class="p">(</span><span class="sr">/foo/</span><span class="p">)</span>
<span class="k">if</span> <span class="n">v</span>
  <span class="n">do_something</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
  <span class="c1"># some code</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-BEGIN-blocks"><a class="anchor" href="#no-BEGIN-blocks"></a><a class="link" href="#no-BEGIN-blocks"><code>BEGIN</code> Blocks</a></h3>
<div class="paragraph">
<p>Avoid the use of <code>BEGIN</code> blocks.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-END-blocks"><a class="anchor" href="#no-END-blocks"></a><a class="link" href="#no-END-blocks"><code>END</code> Blocks</a></h3>
<div class="paragraph">
<p>Do not use <code>END</code> blocks. Use <code>Kernel#at_exit</code> instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">END</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s1">'Goodbye!'</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="nb">at_exit</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s1">'Goodbye!'</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-nested-conditionals"><a class="anchor" href="#no-nested-conditionals"></a><a class="link" href="#no-nested-conditionals">Nested Conditionals</a></h3>
<div class="paragraph">
<p>Avoid use of nested conditionals for flow of control.</p>
</div>
<div class="paragraph">
<p>Prefer a guard clause when you can assert invalid data.
A guard clause is a conditional statement at the top of a function that bails out as soon as it can.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">compute_thing</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">thing</span><span class="p">[</span><span class="ss">:foo</span><span class="p">]</span>
    <span class="n">update_with_bar</span><span class="p">(</span><span class="n">thing</span><span class="p">[</span><span class="ss">:foo</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">thing</span><span class="p">[</span><span class="ss">:foo</span><span class="p">][</span><span class="ss">:bar</span><span class="p">]</span>
      <span class="n">partial_compute</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="n">re_compute</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">compute_thing</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
  <span class="k">return</span> <span class="k">unless</span> <span class="n">thing</span><span class="p">[</span><span class="ss">:foo</span><span class="p">]</span>
  <span class="n">update_with_bar</span><span class="p">(</span><span class="n">thing</span><span class="p">[</span><span class="ss">:foo</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">re_compute</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span> <span class="k">unless</span> <span class="n">thing</span><span class="p">[</span><span class="ss">:foo</span><span class="p">][</span><span class="ss">:bar</span><span class="p">]</span>
  <span class="n">partial_compute</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Prefer <code>next</code> in loops instead of conditional blocks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="nb">puts</span> <span class="n">item</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
  <span class="k">next</span> <span class="k">unless</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="mi">1</span>
  <span class="nb">puts</span> <span class="n">item</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exceptions"><a class="anchor" href="#exceptions"></a><a class="link" href="#exceptions">Exceptions</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="prefer-raise-over-fail"><a class="anchor" href="#prefer-raise-over-fail"></a><a class="link" href="#prefer-raise-over-fail"><code>raise</code> vs <code>fail</code></a></h3>
<div class="paragraph">
<p>Prefer <code>raise</code> over <code>fail</code> for exceptions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">fail</span> <span class="no">SomeException</span><span class="p">,</span> <span class="s1">'message'</span>

<span class="c1"># good</span>
<span class="k">raise</span> <span class="no">SomeException</span><span class="p">,</span> <span class="s1">'message'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-explicit-runtimeerror"><a class="anchor" href="#no-explicit-runtimeerror"></a><a class="link" href="#no-explicit-runtimeerror">Raising Explicit <code>RuntimeError</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t specify <code>RuntimeError</code> explicitly in the two argument version of <code>raise</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">raise</span> <span class="no">RuntimeError</span><span class="p">,</span> <span class="s1">'message'</span>

<span class="c1"># good - signals a RuntimeError by default</span>
<span class="k">raise</span> <span class="s1">'message'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exception-class-messages"><a class="anchor" href="#exception-class-messages"></a><a class="link" href="#exception-class-messages">Exception Class Messages</a></h3>
<div class="paragraph">
<p>Prefer supplying an exception class and a message as two separate arguments to <code>raise</code>, instead of an exception instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">raise</span> <span class="no">SomeException</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'message'</span><span class="p">)</span>
<span class="c1"># Note that there is no way to do `raise SomeException.new('message'), backtrace`.</span>

<span class="c1"># good</span>
<span class="k">raise</span> <span class="no">SomeException</span><span class="p">,</span> <span class="s1">'message'</span>
<span class="c1"># Consistent with `raise SomeException, 'message', backtrace`.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-return-ensure"><a class="anchor" href="#no-return-ensure"></a><a class="link" href="#no-return-ensure"><code>return</code> from <code>ensure</code></a></h3>
<div class="paragraph">
<p>Do not return from an <code>ensure</code> block.
If you explicitly return from a method inside an <code>ensure</code> block, the return will take precedence over any exception being raised, and the method will return as if no exception had been raised at all.
In effect, the exception will be silently thrown away.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">foo</span>
  <span class="k">raise</span>
<span class="k">ensure</span>
  <span class="k">return</span> <span class="s1">'very bad idea'</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="begin-implicit"><a class="anchor" href="#begin-implicit"></a><a class="link" href="#begin-implicit">Implicit <code>begin</code></a></h3>
<div class="paragraph">
<p>Use <em>implicit begin blocks</em> where possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">foo</span>
  <span class="k">begin</span>
    <span class="c1"># main logic goes here</span>
  <span class="k">rescue</span>
    <span class="c1"># failure handling goes here</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">foo</span>
  <span class="c1"># main logic goes here</span>
<span class="k">rescue</span>
  <span class="c1"># failure handling goes here</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="contingency-methods"><a class="anchor" href="#contingency-methods"></a><a class="link" href="#contingency-methods">Contingency Methods</a></h3>
<div class="paragraph">
<p>Mitigate the proliferation of <code>begin</code> blocks by using <em>contingency methods</em> (a term coined by Avdi Grimm).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">begin</span>
  <span class="n">something_that_might_fail</span>
<span class="k">rescue</span> <span class="no">IOError</span>
  <span class="c1"># handle IOError</span>
<span class="k">end</span>

<span class="k">begin</span>
  <span class="n">something_else_that_might_fail</span>
<span class="k">rescue</span> <span class="no">IOError</span>
  <span class="c1"># handle IOError</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">with_io_error_handling</span>
  <span class="k">yield</span>
<span class="k">rescue</span> <span class="no">IOError</span>
  <span class="c1"># handle IOError</span>
<span class="k">end</span>

<span class="n">with_io_error_handling</span> <span class="p">{</span> <span class="n">something_that_might_fail</span> <span class="p">}</span>

<span class="n">with_io_error_handling</span> <span class="p">{</span> <span class="n">something_else_that_might_fail</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dont-hide-exceptions"><a class="anchor" href="#dont-hide-exceptions"></a><a class="link" href="#dont-hide-exceptions">Suppressing Exceptions</a></h3>
<div class="paragraph">
<p>Don&#8217;t suppress exceptions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">begin</span>
  <span class="n">do_something</span> <span class="c1"># an exception occurs here</span>
<span class="k">rescue</span> <span class="no">SomeError</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">begin</span>
  <span class="n">do_something</span> <span class="c1"># an exception occurs here</span>
<span class="k">rescue</span> <span class="no">SomeError</span>
  <span class="n">handle_exception</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">begin</span>
  <span class="n">do_something</span> <span class="c1"># an exception occurs here</span>
<span class="k">rescue</span> <span class="no">SomeError</span>
  <span class="c1"># Notes on why exception handling is not performed</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">rescue</span> <span class="kp">nil</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-rescue-modifiers"><a class="anchor" href="#no-rescue-modifiers"></a><a class="link" href="#no-rescue-modifiers">Using <code>rescue</code> as a Modifier</a></h3>
<div class="paragraph">
<p>Avoid using <code>rescue</code> in its modifier form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - this catches exceptions of StandardError class and its descendant classes</span>
<span class="n">read_file</span> <span class="k">rescue</span> <span class="n">handle_error</span><span class="p">(</span><span class="vg">$!</span><span class="p">)</span>

<span class="c1"># good - this catches only the exceptions of Errno::ENOENT class and its descendant classes</span>
<span class="k">def</span> <span class="nf">foo</span>
  <span class="n">read_file</span>
<span class="k">rescue</span> <span class="no">Errno</span><span class="o">::</span><span class="no">ENOENT</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="n">handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-exceptional-flows"><a class="anchor" href="#no-exceptional-flows"></a><a class="link" href="#no-exceptional-flows">Using Exceptions for Flow of Control</a></h3>
<div class="paragraph">
<p>Don&#8217;t use exceptions for flow of control.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">begin</span>
  <span class="n">n</span> <span class="o">/</span> <span class="n">d</span>
<span class="k">rescue</span> <span class="no">ZeroDivisionError</span>
  <span class="nb">puts</span> <span class="s1">'Cannot divide by 0!'</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">d</span><span class="p">.</span><span class="nf">zero?</span>
  <span class="nb">puts</span> <span class="s1">'Cannot divide by 0!'</span>
<span class="k">else</span>
  <span class="n">n</span> <span class="o">/</span> <span class="n">d</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-blind-rescues"><a class="anchor" href="#no-blind-rescues"></a><a class="link" href="#no-blind-rescues">Blind Rescues</a></h3>
<div class="paragraph">
<p>Avoid rescuing the <code>Exception</code> class.
This will trap signals and calls to <code>exit</code>, requiring you to <code>kill -9</code> the process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">begin</span>
  <span class="c1"># calls to exit and kill signals will be caught (except kill -9)</span>
  <span class="nb">exit</span>
<span class="k">rescue</span> <span class="no">Exception</span>
  <span class="nb">puts</span> <span class="s2">"you didn't really want to exit, right?"</span>
  <span class="c1"># exception handling</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">begin</span>
  <span class="c1"># a blind rescue rescues from StandardError, not Exception as many</span>
  <span class="c1"># programmers assume.</span>
<span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># exception handling</span>
<span class="k">end</span>

<span class="c1"># also good</span>
<span class="k">begin</span>
  <span class="c1"># an exception occurs here</span>
<span class="k">rescue</span> <span class="no">StandardError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># exception handling</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exception-ordering"><a class="anchor" href="#exception-ordering"></a><a class="link" href="#exception-ordering">Exception Rescuing Ordering</a></h3>
<div class="paragraph">
<p>Put more specific exceptions higher up the rescue chain, otherwise they&#8217;ll never be rescued from.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">begin</span>
  <span class="c1"># some code</span>
<span class="k">rescue</span> <span class="no">StandardError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># some handling</span>
<span class="k">rescue</span> <span class="no">IOError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># some handling that will never be executed</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">begin</span>
  <span class="c1"># some code</span>
<span class="k">rescue</span> <span class="no">IOError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># some handling</span>
<span class="k">rescue</span> <span class="no">StandardError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># some handling</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="standard-exceptions"><a class="anchor" href="#standard-exceptions"></a><a class="link" href="#standard-exceptions">Standard Exceptions</a></h3>
<div class="paragraph">
<p>Prefer the use of exceptions from the standard library over introducing new exception classes.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="files"><a class="anchor" href="#files"></a><a class="link" href="#files">Files</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="file-read"><a class="anchor" href="#file-read"></a><a class="link" href="#file-read">Reading from a file</a></h3>
<div class="paragraph">
<p>Use the convenience methods <code>File.read</code> or <code>File.binread</code> when only reading a file start to finish in a single operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1">## text mode</span>
<span class="c1"># bad (only when reading from beginning to end - modes: 'r', 'rt', 'r+', 'r+t')</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">).</span><span class="nf">read</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">&amp;</span><span class="ss">:read</span><span class="p">)</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span> <span class="p">}</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">f</span><span class="p">.</span><span class="nf">read</span>
<span class="k">end</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">).</span><span class="nf">read</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="o">&amp;</span><span class="ss">:read</span><span class="p">)</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span> <span class="p">}</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">f</span><span class="p">.</span><span class="nf">read</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="c1">## binary mode</span>
<span class="c1"># bad (only when reading from beginning to end - modes: 'rb', 'r+b')</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">).</span><span class="nf">read</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">,</span> <span class="o">&amp;</span><span class="ss">:read</span><span class="p">)</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span> <span class="p">}</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">f</span><span class="p">.</span><span class="nf">read</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="no">File</span><span class="p">.</span><span class="nf">binread</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="file-write"><a class="anchor" href="#file-write"></a><a class="link" href="#file-write">Writing to a file</a></h3>
<div class="paragraph">
<p>Use the convenience methods <code>File.write</code> or <code>File.binwrite</code> when only opening a file to create / replace its content in a single operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1">## text mode</span>
<span class="c1"># bad (only truncating modes: 'w', 'wt', 'w+', 'w+t')</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">).</span><span class="nf">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="p">}</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="no">File</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>

<span class="c1">## binary mode</span>
<span class="c1"># bad (only truncating modes: 'wb', 'w+b')</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">).</span><span class="nf">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="p">}</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="no">File</span><span class="p">.</span><span class="nf">binwrite</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="release-resources"><a class="anchor" href="#release-resources"></a><a class="link" href="#release-resources">Release External Resources</a></h3>
<div class="paragraph">
<p>Release external resources obtained by your program in an <code>ensure</code> block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">f</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s1">'testfile'</span><span class="p">)</span>
<span class="k">begin</span>
  <span class="c1"># .. process</span>
<span class="k">rescue</span>
  <span class="c1"># .. handle error</span>
<span class="k">ensure</span>
  <span class="n">f</span><span class="p">.</span><span class="nf">close</span> <span class="k">if</span> <span class="n">f</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="auto-release-resources"><a class="anchor" href="#auto-release-resources"></a><a class="link" href="#auto-release-resources">Auto-release External Resources</a></h3>
<div class="paragraph">
<p>Use versions of resource obtaining methods that do automatic resource cleanup when possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - you need to close the file descriptor explicitly</span>
<span class="n">f</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s1">'testfile'</span><span class="p">)</span>
<span class="c1"># some action on the file</span>
<span class="n">f</span><span class="p">.</span><span class="nf">close</span>

<span class="c1"># good - the file descriptor is closed automatically</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s1">'testfile'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="c1"># some action on the file</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="atomic-file-operations"><a class="anchor" href="#atomic-file-operations"></a><a class="link" href="#atomic-file-operations">Atomic File Operations</a></h3>
<div class="paragraph">
<p>When doing file operations after confirming the existence check of a file, frequent parallel file operations may cause problems that are difficult to reproduce.
Therefore, it is preferable to use atomic file operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - race condition with another process may result in an error in `mkdir`</span>
<span class="k">unless</span> <span class="no">Dir</span><span class="p">.</span><span class="nf">exist?</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
  <span class="no">FileUtils</span><span class="p">.</span><span class="nf">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good - atomic and idempotent creation</span>
<span class="no">FileUtils</span><span class="p">.</span><span class="nf">mkdir_p</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="c1"># bad - race condition with another process may result in an error in `remove`</span>
<span class="k">if</span> <span class="no">File</span><span class="p">.</span><span class="nf">exist?</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
  <span class="no">FileUtils</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good - atomic and idempotent removal</span>
<span class="no">FileUtils</span><span class="p">.</span><span class="nf">rm_f</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="null-devices"><a class="anchor" href="#null-devices"></a><a class="link" href="#null-devices">Null Devices</a></h3>
<div class="paragraph">
<p>Use the platform independent null device (<code>File::NULL</code>) rather than hardcoding a value (<code>/dev/null</code> on Unix-like OSes, <code>NUL</code> or <code>NUL:</code> on Windows).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - hardcoded devices are platform specific</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">"/dev/null"</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c1"># bad - unnecessary ternary can be replaced with `File::NULL`</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="no">Gem</span><span class="p">.</span><span class="nf">win_platform?</span> <span class="p">?</span> <span class="s1">'NUL'</span> <span class="p">:</span> <span class="s1">'/dev/null'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c1"># good - platform independent</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="no">File</span><span class="o">::</span><span class="no">NULL</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assignment-comparison"><a class="anchor" href="#assignment-comparison"></a><a class="link" href="#assignment-comparison">Assignment &amp; Comparison</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="parallel-assignment"><a class="anchor" href="#parallel-assignment"></a><a class="link" href="#parallel-assignment">Parallel Assignment</a></h3>
<div class="paragraph">
<p>Avoid the use of parallel assignment for defining variables.
Parallel assignment is allowed when it is the return of a method call (e.g. <code>Hash#values_at</code>), used with the splat operator, or when used to swap variable assignment.
Parallel assignment is less readable than separate assignment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">,</span> <span class="s1">'baz'</span><span class="p">,</span> <span class="s1">'foobar'</span>

<span class="c1"># good</span>
<span class="n">a</span> <span class="o">=</span> <span class="s1">'foo'</span>
<span class="n">b</span> <span class="o">=</span> <span class="s1">'bar'</span>
<span class="n">c</span> <span class="o">=</span> <span class="s1">'baz'</span>
<span class="n">d</span> <span class="o">=</span> <span class="s1">'foobar'</span>

<span class="c1"># good - swapping variable assignment</span>
<span class="c1"># Swapping variable assignment is a special case because it will allow you to</span>
<span class="c1"># swap the values that are assigned to each variable.</span>
<span class="n">a</span> <span class="o">=</span> <span class="s1">'foo'</span>
<span class="n">b</span> <span class="o">=</span> <span class="s1">'bar'</span>

<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
<span class="nb">puts</span> <span class="n">a</span> <span class="c1"># =&gt; 'bar'</span>
<span class="nb">puts</span> <span class="n">b</span> <span class="c1"># =&gt; 'foo'</span>

<span class="c1"># good - method return</span>
<span class="k">def</span> <span class="nf">multi_return</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="k">end</span>

<span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="n">multi_return</span>

<span class="c1"># good - use with splat</span>
<span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># first =&gt; 1, list =&gt; [2, 3, 4]</span>

<span class="n">hello_array</span> <span class="o">=</span> <span class="o">*</span><span class="s1">'Hello'</span> <span class="c1"># =&gt; ["Hello"]</span>

<span class="n">a</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># =&gt; [1, 2, 3]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="values-swapping"><a class="anchor" href="#values-swapping"></a><a class="link" href="#values-swapping">Values Swapping</a></h3>
<div class="paragraph">
<p>Use parallel assignment when swapping 2 values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tmp</span>

<span class="c1"># good</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trailing-underscore-variables"><a class="anchor" href="#trailing-underscore-variables"></a><a class="link" href="#trailing-underscore-variables">Dealing with Trailing Underscore Variables in Destructuring Assignment</a></h3>
<div class="paragraph">
<p>Avoid the use of unnecessary trailing underscore variables during
parallel assignment. Named underscore variables are to be preferred over
underscore variables because of the context that they provide.
Trailing underscore variables are necessary when there is a splat variable
defined on the left side of the assignment, and the splat variable is
not an underscore.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">foo</span> <span class="o">=</span> <span class="s1">'one,two,three,four,five'</span>
<span class="c1"># Unnecessary assignment that does not provide useful information</span>
<span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="n">first</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">foo</span> <span class="o">=</span> <span class="s1">'one,two,three,four,five'</span>
<span class="c1"># The underscores are needed to show that you want all elements</span>
<span class="c1"># except for the last number of underscore elements</span>
<span class="o">*</span><span class="n">beginning</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="o">*</span><span class="n">beginning</span><span class="p">,</span> <span class="n">something</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>

<span class="n">a</span><span class="p">,</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="c1"># Unnecessary assignment to an unused variable, but the assignment</span>
<span class="c1"># provides us with useful information.</span>
<span class="n">first</span><span class="p">,</span> <span class="n">_second</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="n">first</span><span class="p">,</span> <span class="n">_second</span><span class="p">,</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">_ending</span> <span class="o">=</span> <span class="n">foo</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="self-assignment"><a class="anchor" href="#self-assignment"></a><a class="link" href="#self-assignment">Self-assignment</a></h3>
<div class="paragraph">
<p>Use shorthand self assignment operators whenever applicable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">||</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">y</span>

<span class="c1"># good</span>
<span class="n">x</span> <span class="o">+=</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">*=</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">**=</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">/=</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">||=</span> <span class="n">y</span>
<span class="n">x</span> <span class="o">&amp;&amp;=</span> <span class="n">y</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="double-pipe-for-uninit"><a class="anchor" href="#double-pipe-for-uninit"></a><a class="link" href="#double-pipe-for-uninit">Conditional Variable Initialization Shorthand</a></h3>
<div class="paragraph">
<p>Use <code>||=</code> to initialize variables only if they&#8217;re not already initialized.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">name</span> <span class="o">=</span> <span class="nb">name</span> <span class="p">?</span> <span class="nb">name</span> <span class="p">:</span> <span class="s1">'Bozhidar'</span>

<span class="c1"># bad</span>
<span class="nb">name</span> <span class="o">=</span> <span class="s1">'Bozhidar'</span> <span class="k">unless</span> <span class="nb">name</span>

<span class="c1"># good - set name to 'Bozhidar', only if it's nil or false</span>
<span class="nb">name</span> <span class="o">||=</span> <span class="s1">'Bozhidar'</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Don&#8217;t use <code>||=</code> to initialize boolean variables.
(Consider what would happen if the current value happened to be <code>false</code>.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - would set enabled to true even if it was false</span>
<span class="n">enabled</span> <span class="o">||=</span> <span class="kp">true</span>

<span class="c1"># good</span>
<span class="n">enabled</span> <span class="o">=</span> <span class="kp">true</span> <span class="k">if</span> <span class="n">enabled</span><span class="p">.</span><span class="nf">nil?</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="double-amper-preprocess"><a class="anchor" href="#double-amper-preprocess"></a><a class="link" href="#double-amper-preprocess">Existence Check Shorthand</a></h3>
<div class="paragraph">
<p>Use <code>&amp;&amp;=</code> to preprocess variables that may or may not exist.
Using <code>&amp;&amp;=</code> will change the value only if it exists, removing the need to check its existence with <code>if</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span> <span class="n">something</span>
  <span class="n">something</span> <span class="o">=</span> <span class="n">something</span><span class="p">.</span><span class="nf">downcase</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="n">something</span> <span class="o">=</span> <span class="n">something</span> <span class="p">?</span> <span class="n">something</span><span class="p">.</span><span class="nf">downcase</span> <span class="p">:</span> <span class="kp">nil</span>

<span class="c1"># ok</span>
<span class="n">something</span> <span class="o">=</span> <span class="n">something</span><span class="p">.</span><span class="nf">downcase</span> <span class="k">if</span> <span class="n">something</span>

<span class="c1"># good</span>
<span class="n">something</span> <span class="o">=</span> <span class="n">something</span> <span class="o">&amp;&amp;</span> <span class="n">something</span><span class="p">.</span><span class="nf">downcase</span>

<span class="c1"># better</span>
<span class="n">something</span> <span class="o">&amp;&amp;=</span> <span class="n">something</span><span class="p">.</span><span class="nf">downcase</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="identity-comparison"><a class="anchor" href="#identity-comparison"></a><a class="link" href="#identity-comparison">Identity Comparison</a></h3>
<div class="paragraph">
<p>Prefer <code>equal?</code> over <code>==</code> when comparing <code>object_id</code>. <code>Object#equal?</code> is provided to compare objects for identity, and in contrast <code>Object#==</code> is provided for the purpose of doing value comparison.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">foo</span><span class="p">.</span><span class="nf">object_id</span> <span class="o">==</span> <span class="n">bar</span><span class="p">.</span><span class="nf">object_id</span>

<span class="c1"># good</span>
<span class="n">foo</span><span class="p">.</span><span class="nf">equal?</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, prefer using <code>Hash#compare_by_identity</code> than using <code>object_id</code> for keys:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{}</span>
<span class="nb">hash</span><span class="p">[</span><span class="n">foo</span><span class="p">.</span><span class="nf">object_id</span><span class="p">]</span> <span class="o">=</span> <span class="ss">:bar</span>
<span class="k">if</span> <span class="nb">hash</span><span class="p">.</span><span class="nf">key?</span><span class="p">(</span><span class="n">baz</span><span class="p">.</span><span class="nf">object_id</span><span class="p">)</span> <span class="c1"># ...</span>

<span class="c1"># good</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{}.</span><span class="nf">compare_by_identity</span>
<span class="nb">hash</span><span class="p">[</span><span class="n">foo</span><span class="p">]</span> <span class="o">=</span> <span class="ss">:bar</span>
<span class="k">if</span> <span class="nb">hash</span><span class="p">.</span><span class="nf">key?</span><span class="p">(</span><span class="n">baz</span><span class="p">)</span> <span class="c1"># ...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>Set</code> also has <code>Set#compare_by_identity</code> available.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-case-equality"><a class="anchor" href="#no-case-equality"></a><a class="link" href="#no-case-equality">Explicit Use of the Case Equality Operator</a></h3>
<div class="paragraph">
<p>Avoid explicit use of the case equality operator <code>===</code>.
As its name implies it is meant to be used implicitly by <code>case</code> expressions and outside of them it yields some pretty confusing code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Array</span> <span class="o">===</span> <span class="n">something</span>
<span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">)</span> <span class="o">===</span> <span class="mi">7</span>
<span class="sr">/something/</span> <span class="o">===</span> <span class="n">some_string</span>

<span class="c1"># good</span>
<span class="n">something</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Array</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">).</span><span class="nf">include?</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">some_string</span><span class="p">.</span><span class="nf">match?</span><span class="p">(</span><span class="sr">/something/</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
With direct subclasses of <code>BasicObject</code>, using <code>is_a?</code> is not an option since <code>BasicObject</code> doesn&#8217;t provide that method (it&#8217;s defined in <code>Object</code>). In those
rare cases it&#8217;s OK to use <code>===</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="is-a-vs-kind-of"><a class="anchor" href="#is-a-vs-kind-of"></a><a class="link" href="#is-a-vs-kind-of"><code>is_a?</code> vs <code>kind_of?</code></a></h3>
<div class="paragraph">
<p>Prefer <code>is_a?</code> over <code>kind_of?</code>. The two methods are synonyms, but <code>is_a?</code> is the more commonly used name in the wild.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">something</span><span class="p">.</span><span class="nf">kind_of?</span><span class="p">(</span><span class="no">Array</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">something</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Array</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="is-a-vs-instance-of"><a class="anchor" href="#is-a-vs-instance-of"></a><a class="link" href="#is-a-vs-instance-of"><code>is_a?</code> vs <code>instance_of?</code></a></h3>
<div class="paragraph">
<p>Prefer <code>is_a?</code> over <code>instance_of?</code>.</p>
</div>
<div class="paragraph">
<p>While the two methods are similar, <code>is_a?</code> will consider the whole inheritance
chain (superclasses and included modules), which is what you normally would want
to do. <code>instance_of?</code>, on the other hand, only returns <code>true</code> if an object is an
instance of that exact class you&#8217;re checking for, not a subclass.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">something</span><span class="p">.</span><span class="nf">instance_of?</span><span class="p">(</span><span class="no">Array</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">something</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Array</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="instance-of-vs-class-comparison"><a class="anchor" href="#instance-of-vs-class-comparison"></a><a class="link" href="#instance-of-vs-class-comparison"><code>instance_of?</code> vs class comparison</a></h3>
<div class="paragraph">
<p>Use <code>Object#instance_of?</code> instead of class comparison for equality.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">var</span><span class="p">.</span><span class="nf">class</span> <span class="o">==</span> <span class="no">Date</span>
<span class="n">var</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">equal?</span><span class="p">(</span><span class="no">Date</span><span class="p">)</span>
<span class="n">var</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">eql?</span><span class="p">(</span><span class="no">Date</span><span class="p">)</span>
<span class="n">var</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">name</span> <span class="o">==</span> <span class="s1">'Date'</span>

<span class="c1"># good</span>
<span class="n">var</span><span class="p">.</span><span class="nf">instance_of?</span><span class="p">(</span><span class="no">Date</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="eql"><a class="anchor" href="#eql"></a><a class="link" href="#eql"><code>==</code> vs <code>eql?</code></a></h3>
<div class="paragraph">
<p>Do not use <code>eql?</code> when using <code>==</code> will do.
The stricter comparison semantics provided by <code>eql?</code> are rarely needed in practice.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - eql? is the same as == for strings</span>
<span class="s1">'ruby'</span><span class="p">.</span><span class="nf">eql?</span> <span class="n">some_str</span>

<span class="c1"># good</span>
<span class="s1">'ruby'</span> <span class="o">==</span> <span class="n">some_str</span>
<span class="mf">1.0</span><span class="p">.</span><span class="nf">eql?</span> <span class="n">x</span> <span class="c1"># eql? makes sense here if want to differentiate between Integer and Float 1</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="blocks-procs-lambdas"><a class="anchor" href="#blocks-procs-lambdas"></a><a class="link" href="#blocks-procs-lambdas">Blocks, Procs &amp; Lambdas</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="single-action-blocks"><a class="anchor" href="#single-action-blocks"></a><a class="link" href="#single-action-blocks">Proc Application Shorthand</a></h3>
<div class="paragraph">
<p>Use the Proc call shorthand when the called method is the only operation of a block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">names</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span> <span class="nb">name</span><span class="p">.</span><span class="nf">upcase</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">names</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:upcase</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="single-line-blocks"><a class="anchor" href="#single-line-blocks"></a><a class="link" href="#single-line-blocks">Single-line Blocks Delimiters</a></h3>
<div class="paragraph">
<p>Prefer <code>{&#8230;&#8203;}</code> over <code>do&#8230;&#8203;end</code> for single-line blocks.
Avoid using <code>{&#8230;&#8203;}</code> for multi-line blocks (multi-line chaining is always ugly).
Always use <code>do&#8230;&#8203;end</code> for "control flow" and "method definitions" (e.g. in Rakefiles and certain DSLs).
Avoid <code>do&#8230;&#8203;end</code> when chaining.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">names</span> <span class="o">=</span> <span class="sx">%w[Bozhidar Filipp Sarah]</span>

<span class="c1"># bad</span>
<span class="n">names</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="nb">name</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">names</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span> <span class="nb">puts</span> <span class="nb">name</span> <span class="p">}</span>

<span class="c1"># bad</span>
<span class="n">names</span><span class="p">.</span><span class="nf">select</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span>
  <span class="nb">name</span><span class="p">.</span><span class="nf">start_with?</span><span class="p">(</span><span class="s1">'S'</span><span class="p">)</span>
<span class="k">end</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span> <span class="nb">name</span><span class="p">.</span><span class="nf">upcase</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">names</span><span class="p">.</span><span class="nf">select</span> <span class="p">{</span> <span class="o">|</span><span class="nb">name</span><span class="o">|</span> <span class="nb">name</span><span class="p">.</span><span class="nf">start_with?</span><span class="p">(</span><span class="s1">'S'</span><span class="p">)</span> <span class="p">}.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:upcase</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Some will argue that multi-line chaining would look OK with the use of {&#8230;&#8203;}, but they should ask themselves - is this code really readable and can the blocks' contents be extracted into nifty methods?</p>
</div>
</div>
<div class="sect2">
<h3 id="single-line-do-end-block"><a class="anchor" href="#single-line-do-end-block"></a><a class="link" href="#single-line-do-end-block">Single-line <code>do</code>&#8230;&#8203;<code>end</code> block</a></h3>
<div class="paragraph">
<p>Use multi-line <code>do</code>&#8230;&#8203;<code>end</code> block instead of single-line <code>do</code>&#8230;&#8203;<code>end</code> block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">foo</span> <span class="k">do</span> <span class="o">|</span><span class="n">arg</span><span class="o">|</span> <span class="n">bar</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">end</span>

<span class="c1"># good</span>
<span class="n">foo</span> <span class="k">do</span> <span class="o">|</span><span class="n">arg</span><span class="o">|</span>
  <span class="n">bar</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="o">-&gt;</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">do</span> <span class="n">bar</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">end</span>

<span class="c1"># good</span>
<span class="o">-&gt;</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span> <span class="n">bar</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="block-argument"><a class="anchor" href="#block-argument"></a><a class="link" href="#block-argument">Explicit Block Argument</a></h3>
<div class="paragraph">
<p>Consider using explicit block argument to avoid writing block literal that just passes its arguments to another block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="nb">require</span> <span class="s1">'tempfile'</span>

<span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">with_tmp_dir</span>
  <span class="no">Dir</span><span class="p">.</span><span class="nf">mktmpdir</span> <span class="k">do</span> <span class="o">|</span><span class="n">tmp_dir</span><span class="o">|</span>
    <span class="no">Dir</span><span class="p">.</span><span class="nf">chdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">dir</span><span class="o">|</span> <span class="k">yield</span> <span class="n">dir</span> <span class="p">}</span>  <span class="c1"># block just passes arguments</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">with_tmp_dir</span><span class="p">(</span><span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="no">Dir</span><span class="p">.</span><span class="nf">mktmpdir</span> <span class="k">do</span> <span class="o">|</span><span class="n">tmp_dir</span><span class="o">|</span>
    <span class="no">Dir</span><span class="p">.</span><span class="nf">chdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">with_tmp_dir</span> <span class="k">do</span> <span class="o">|</span><span class="n">dir</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"dir is accessible as a parameter and pwd is set: </span><span class="si">#{</span><span class="n">dir</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-trailing-parameters-comma"><a class="anchor" href="#no-trailing-parameters-comma"></a><a class="link" href="#no-trailing-parameters-comma">Trailing Comma in Block Parameters</a></h3>
<div class="paragraph">
<p>Avoid comma after the last parameter in a block, except in cases where only a single argument is present and its removal would affect functionality (for instance, array destructuring).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - easier to move/add/remove parameters, but still not preferred</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span><span class="o">|</span>
  <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">|</span>
  <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span><span class="o">|</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">|</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="p">}</span>

<span class="c1"># good - this comma is meaningful for array destructuring</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]].</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span><span class="o">|</span> <span class="n">a</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-nested-methods"><a class="anchor" href="#no-nested-methods"></a><a class="link" href="#no-nested-methods">Nested Method Definitions</a></h3>
<div class="paragraph">
<p>Do not use nested method definitions, use lambda instead.
Nested method definitions actually produce methods in the same scope (e.g. class) as the outer method.
Furthermore, the "nested method" will be redefined every time the method containing its definition is called.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>

  <span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good - the same as the previous, but no bar redefinition on every foo call</span>
<span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># also good</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">bar</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
  <span class="n">bar</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lambda-multi-line"><a class="anchor" href="#lambda-multi-line"></a><a class="link" href="#lambda-multi-line">Multi-line Lambda Definition</a></h3>
<div class="paragraph">
<p>Use the new lambda literal syntax for single-line body blocks.
Use the <code>lambda</code> method for multi-line blocks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">l</span> <span class="o">=</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">|</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="p">}</span>
<span class="n">l</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># correct, but looks extremely awkward</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">tmp</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">7</span>
  <span class="n">tmp</span> <span class="o">*</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">50</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="p">}</span>
<span class="n">l</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">l</span> <span class="o">=</span> <span class="nb">lambda</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">|</span>
  <span class="n">tmp</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">7</span>
  <span class="n">tmp</span> <span class="o">*</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">50</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="stabby-lambda-with-args"><a class="anchor" href="#stabby-lambda-with-args"></a><a class="link" href="#stabby-lambda-with-args">Stabby Lambda Definition with Parameters</a></h3>
<div class="paragraph">
<p>Don&#8217;t omit the parameter parentheses when defining a stabby lambda with parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">{</span> <span class="n">something</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span> <span class="n">something</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="stabby-lambda-no-args"><a class="anchor" href="#stabby-lambda-no-args"></a><a class="link" href="#stabby-lambda-no-args">Stabby Lambda Definition without Parameters</a></h3>
<div class="paragraph">
<p>Omit the parameter parentheses when defining a stabby lambda with no parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">()</span> <span class="p">{</span> <span class="n">something</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">something</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc"><a class="anchor" href="#proc"></a><a class="link" href="#proc"><code>proc</code> vs <code>Proc.new</code></a></h3>
<div class="paragraph">
<p>Prefer <code>proc</code> over <code>Proc.new</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">p</span> <span class="o">=</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">n</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="nb">p</span> <span class="o">=</span> <span class="nb">proc</span> <span class="p">{</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">n</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-call"><a class="anchor" href="#proc-call"></a><a class="link" href="#proc-call">Proc Call</a></h3>
<div class="paragraph">
<p>Prefer <code>proc.call()</code> over <code>proc[]</code> or <code>proc.()</code> for both lambdas and procs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - looks similar to Enumeration access</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">puts</span> <span class="n">v</span> <span class="p">}</span>
<span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># bad - most compact form, but might be confusing for newcomers to Ruby</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">puts</span> <span class="n">v</span> <span class="p">}</span>
<span class="n">l</span><span class="o">.</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># good - a bit verbose, but crystal clear</span>
<span class="n">l</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">puts</span> <span class="n">v</span> <span class="p">}</span>
<span class="n">l</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="methods"><a class="anchor" href="#methods"></a><a class="link" href="#methods">Methods</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="short-methods"><a class="anchor" href="#short-methods"></a><a class="link" href="#short-methods">Short Methods</a></h3>
<div class="paragraph">
<p>Avoid methods longer than 10 LOC (lines of code).
Ideally, most methods will be shorter than 5 LOC.
Empty lines do not contribute to the relevant LOC.</p>
</div>
</div>
<div class="sect2">
<h3 id="top-level-methods"><a class="anchor" href="#top-level-methods"></a><a class="link" href="#top-level-methods">Top-Level Methods</a></h3>
<div class="paragraph">
<p>Avoid top-level method definitions. Organize them in modules, classes or structs instead.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is fine to use top-level method definitions in scripts.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">;</span> <span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">SomeClass</span>
  <span class="k">def</span> <span class="nf">some_method</span><span class="p">;</span> <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-single-line-methods"><a class="anchor" href="#no-single-line-methods"></a><a class="link" href="#no-single-line-methods">No Single-line Methods</a></h3>
<div class="paragraph">
<p>Avoid single-line methods.
Although they are somewhat popular in the wild, there are a few peculiarities about their definition syntax that make their use undesirable.
At any rate - there should be no more than one expression in a single-line method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ruby 3 introduced an alternative syntax for single-line method definitions, that&#8217;s discussed in the next section
of the guide.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">too_much</span><span class="p">;</span> <span class="n">something</span><span class="p">;</span> <span class="n">something_else</span><span class="p">;</span> <span class="k">end</span>

<span class="c1"># okish - notice that the first ; is required</span>
<span class="k">def</span> <span class="nf">no_braces_method</span><span class="p">;</span> <span class="n">body</span> <span class="k">end</span>

<span class="c1"># okish - notice that the second ; is optional</span>
<span class="k">def</span> <span class="nf">no_braces_method</span><span class="p">;</span> <span class="n">body</span><span class="p">;</span> <span class="k">end</span>

<span class="c1"># okish - valid syntax, but no ; makes it kind of hard to read</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">()</span> <span class="n">body</span> <span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span>
  <span class="n">body</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>One exception to the rule are empty-body methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good</span>
<span class="k">def</span> <span class="nf">no_op</span><span class="p">;</span> <span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="endless-methods"><a class="anchor" href="#endless-methods"></a><a class="link" href="#endless-methods">Endless Methods</a></h3>
<div class="paragraph">
<p>Only use Ruby 3.0&#8217;s endless method definitions with a single line
body.  Ideally, such method definitions should be both simple (a
single expression) and free of side effects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It&#8217;s important to understand that this guideline doesn&#8217;t
contradict the previous one. We still caution against the use of
single-line method definitions, but if such methods are to be used,
prefer endless methods.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span>
  <span class="n">x</span>
<span class="k">else</span>
  <span class="n">fib</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">the_answer</span> <span class="o">=</span> <span class="mi">42</span>
<span class="k">def</span> <span class="nf">get_x</span> <span class="o">=</span> <span class="vi">@x</span>
<span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>

<span class="c1"># Not (so) good: has side effect</span>
<span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="vi">@x</span> <span class="o">=</span> <span class="n">x</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">print_foo</span> <span class="o">=</span> <span class="nb">puts</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ambiguous-endless-method-defintions"><a class="anchor" href="#ambiguous-endless-method-defintions"></a><a class="link" href="#ambiguous-endless-method-defintions">Ambiguous Endless Method Definitions</a></h3>
<div class="paragraph">
<p>Keywords with lower precedence than <code>=</code> can appear ambiguous when used after an endless method definition. This includes <code>and</code>, <code>or</code>, and the modifier forms of <code>if</code>, <code>unless</code>, <code>while</code>, and <code>until</code>. In these cases, the code may appear to include these keywords as part of the method body, but instead they actually modify the method definition itself.</p>
</div>
<div class="paragraph">
<p>In this cases, prefer using a normal method over an endless method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">foo</span> <span class="o">=</span> <span class="kp">true</span> <span class="k">if</span> <span class="n">bar</span>

<span class="c1"># good - using a non-endless method is more explicit</span>
<span class="k">def</span> <span class="nf">foo</span>
  <span class="kp">true</span>
<span class="k">end</span> <span class="k">if</span> <span class="n">bar</span>

<span class="c1"># ok - method body is explicit</span>
<span class="k">def</span> <span class="nf">foo</span> <span class="o">=</span> <span class="p">(</span><span class="kp">true</span> <span class="k">if</span> <span class="n">bar</span><span class="p">)</span>

<span class="c1"># ok - method definition is explicit</span>
<span class="p">(</span><span class="k">def</span> <span class="nf">foo</span> <span class="o">=</span> <span class="kp">true</span><span class="p">)</span> <span class="k">if</span> <span class="n">bar</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="double-colons"><a class="anchor" href="#double-colons"></a><a class="link" href="#double-colons">Double Colons</a></h3>
<div class="paragraph">
<p>Use <code>::</code> only to reference constants (this includes classes and modules) and constructors (like <code>Array()</code> or <code>Nokogiri::HTML()</code>).
Do not use <code>::</code> for regular method calls.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">SomeClass</span><span class="o">::</span><span class="n">some_method</span>
<span class="n">some_object</span><span class="o">::</span><span class="n">some_method</span>

<span class="c1"># good</span>
<span class="no">SomeClass</span><span class="p">.</span><span class="nf">some_method</span>
<span class="n">some_object</span><span class="p">.</span><span class="nf">some_method</span>
<span class="no">SomeModule</span><span class="o">::</span><span class="no">SomeClass</span><span class="o">::</span><span class="no">SOME_CONST</span>
<span class="no">SomeModule</span><span class="o">::</span><span class="no">SomeClass</span><span class="p">()</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="colon-method-definition"><a class="anchor" href="#colon-method-definition"></a><a class="link" href="#colon-method-definition">Colon Method Definition</a></h3>
<div class="paragraph">
<p>Do not use <code>::</code> to define class methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">def</span> <span class="nf">self</span><span class="o">::</span><span class="n">some_method</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">some_method</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="method-parens"><a class="anchor" href="#method-parens"></a><a class="link" href="#method-parens">Method Definition Parentheses</a></h3>
<div class="paragraph">
<p>Use <code>def</code> with parentheses when there are parameters.
Omit the parentheses when the method doesn&#8217;t accept any parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">()</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method_with_parameters</span> <span class="n">param1</span><span class="p">,</span> <span class="n">param2</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method_with_parameters</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="method-call-parentheses"><a class="anchor" href="#method-call-parentheses"></a><a class="link" href="#method-call-parentheses">Method Call Parentheses <a id="method-invocation-parens"></a><a id="method-call-parens"></a></a></h3>
<div class="paragraph">
<p>Use parentheses around the arguments of method calls, especially if the first argument begins with an open parenthesis <code>(</code>, as in <code>f((3 + 2) + 1)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">x</span> <span class="o">=</span> <span class="no">Math</span><span class="p">.</span><span class="nf">sin</span> <span class="n">y</span>
<span class="c1"># good</span>
<span class="n">x</span> <span class="o">=</span> <span class="no">Math</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># bad</span>
<span class="n">array</span><span class="p">.</span><span class="nf">delete</span> <span class="n">e</span>
<span class="c1"># good</span>
<span class="n">array</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># bad</span>
<span class="n">temperance</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span> <span class="s1">'Temperance'</span><span class="p">,</span> <span class="mi">30</span>
<span class="c1"># good</span>
<span class="n">temperance</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'Temperance'</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="method-call-with-no-arguments"><a class="anchor" href="#method-call-with-no-arguments"></a><a class="link" href="#method-call-with-no-arguments">Method Call with No Arguments <a id="method-invocation-parens-no-args"></a><a id="method-call-parens-no-args"></a></a></h4>
<div class="paragraph">
<p>Always omit parentheses for method calls with no arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Kernel</span><span class="p">.</span><span class="nf">exit!</span><span class="p">()</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">even?</span><span class="p">()</span>
<span class="nb">fork</span><span class="p">()</span>
<span class="s1">'test'</span><span class="p">.</span><span class="nf">upcase</span><span class="p">()</span>

<span class="c1"># good</span>
<span class="no">Kernel</span><span class="p">.</span><span class="nf">exit!</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">even?</span>
<span class="nb">fork</span>
<span class="s1">'test'</span><span class="p">.</span><span class="nf">upcase</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="methods-that-have-keyword-status-in-ruby"><a class="anchor" href="#methods-that-have-keyword-status-in-ruby"></a><a class="link" href="#methods-that-have-keyword-status-in-ruby">Methods That Have "keyword" Status in Ruby <a id="method-invocation-parens-keyword"></a><a id="method-call-parens-keyword"></a></a></h4>
<div class="paragraph">
<p>Always omit parentheses for methods that have "keyword" status in Ruby.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Unfortunately, it&#8217;s not exactly clear <em>which</em> methods have "keyword" status.
There is agreement that declarative methods have "keyword" status.
However, there&#8217;s less agreement on which non-declarative methods, if any, have "keyword" status.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="non-declarative-methods-that-have-keyword-status-in-ruby"><a class="anchor" href="#non-declarative-methods-that-have-keyword-status-in-ruby"></a><a class="link" href="#non-declarative-methods-that-have-keyword-status-in-ruby">Non-Declarative Methods That Have "keyword" Status in Ruby <a id="method-invocation-parens-non-declarative-keyword"></a><a id="method-call-parens-non-declarative-keyword"></a></a></h5>
<div class="paragraph">
<p>For non-declarative methods with "keyword" status (e.g., various <code>Kernel</code> instance methods), two styles are considered acceptable.
By far the most popular style is to omit parentheses.
Rationale: The code reads better, and method calls look more like keywords.
A less-popular style, but still acceptable, is to include parentheses.
Rationale: The methods have ordinary semantics, so why treat them differently, and it&#8217;s easier to achieve a uniform style by not worrying about which methods have "keyword" status.
Whichever one you pick, apply it consistently.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good (most popular)</span>
<span class="nb">puts</span> <span class="n">temperance</span><span class="p">.</span><span class="nf">age</span>
<span class="nb">system</span> <span class="s1">'ls'</span>
<span class="nb">exit</span> <span class="mi">1</span>

<span class="c1"># also good (less popular)</span>
<span class="nb">puts</span><span class="p">(</span><span class="n">temperance</span><span class="p">.</span><span class="nf">age</span><span class="p">)</span>
<span class="nb">system</span><span class="p">(</span><span class="s1">'ls'</span><span class="p">)</span>
<span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="super-with-args"><a class="anchor" href="#super-with-args"></a><a class="link" href="#super-with-args">Using <code>super</code> with Arguments </a></h4>
<div class="paragraph">
<p>Always use parentheses when calling <code>super</code> with arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">super</span> <span class="nb">name</span><span class="p">,</span> <span class="n">age</span>

<span class="c1"># good</span>
<span class="k">super</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
When calling <code>super</code> without arguments, <code>super</code> and <code>super()</code> mean different things. Decide what is appropriate for your usage.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="too-many-params"><a class="anchor" href="#too-many-params"></a><a class="link" href="#too-many-params">Too Many Params</a></h3>
<div class="paragraph">
<p>Avoid parameter lists longer than three or four parameters.</p>
</div>
</div>
<div class="sect2">
<h3 id="optional-arguments"><a class="anchor" href="#optional-arguments"></a><a class="link" href="#optional-arguments">Optional Arguments</a></h3>
<div class="paragraph">
<p>Define optional arguments at the end of the list of arguments.
Ruby has some unexpected results when calling methods that have optional arguments at the front of the list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">b</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">c</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">d</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>

<span class="n">some_method</span><span class="p">(</span><span class="s1">'w'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">)</span> <span class="c1"># =&gt; '1, 2, w, x'</span>
<span class="n">some_method</span><span class="p">(</span><span class="s1">'w'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">)</span> <span class="c1"># =&gt; 'w, 2, x, y'</span>
<span class="n">some_method</span><span class="p">(</span><span class="s1">'w'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">)</span> <span class="c1"># =&gt; 'w, x, y, z'</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">b</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">c</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">d</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>

<span class="n">some_method</span><span class="p">(</span><span class="s1">'w'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">)</span> <span class="c1"># =&gt; '1, 2, w, x'</span>
<span class="n">some_method</span><span class="p">(</span><span class="s1">'w'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">)</span> <span class="c1"># =&gt; 'y, 2, w, x'</span>
<span class="n">some_method</span><span class="p">(</span><span class="s1">'w'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">)</span> <span class="c1"># =&gt; 'y, z, w, x'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="keyword-arguments-order"><a class="anchor" href="#keyword-arguments-order"></a><a class="link" href="#keyword-arguments-order">Keyword Arguments Order</a></h3>
<div class="paragraph">
<p>Put required keyword arguments before optional keyword arguments. Otherwise, it&#8217;s much harder to spot optional keyword arguments there, if they&#8217;re hidden somewhere in the middle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="ss">foo: </span><span class="kp">false</span><span class="p">,</span> <span class="n">bar</span><span class="p">:,</span> <span class="ss">baz: </span><span class="mi">10</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">bar</span><span class="p">:,</span> <span class="ss">foo: </span><span class="kp">false</span><span class="p">,</span> <span class="ss">baz: </span><span class="mi">10</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="boolean-keyword-arguments"><a class="anchor" href="#boolean-keyword-arguments"></a><a class="link" href="#boolean-keyword-arguments">Boolean Keyword Arguments</a></h3>
<div class="paragraph">
<p>Use keyword arguments when passing a boolean argument to a method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">bar</span> <span class="o">=</span> <span class="kp">false</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">bar</span>
<span class="k">end</span>

<span class="c1"># bad - common hack before keyword args were introduced</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="p">{})</span>
  <span class="n">bar</span> <span class="o">=</span> <span class="n">options</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="ss">:bar</span><span class="p">,</span> <span class="kp">false</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">bar</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="ss">bar: </span><span class="kp">false</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">bar</span>
<span class="k">end</span>

<span class="n">some_method</span>            <span class="c1"># =&gt; false</span>
<span class="n">some_method</span><span class="p">(</span><span class="ss">bar: </span><span class="kp">true</span><span class="p">)</span> <span class="c1"># =&gt; true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="keyword-arguments-vs-optional-arguments"><a class="anchor" href="#keyword-arguments-vs-optional-arguments"></a><a class="link" href="#keyword-arguments-vs-optional-arguments">Keyword Arguments vs Optional Arguments</a></h3>
<div class="paragraph">
<p>Prefer keyword arguments over optional arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="ss">b: </span><span class="mi">5</span><span class="p">,</span> <span class="ss">c: </span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># body omitted</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="keyword-arguments-vs-option-hashes"><a class="anchor" href="#keyword-arguments-vs-option-hashes"></a><a class="link" href="#keyword-arguments-vs-option-hashes">Keyword Arguments vs Option Hashes</a></h3>
<div class="paragraph">
<p>Use keyword arguments instead of option hashes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="p">{})</span>
  <span class="n">bar</span> <span class="o">=</span> <span class="n">options</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="ss">:bar</span><span class="p">,</span> <span class="kp">false</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">bar</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="ss">bar: </span><span class="kp">false</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="n">bar</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="merging-keyword-arguments"><a class="anchor" href="#merging-keyword-arguments"></a><a class="link" href="#merging-keyword-arguments">Merging Keyword Arguments</a></h3>
<div class="paragraph">
<p>When passing an existing hash as keyword arguments, add additional arguments directly rather than using <code>merge</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">some_method</span><span class="p">(</span><span class="o">**</span><span class="n">opts</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="ss">foo: </span><span class="kp">true</span><span class="p">))</span>

<span class="c1"># good</span>
<span class="n">some_method</span><span class="p">(</span><span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="ss">foo: </span><span class="kp">true</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="arguments-forwarding"><a class="anchor" href="#arguments-forwarding"></a><a class="link" href="#arguments-forwarding">Arguments Forwarding</a></h3>
<div class="paragraph">
<p>Use Ruby 2.7&#8217;s arguments forwarding.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="n">other_method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="n">other_method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="c1"># Please note that it can cause unexpected incompatible behavior</span>
<span class="c1"># because `...` forwards block also.</span>
<span class="c1"># https://github.com/rubocop/rubocop/issues/7549</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
  <span class="n">other_method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="n">other_method</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="block-forwarding"><a class="anchor" href="#block-forwarding"></a><a class="link" href="#block-forwarding">Block Forwarding</a></h3>
<div class="paragraph">
<p>Use Ruby 3.1&#8217;s anonymous block forwarding.</p>
</div>
<div class="paragraph">
<p>In most cases, block argument is given name similar to <code>&amp;block</code> or <code>&amp;proc</code>. Their names have no information and <code>&amp;</code> will be sufficient for syntactic meaning.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="n">other_method</span><span class="p">(</span><span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="o">&amp;</span><span class="p">)</span>
  <span class="n">other_method</span><span class="p">(</span><span class="o">&amp;</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="private-global-methods"><a class="anchor" href="#private-global-methods"></a><a class="link" href="#private-global-methods">Private Global Methods</a></h3>
<div class="paragraph">
<p>If you really need "global" methods, add them to Kernel and make them private.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="classes-modules"><a class="anchor" href="#classes-modules"></a><a class="link" href="#classes-modules">Classes &amp; Modules</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="consistent-classes"><a class="anchor" href="#consistent-classes"></a><a class="link" href="#consistent-classes">Consistent Classes</a></h3>
<div class="paragraph">
<p>Use a consistent structure in your class definitions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Person</span>
  <span class="c1"># extend/include/prepend go first</span>
  <span class="kp">extend</span> <span class="no">SomeModule</span>
  <span class="kp">include</span> <span class="no">AnotherModule</span>
  <span class="n">prepend</span> <span class="no">YetAnotherModule</span>

  <span class="c1"># inner classes</span>
  <span class="k">class</span> <span class="nc">CustomError</span> <span class="o">&lt;</span> <span class="no">StandardError</span>
  <span class="k">end</span>

  <span class="c1"># constants are next</span>
  <span class="no">SOME_CONSTANT</span> <span class="o">=</span> <span class="mi">20</span>

  <span class="c1"># afterwards we have attribute macros</span>
  <span class="nb">attr_reader</span> <span class="ss">:name</span>

  <span class="c1"># followed by other macros (if any)</span>
  <span class="n">validates</span> <span class="ss">:name</span>

  <span class="c1"># public class methods are next in line</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">some_method</span>
  <span class="k">end</span>

  <span class="c1"># initialization goes between class methods and other instance methods</span>
  <span class="k">def</span> <span class="nf">initialize</span>
  <span class="k">end</span>

  <span class="c1"># followed by other public instance methods</span>
  <span class="k">def</span> <span class="nf">some_method</span>
  <span class="k">end</span>

  <span class="c1"># protected and private methods are grouped near the end</span>
  <span class="kp">protected</span>

  <span class="k">def</span> <span class="nf">some_protected_method</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">some_private_method</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mixin-grouping"><a class="anchor" href="#mixin-grouping"></a><a class="link" href="#mixin-grouping">Mixin Grouping</a></h3>
<div class="paragraph">
<p>Split multiple mixins into separate statements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">include</span> <span class="no">Foo</span><span class="p">,</span> <span class="no">Bar</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="c1"># multiple mixins go in separate statements</span>
  <span class="kp">include</span> <span class="no">Foo</span>
  <span class="kp">include</span> <span class="no">Bar</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="single-line-classes"><a class="anchor" href="#single-line-classes"></a><a class="link" href="#single-line-classes">Single-line Classes</a></h3>
<div class="paragraph">
<p>Prefer a two-line format for class definitions with no body. It is easiest to read, understand, and modify.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">FooError</span> <span class="o">=</span> <span class="no">Class</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">StandardError</span><span class="p">)</span>

<span class="c1"># okish</span>
<span class="k">class</span> <span class="nc">FooError</span> <span class="o">&lt;</span> <span class="no">StandardError</span><span class="p">;</span> <span class="k">end</span>

<span class="c1"># ok</span>
<span class="k">class</span> <span class="nc">FooError</span> <span class="o">&lt;</span> <span class="no">StandardError</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Many editors/tools will fail to understand properly the usage of <code>Class.new</code>.
Someone trying to locate the class definition might try a grep "class FooError".
A final difference is that the name of your class is not available to the <code>inherited</code>
callback of the base class with the <code>Class.new</code> form.
In general it&#8217;s better to stick to the basic two-line style.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="file-classes"><a class="anchor" href="#file-classes"></a><a class="link" href="#file-classes">File Classes</a></h3>
<div class="paragraph">
<p>Don&#8217;t nest multi-line classes within classes.
Try to have such nested classes each in their own file in a folder named like the containing class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>

<span class="c1"># foo.rb</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">class</span> <span class="nc">Bar</span>
    <span class="c1"># 30 methods inside</span>
  <span class="k">end</span>

  <span class="k">class</span> <span class="nc">Car</span>
    <span class="c1"># 20 methods inside</span>
  <span class="k">end</span>

  <span class="c1"># 30 methods inside</span>
<span class="k">end</span>

<span class="c1"># good</span>

<span class="c1"># foo.rb</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="c1"># 30 methods inside</span>
<span class="k">end</span>

<span class="c1"># foo/bar.rb</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">class</span> <span class="nc">Bar</span>
    <span class="c1"># 30 methods inside</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># foo/car.rb</span>
<span class="k">class</span> <span class="nc">Foo</span>
  <span class="k">class</span> <span class="nc">Car</span>
    <span class="c1"># 20 methods inside</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="namespace-definition"><a class="anchor" href="#namespace-definition"></a><a class="link" href="#namespace-definition">Namespace Definition</a></h3>
<div class="paragraph">
<p>Define (and reopen) namespaced classes and modules using explicit nesting.
Using the scope resolution operator can lead to surprising constant lookups due to Ruby&#8217;s <a href="https://cirw.in/blog/constant-lookup.html">lexical scoping</a>, which depends on the module nesting at the point of definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">module</span> <span class="nn">Utilities</span>
  <span class="k">class</span> <span class="nc">Queue</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Utilities</span><span class="o">::</span><span class="no">Store</span>
  <span class="no">Module</span><span class="p">.</span><span class="nf">nesting</span> <span class="c1"># =&gt; [Utilities::Store]</span>

  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="c1"># Refers to the top level ::Queue class because Utilities isn't in the</span>
    <span class="c1"># current nesting chain.</span>
    <span class="vi">@queue</span> <span class="o">=</span> <span class="no">Queue</span><span class="p">.</span><span class="nf">new</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">module</span> <span class="nn">Utilities</span>
  <span class="k">class</span> <span class="nc">WaitingList</span>
    <span class="no">Module</span><span class="p">.</span><span class="nf">nesting</span> <span class="c1"># =&gt; [Utilities::WaitingList, Utilities]</span>

    <span class="k">def</span> <span class="nf">initialize</span>
      <span class="vi">@queue</span> <span class="o">=</span> <span class="no">Queue</span><span class="p">.</span><span class="nf">new</span> <span class="c1"># Refers to Utilities::Queue</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modules-vs-classes"><a class="anchor" href="#modules-vs-classes"></a><a class="link" href="#modules-vs-classes">Modules vs Classes</a></h3>
<div class="paragraph">
<p>Prefer modules to classes with only class methods.
Classes should be used only when it makes sense to create instances out of them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">SomeClass</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">some_method</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">some_other_method</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">module</span> <span class="nn">SomeModule</span>
  <span class="kp">module_function</span>

  <span class="k">def</span> <span class="nf">some_method</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">some_other_method</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="module-function"><a class="anchor" href="#module-function"></a><a class="link" href="#module-function"><code>module_function</code></a></h3>
<div class="paragraph">
<p>Prefer the use of <code>module_function</code> over <code>extend self</code> when you want to turn a module&#8217;s instance methods into class methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">module</span> <span class="nn">Utilities</span>
  <span class="kp">extend</span> <span class="nb">self</span>

  <span class="k">def</span> <span class="nf">parse_something</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="c1"># do stuff here</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">other_utility_method</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
    <span class="c1"># do some more stuff</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">module</span> <span class="nn">Utilities</span>
  <span class="kp">module_function</span>

  <span class="k">def</span> <span class="nf">parse_something</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="c1"># do stuff here</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">other_utility_method</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
    <span class="c1"># do some more stuff</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="liskov"><a class="anchor" href="#liskov"></a><a class="link" href="#liskov">Liskov</a></h3>
<div class="paragraph">
<p>When designing class hierarchies make sure that they conform to the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov Substitution Principle</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="solid-design"><a class="anchor" href="#solid-design"></a><a class="link" href="#solid-design">SOLID design</a></h3>
<div class="paragraph">
<p>Try to make your classes as <a href="https://en.wikipedia.org/wiki/SOLID">SOLID</a> as possible.</p>
</div>
</div>
<div class="sect2">
<h3 id="define-to-s"><a class="anchor" href="#define-to-s"></a><a class="link" href="#define-to-s">Define <code>to_s</code></a></h3>
<div class="paragraph">
<p>Always supply a proper <code>to_s</code> method for classes that represent domain objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Person</span>
  <span class="nb">attr_reader</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">)</span>
    <span class="vi">@first_name</span> <span class="o">=</span> <span class="n">first_name</span>
    <span class="vi">@last_name</span> <span class="o">=</span> <span class="n">last_name</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">to_s</span>
    <span class="s2">"</span><span class="si">#{</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">last_name</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="attr_family"><a class="anchor" href="#attr_family"></a><a class="link" href="#attr_family"><code>attr</code> Family</a></h3>
<div class="paragraph">
<p>Use the <code>attr</code> family of functions to define trivial accessors or mutators.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">)</span>
    <span class="vi">@first_name</span> <span class="o">=</span> <span class="n">first_name</span>
    <span class="vi">@last_name</span> <span class="o">=</span> <span class="n">last_name</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">first_name</span>
    <span class="vi">@first_name</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">last_name</span>
    <span class="vi">@last_name</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="nb">attr_reader</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">)</span>
    <span class="vi">@first_name</span> <span class="o">=</span> <span class="n">first_name</span>
    <span class="vi">@last_name</span> <span class="o">=</span> <span class="n">last_name</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="accessor_mutator_method_names"><a class="anchor" href="#accessor_mutator_method_names"></a><a class="link" href="#accessor_mutator_method_names">Accessor/Mutator Method Names</a></h3>
<div class="paragraph">
<p>For accessors and mutators, avoid prefixing method names with <code>get_</code> and <code>set_</code>.
It is a Ruby convention to use attribute names for accessors (readers) and <code>attr_name=</code> for mutators (writers).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">get_name</span>
    <span class="s2">"</span><span class="si">#{</span><span class="vi">@first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@last_name</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
    <span class="vi">@first_name</span><span class="p">,</span> <span class="vi">@last_name</span> <span class="o">=</span> <span class="nb">name</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">name</span>
    <span class="s2">"</span><span class="si">#{</span><span class="vi">@first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@last_name</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">name</span><span class="o">=</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
    <span class="vi">@first_name</span><span class="p">,</span> <span class="vi">@last_name</span> <span class="o">=</span> <span class="nb">name</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="attr"><a class="anchor" href="#attr"></a><a class="link" href="#attr"><code>attr</code></a></h3>
<div class="paragraph">
<p>Avoid the use of <code>attr</code>.
Use <code>attr_reader</code> and <code>attr_accessor</code> instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - creates a single attribute accessor (deprecated in Ruby 1.9)</span>
<span class="kp">attr</span> <span class="ss">:something</span><span class="p">,</span> <span class="kp">true</span>
<span class="kp">attr</span> <span class="ss">:one</span><span class="p">,</span> <span class="ss">:two</span><span class="p">,</span> <span class="ss">:three</span> <span class="c1"># behaves as attr_reader</span>

<span class="c1"># good</span>
<span class="nb">attr_accessor</span> <span class="ss">:something</span>
<span class="nb">attr_reader</span> <span class="ss">:one</span><span class="p">,</span> <span class="ss">:two</span><span class="p">,</span> <span class="ss">:three</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="struct-new"><a class="anchor" href="#struct-new"></a><a class="link" href="#struct-new"><code>Struct.new</code></a></h3>
<div class="paragraph">
<p>Consider using <code>Struct.new</code>, which defines the trivial accessors, constructor and comparison operators for you.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="nb">attr_accessor</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">)</span>
    <span class="vi">@first_name</span> <span class="o">=</span> <span class="n">first_name</span>
    <span class="vi">@last_name</span> <span class="o">=</span> <span class="n">last_name</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># better</span>
<span class="no">Person</span> <span class="o">=</span> <span class="no">Struct</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">)</span> <span class="k">do</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-extend-struct-new"><a class="anchor" href="#no-extend-struct-new"></a><a class="link" href="#no-extend-struct-new">Don&#8217;t Extend <code>Struct.new</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t extend an instance initialized by <code>Struct.new</code>.
Extending it introduces a superfluous class level and may also introduce weird errors if the file is required multiple times.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">Struct</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="no">Person</span> <span class="o">=</span> <span class="no">Struct</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-extend-data-define"><a class="anchor" href="#no-extend-data-define"></a><a class="link" href="#no-extend-data-define">Don&#8217;t Extend <code>Data.define</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t extend an instance initialized by <code>Data.define</code>.
Extending it introduces a superfluous class level.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">Data</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">)</span>
<span class="k">end</span>

<span class="no">Person</span><span class="p">.</span><span class="nf">ancestors</span>
<span class="c1"># =&gt; [Person, #&lt;Class:0x0000000105abed88&gt;, Data, Object, (...)]</span>

<span class="c1"># good</span>
<span class="no">Person</span> <span class="o">=</span> <span class="no">Data</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">)</span>

<span class="no">Person</span><span class="p">.</span><span class="nf">ancestors</span>
<span class="c1"># =&gt; [Person, Data, Object, (...)]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="duck-typing"><a class="anchor" href="#duck-typing"></a><a class="link" href="#duck-typing">Duck Typing</a></h3>
<div class="paragraph">
<p>Prefer <a href="https://en.wikipedia.org/wiki/Duck_typing">duck-typing</a> over inheritance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Animal</span>
  <span class="c1"># abstract method</span>
  <span class="k">def</span> <span class="nf">speak</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># extend superclass</span>
<span class="k">class</span> <span class="nc">Duck</span> <span class="o">&lt;</span> <span class="no">Animal</span>
  <span class="k">def</span> <span class="nf">speak</span>
    <span class="nb">puts</span> <span class="s1">'Quack! Quack'</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># extend superclass</span>
<span class="k">class</span> <span class="nc">Dog</span> <span class="o">&lt;</span> <span class="no">Animal</span>
  <span class="k">def</span> <span class="nf">speak</span>
    <span class="nb">puts</span> <span class="s1">'Bau! Bau!'</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Duck</span>
  <span class="k">def</span> <span class="nf">speak</span>
    <span class="nb">puts</span> <span class="s1">'Quack! Quack'</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Dog</span>
  <span class="k">def</span> <span class="nf">speak</span>
    <span class="nb">puts</span> <span class="s1">'Bau! Bau!'</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-class-vars"><a class="anchor" href="#no-class-vars"></a><a class="link" href="#no-class-vars">No Class Vars</a></h3>
<div class="paragraph">
<p>Avoid the usage of class (<code>@@</code>) variables due to their "nasty" behavior in inheritance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Parent</span>
  <span class="vc">@@class_var</span> <span class="o">=</span> <span class="s1">'parent'</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">print_class_var</span>
    <span class="nb">puts</span> <span class="vc">@@class_var</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Child</span> <span class="o">&lt;</span> <span class="no">Parent</span>
  <span class="vc">@@class_var</span> <span class="o">=</span> <span class="s1">'child'</span>
<span class="k">end</span>

<span class="no">Parent</span><span class="p">.</span><span class="nf">print_class_var</span> <span class="c1"># =&gt; will print 'child'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see all the classes in a class hierarchy actually share one class variable.
Class instance variables should usually be preferred over class variables.</p>
</div>
</div>
<div class="sect2">
<h3 id="visibility"><a class="anchor" href="#visibility"></a><a class="link" href="#visibility">Leverage Access Modifiers (e.g. <code>private</code> and <code>protected</code>)</a></h3>
<div class="paragraph">
<p>Assign proper visibility levels to methods (<code>private</code>, <code>protected</code>) in accordance with their intended usage.
Don&#8217;t go off leaving everything <code>public</code> (which is the default).</p>
</div>
</div>
<div class="sect2">
<h3 id="indent-public-private-protected"><a class="anchor" href="#indent-public-private-protected"></a><a class="link" href="#indent-public-private-protected">Access Modifiers Indentation</a></h3>
<div class="paragraph">
<p>Indent the <code>public</code>, <code>protected</code>, and <code>private</code> methods as much as the method definitions they apply to.
Leave one blank line above the visibility modifier and one blank line below in order to emphasize that it applies to all methods below it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good</span>
<span class="k">class</span> <span class="nc">SomeClass</span>
  <span class="k">def</span> <span class="nf">public_method</span>
    <span class="c1"># some code</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">private_method</span>
    <span class="c1"># some code</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">another_private_method</span>
    <span class="c1"># some code</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="def-self-class-methods"><a class="anchor" href="#def-self-class-methods"></a><a class="link" href="#def-self-class-methods">Defining Class Methods</a></h3>
<div class="paragraph">
<p>Use <code>def self.method</code> to define class methods.
This makes the code easier to refactor since the class name is not repeated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">TestClass</span>
  <span class="c1"># bad</span>
  <span class="k">def</span> <span class="nc">TestClass</span><span class="o">.</span><span class="nf">some_method</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>

  <span class="c1"># good</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">some_other_method</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>

  <span class="c1"># Also possible and convenient when you</span>
  <span class="c1"># have to define many class methods.</span>
  <span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span>
    <span class="k">def</span> <span class="nf">first_method</span>
      <span class="c1"># body omitted</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">second_method_etc</span>
      <span class="c1"># body omitted</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="alias-method-lexically"><a class="anchor" href="#alias-method-lexically"></a><a class="link" href="#alias-method-lexically">Alias Method Lexically</a></h3>
<div class="paragraph">
<p>Prefer <code>alias</code> when aliasing methods in lexical class scope as the resolution of <code>self</code> in this context is also lexical, and it communicates clearly to the user that the indirection of your alias will not be altered at runtime or by any subclass unless made explicit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Westerner</span>
  <span class="k">def</span> <span class="nf">first_name</span>
    <span class="vi">@names</span><span class="p">.</span><span class="nf">first</span>
  <span class="k">end</span>

  <span class="k">alias</span> <span class="n">given_name</span> <span class="n">first_name</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since <code>alias</code>, like <code>def</code>, is a keyword, prefer bareword arguments over symbols or strings.
In other words, do <code>alias foo bar</code>, not <code>alias :foo :bar</code>.</p>
</div>
<div class="paragraph">
<p>Also be aware of how Ruby handles aliases and inheritance: an alias references the method that was resolved at the time the alias was defined; it is not dispatched dynamically.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Fugitive</span> <span class="o">&lt;</span> <span class="no">Westerner</span>
  <span class="k">def</span> <span class="nf">first_name</span>
    <span class="s1">'Nobody'</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>Fugitive#given_name</code> would still call the original <code>Westerner#first_name</code> method, not <code>Fugitive#first_name</code>.
To override the behavior of <code>Fugitive#given_name</code> as well, you&#8217;d have to redefine it in the derived class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Fugitive</span> <span class="o">&lt;</span> <span class="no">Westerner</span>
  <span class="k">def</span> <span class="nf">first_name</span>
    <span class="s1">'Nobody'</span>
  <span class="k">end</span>

  <span class="k">alias</span> <span class="n">given_name</span> <span class="n">first_name</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="alias-method"><a class="anchor" href="#alias-method"></a><a class="link" href="#alias-method"><code>alias_method</code></a></h3>
<div class="paragraph">
<p>Always use <code>alias_method</code> when aliasing methods of modules, classes, or singleton classes at runtime, as the lexical scope of <code>alias</code> leads to unpredictability in these cases.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">module</span> <span class="nn">Mononymous</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">included</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="n">other</span><span class="p">.</span><span class="nf">class_eval</span> <span class="p">{</span> <span class="kp">alias_method</span> <span class="ss">:full_name</span><span class="p">,</span> <span class="ss">:given_name</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Sting</span> <span class="o">&lt;</span> <span class="no">Westerner</span>
  <span class="kp">include</span> <span class="no">Mononymous</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="class-and-self"><a class="anchor" href="#class-and-self"></a><a class="link" href="#class-and-self">Class and <code>self</code></a></h3>
<div class="paragraph">
<p>When class (or module) methods call other such methods, omit the use of a leading <code>self</code> or own name followed by a <code>.</code> when calling other such methods.
This is often seen in "service classes" or other similar concepts where a class is treated as though it were a function.
This convention tends to reduce repetitive boilerplate in such classes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">TestClass</span>
  <span class="c1"># bad - more work when class renamed/method moved</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">)</span>
    <span class="no">TestClass</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">param1</span><span class="p">).</span><span class="nf">call</span><span class="p">(</span><span class="n">param2</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="c1"># bad - more verbose than necessary</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">)</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">param1</span><span class="p">).</span><span class="nf">call</span><span class="p">(</span><span class="n">param2</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="c1"># good</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">)</span>
    <span class="n">new</span><span class="p">(</span><span class="n">param1</span><span class="p">).</span><span class="nf">call</span><span class="p">(</span><span class="n">param2</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="c1"># ...other methods...</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-constant-definition-in-block"><a class="anchor" href="#no-constant-definition-in-block"></a><a class="link" href="#no-constant-definition-in-block">Defining Constants within a Block</a></h3>
<div class="paragraph">
<p>Do not define constants within a block, since the block&#8217;s scope does not isolate or namespace the constant in any way.</p>
</div>
<div class="paragraph">
<p>Define the constant outside of the block instead, or use a variable or method if defining the constant in the outer scope would be problematic.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - FILES_TO_LINT is now defined globally</span>
<span class="n">task</span> <span class="ss">:lint</span> <span class="k">do</span>
  <span class="no">FILES_TO_LINT</span> <span class="o">=</span> <span class="no">Dir</span><span class="p">[</span><span class="s1">'lib/*.rb'</span><span class="p">]</span>
  <span class="c1"># ...</span>
<span class="k">end</span>

<span class="c1"># good - files_to_lint is only defined inside the block</span>
<span class="n">task</span> <span class="ss">:lint</span> <span class="k">do</span>
  <span class="n">files_to_lint</span> <span class="o">=</span> <span class="no">Dir</span><span class="p">[</span><span class="s1">'lib/*.rb'</span><span class="p">]</span>
  <span class="c1"># ...</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="classes-constructors"><a class="anchor" href="#classes-constructors"></a><a class="link" href="#classes-constructors">Classes: Constructors</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="factory-methods"><a class="anchor" href="#factory-methods"></a><a class="link" href="#factory-methods">Factory Methods</a></h3>
<div class="paragraph">
<p>Consider adding factory methods to provide additional sensible ways to create instances of a particular class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">create</span><span class="p">(</span><span class="n">options_hash</span><span class="p">)</span>
    <span class="c1"># body omitted</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disjunctive-assignment-in-constructor"><a class="anchor" href="#disjunctive-assignment-in-constructor"></a><a class="link" href="#disjunctive-assignment-in-constructor">Disjunctive Assignment in Constructor</a></h3>
<div class="paragraph">
<p>In constructors, avoid unnecessary disjunctive assignment (<code>||=</code>) of instance variables.
Prefer plain assignment.
In ruby, instance variables (beginning with an <code>@</code>) are nil until assigned a value, so in most cases the disjunction is unnecessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">initialize</span>
  <span class="vi">@x</span> <span class="o">||=</span> <span class="mi">1</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">initialize</span>
  <span class="vi">@x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="comments"><a class="anchor" href="#comments"></a><a class="link" href="#comments">Comments</a></h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Good code is its own best documentation.
As you&#8217;re about to add a comment, ask yourself, "How can I improve the code so that this comment isn&#8217;t needed?".
Improve the code and then document it to make it even clearer.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Steve McConnell
</div>
</div>
<div class="sect2">
<h3 id="no-comments"><a class="anchor" href="#no-comments"></a><a class="link" href="#no-comments">No Comments</a></h3>
<div class="paragraph">
<p>Write self-documenting code and ignore the rest of this section. Seriously!</p>
</div>
</div>
<div class="sect2">
<h3 id="rationale-comments"><a class="anchor" href="#rationale-comments"></a><a class="link" href="#rationale-comments">Rationale Comments</a></h3>
<div class="paragraph">
<p>If the <em>how</em> can be made self-documenting, but not the <em>why</em> (e.g. the code works around non-obvious library behavior, or implements an algorithm from an academic paper), add a comment explaining the rationale behind the code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>

<span class="n">x</span> <span class="o">=</span> <span class="no">BuggyClass</span><span class="p">.</span><span class="nf">something</span><span class="p">.</span><span class="nf">dup</span>

<span class="k">def</span> <span class="nf">compute_dependency_graph</span>
  <span class="o">...</span><span class="mi">30</span> <span class="n">lines</span> <span class="n">of</span> <span class="n">recursive</span> <span class="n">graph</span> <span class="n">merging</span><span class="o">...</span>
<span class="k">end</span>

<span class="c1"># good</span>

<span class="c1"># BuggyClass returns an internal object, so we have to dup it to modify it.</span>
<span class="n">x</span> <span class="o">=</span> <span class="no">BuggyClass</span><span class="p">.</span><span class="nf">something</span><span class="p">.</span><span class="nf">dup</span>

<span class="c1"># This is algorithm 6.4(a) from Worf &amp; Yar's _Amazing Graph Algorithms_ (2243).</span>
<span class="k">def</span> <span class="nf">compute_dependency_graph</span>
  <span class="o">...</span><span class="mi">30</span> <span class="n">lines</span> <span class="n">of</span> <span class="n">recursive</span> <span class="n">graph</span> <span class="n">merging</span><span class="o">...</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="english-comments"><a class="anchor" href="#english-comments"></a><a class="link" href="#english-comments">English Comments</a></h3>
<div class="paragraph">
<p>Write comments in English.</p>
</div>
</div>
<div class="sect2">
<h3 id="hash-space"><a class="anchor" href="#hash-space"></a><a class="link" href="#hash-space">Hash Space</a></h3>
<div class="paragraph">
<p>Use one space between the leading <code>#</code> character of the comment and the text of the comment.</p>
</div>
</div>
<div class="sect2">
<h3 id="english-syntax"><a class="anchor" href="#english-syntax"></a><a class="link" href="#english-syntax">English Syntax</a></h3>
<div class="paragraph">
<p>Comments longer than a word are capitalized and use punctuation.
Use <a href="https://en.wikipedia.org/wiki/Sentence_spacing">one space</a> after periods.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-superfluous-comments"><a class="anchor" href="#no-superfluous-comments"></a><a class="link" href="#no-superfluous-comments">No Superfluous Comments</a></h3>
<div class="paragraph">
<p>Avoid superfluous comments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># Increments counter by one.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="comment-upkeep"><a class="anchor" href="#comment-upkeep"></a><a class="link" href="#comment-upkeep">Comment Upkeep</a></h3>
<div class="paragraph">
<p>Keep existing comments up-to-date.
An outdated comment is worse than no comment at all.</p>
</div>
</div>
<div class="sect2">
<h3 id="refactor-dont-comment"><a class="anchor" href="#refactor-dont-comment"></a><a class="link" href="#refactor-dont-comment">Refactor, Don&#8217;t Comment</a></h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Good code is like a good joke: it needs no explanation.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; old programmers maxim<br>
<cite><a href="https://eloquentruby.com/blog/2011/03/07/good-code-and-good-jokes/">through Russ Olsen</a></cite>
</div>
</div>
<div class="paragraph">
<p>Avoid writing comments to explain bad code.
Refactor the code to make it self-explanatory.
("Do or do not - there is no try." Yoda)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="comment-annotations"><a class="anchor" href="#comment-annotations"></a><a class="link" href="#comment-annotations">Comment Annotations</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="annotate-above"><a class="anchor" href="#annotate-above"></a><a class="link" href="#annotate-above">Annotations Placement</a></h3>
<div class="paragraph">
<p>Annotations should usually be written on the line immediately above the relevant code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">bar</span>
  <span class="n">baz</span><span class="p">(</span><span class="ss">:quux</span><span class="p">)</span> <span class="c1"># FIXME: This has crashed occasionally since v3.2.1.</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">bar</span>
  <span class="c1"># FIXME: This has crashed occasionally since v3.2.1.</span>
  <span class="n">baz</span><span class="p">(</span><span class="ss">:quux</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="annotate-keywords"><a class="anchor" href="#annotate-keywords"></a><a class="link" href="#annotate-keywords">Annotations Keyword Format</a></h3>
<div class="paragraph">
<p>The annotation keyword is followed by a colon and a space, then a note describing the problem.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">bar</span>
  <span class="c1"># FIXME This has crashed occasionally since v3.2.1.</span>
  <span class="n">baz</span><span class="p">(</span><span class="ss">:quux</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">bar</span>
  <span class="c1"># FIXME: This has crashed occasionally since v3.2.1.</span>
  <span class="n">baz</span><span class="p">(</span><span class="ss">:quux</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="indent-annotations"><a class="anchor" href="#indent-annotations"></a><a class="link" href="#indent-annotations">Multi-line Annotations Indentation</a></h3>
<div class="paragraph">
<p>If multiple lines are required to describe the problem, subsequent lines should be indented three spaces after the <code>#</code> (one general plus two for indentation purposes).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">def</span> <span class="nf">bar</span>
  <span class="c1"># FIXME: This has crashed occasionally since v3.2.1. It may</span>
  <span class="c1">#   be related to the BarBazUtil upgrade.</span>
  <span class="n">baz</span><span class="p">(</span><span class="ss">:quux</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rare-eol-annotations"><a class="anchor" href="#rare-eol-annotations"></a><a class="link" href="#rare-eol-annotations">Inline Annotations</a></h3>
<div class="paragraph">
<p>In cases where the problem is so obvious that any documentation would be redundant, annotations may be left at the end of the offending line with no note.
This usage should be the exception and not the rule.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">def</span> <span class="nf">bar</span>
  <span class="nb">sleep</span> <span class="mi">100</span> <span class="c1"># OPTIMIZE</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="todo"><a class="anchor" href="#todo"></a><a class="link" href="#todo"><code>TODO</code></a></h3>
<div class="paragraph">
<p>Use <code>TODO</code> to note missing features or functionality that should be added at a later date.</p>
</div>
</div>
<div class="sect2">
<h3 id="fixme"><a class="anchor" href="#fixme"></a><a class="link" href="#fixme"><code>FIXME</code></a></h3>
<div class="paragraph">
<p>Use <code>FIXME</code> to note broken code that needs to be fixed.</p>
</div>
</div>
<div class="sect2">
<h3 id="optimize"><a class="anchor" href="#optimize"></a><a class="link" href="#optimize"><code>OPTIMIZE</code></a></h3>
<div class="paragraph">
<p>Use <code>OPTIMIZE</code> to note slow or inefficient code that may cause performance problems.</p>
</div>
</div>
<div class="sect2">
<h3 id="hack"><a class="anchor" href="#hack"></a><a class="link" href="#hack"><code>HACK</code></a></h3>
<div class="paragraph">
<p>Use <code>HACK</code> to note code smells where questionable coding practices were used and should be refactored away.</p>
</div>
</div>
<div class="sect2">
<h3 id="review"><a class="anchor" href="#review"></a><a class="link" href="#review"><code>REVIEW</code></a></h3>
<div class="paragraph">
<p>Use <code>REVIEW</code> to note anything that should be looked at to confirm it is working as intended.
For example: <code>REVIEW: Are we sure this is how the client does X currently?</code></p>
</div>
</div>
<div class="sect2">
<h3 id="document-annotations"><a class="anchor" href="#document-annotations"></a><a class="link" href="#document-annotations">Document Annotations</a></h3>
<div class="paragraph">
<p>Use other custom annotation keywords if it feels appropriate, but be sure to document them in your project&#8217;s <code>README</code> or similar.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="magic-comments"><a class="anchor" href="#magic-comments"></a><a class="link" href="#magic-comments">Magic Comments</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="magic-comments-first"><a class="anchor" href="#magic-comments-first"></a><a class="link" href="#magic-comments-first">Magic Comments First</a></h3>
<div class="paragraph">
<p>Place magic comments above all code and documentation in a file (except shebangs, which are discussed next).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="c1"># Some documentation about Person</span>

<span class="c1"># frozen_string_literal: true</span>
<span class="k">class</span> <span class="nc">Person</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="c1"># frozen_string_literal: true</span>

<span class="c1"># Some documentation about Person</span>
<span class="k">class</span> <span class="nc">Person</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="below-shebang"><a class="anchor" href="#below-shebang"></a><a class="link" href="#below-shebang">Below Shebang</a></h3>
<div class="paragraph">
<p>Place magic comments below shebangs when they are present in a file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="c1"># frozen_string_literal: true</span>
<span class="c1">#!/usr/bin/env ruby</span>

<span class="no">App</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="no">ARGV</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="c1">#!/usr/bin/env ruby</span>
<span class="c1"># frozen_string_literal: true</span>

<span class="no">App</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="no">ARGV</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="one-magic-comment-per-line"><a class="anchor" href="#one-magic-comment-per-line"></a><a class="link" href="#one-magic-comment-per-line">One Magic Comment per Line</a></h3>
<div class="paragraph">
<p>Use one magic comment per line if you need multiple.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="c1"># -*- frozen_string_literal: true; encoding: ascii-8bit -*-</span>

<span class="c1"># good</span>
<span class="c1"># frozen_string_literal: true</span>
<span class="c1"># encoding: ascii-8bit</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="separate-magic-comments-from-code"><a class="anchor" href="#separate-magic-comments-from-code"></a><a class="link" href="#separate-magic-comments-from-code">Separate Magic Comments from Code</a></h3>
<div class="paragraph">
<p>Separate magic comments from code and documentation with a blank line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="c1"># frozen_string_literal: true</span>
<span class="c1"># Some documentation for Person</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="c1"># Some code</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="c1"># frozen_string_literal: true</span>

<span class="c1"># Some documentation for Person</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="c1"># Some code</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="collections"><a class="anchor" href="#collections"></a><a class="link" href="#collections">Collections</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="literal-array-hash"><a class="anchor" href="#literal-array-hash"></a><a class="link" href="#literal-array-hash">Literal Array and Hash</a></h3>
<div class="paragraph">
<p>Prefer literal array and hash creation notation (unless you need to pass parameters to their constructors, that is).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">arr</span> <span class="o">=</span> <span class="no">Array</span><span class="p">.</span><span class="nf">new</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span>

<span class="c1"># good</span>
<span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">arr</span> <span class="o">=</span> <span class="no">Array</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{}</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="percent-w"><a class="anchor" href="#percent-w"></a><a class="link" href="#percent-w"><code>%w</code></a></h3>
<div class="paragraph">
<p>Prefer <code>%w</code> to the literal array syntax when you need an array of words (non-empty strings without spaces and special characters in them).
Apply this rule only to arrays with two or more elements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">STATES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'draft'</span><span class="p">,</span> <span class="s1">'open'</span><span class="p">,</span> <span class="s1">'closed'</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="no">STATES</span> <span class="o">=</span> <span class="sx">%w[draft open closed]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="percent-i"><a class="anchor" href="#percent-i"></a><a class="link" href="#percent-i"><code>%i</code></a></h3>
<div class="paragraph">
<p>Prefer <code>%i</code> to the literal array syntax when you need an array of symbols (and you don&#8217;t need to maintain Ruby 1.9 compatibility).
Apply this rule only to arrays with two or more elements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">STATES</span> <span class="o">=</span> <span class="p">[</span><span class="ss">:draft</span><span class="p">,</span> <span class="ss">:open</span><span class="p">,</span> <span class="ss">:closed</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="no">STATES</span> <span class="o">=</span> <span class="sx">%i[draft open closed]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-trailing-array-commas"><a class="anchor" href="#no-trailing-array-commas"></a><a class="link" href="#no-trailing-array-commas">No Trailing Array Commas</a></h3>
<div class="paragraph">
<p>Avoid comma after the last item of an <code>Array</code> or <code>Hash</code> literal, especially when the items are not on separate lines.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - easier to move/add/remove items, but still not preferred</span>
<span class="no">VALUES</span> <span class="o">=</span> <span class="p">[</span>
           <span class="mi">1001</span><span class="p">,</span>
           <span class="mi">2020</span><span class="p">,</span>
           <span class="mi">3333</span><span class="p">,</span>
         <span class="p">]</span>

<span class="c1"># bad</span>
<span class="no">VALUES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1001</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">3333</span><span class="p">,</span> <span class="p">]</span>

<span class="c1"># good</span>
<span class="no">VALUES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1001</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">3333</span><span class="p">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-gappy-arrays"><a class="anchor" href="#no-gappy-arrays"></a><a class="link" href="#no-gappy-arrays">No Gappy Arrays</a></h3>
<div class="paragraph">
<p>Avoid the creation of huge gaps in arrays.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">arr</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># now you have an array with lots of nils</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="first-and-last"><a class="anchor" href="#first-and-last"></a><a class="link" href="#first-and-last"><code>first</code> and <code>last</code></a></h3>
<div class="paragraph">
<p>When accessing the first or last element from an array, prefer <code>first</code> or <code>last</code> over <code>[0]</code> or <code>[-1]</code>.
<code>first</code> and <code>last</code> take less effort to understand, especially for a less experienced Ruby programmer or someone from a language with different indexing semantics.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># ok</span>
<span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># =&gt; 1</span>
<span class="n">arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># =&gt; 3</span>

<span class="c1"># (arguably) better</span>
<span class="n">arr</span><span class="p">.</span><span class="nf">first</span> <span class="c1"># =&gt; 1</span>
<span class="n">arr</span><span class="p">.</span><span class="nf">last</span>  <span class="c1"># =&gt; 3</span>

<span class="c1"># good - assignments can only be done via []=</span>
<span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="set-vs-array"><a class="anchor" href="#set-vs-array"></a><a class="link" href="#set-vs-array">Set vs Array</a></h3>
<div class="paragraph">
<p>Use <code>Set</code> instead of <code>Array</code> when dealing with unique elements.
<code>Set</code> implements a collection of unordered values with no duplicates.
This is a hybrid of <code>Array</code>'s intuitive inter-operation facilities and <code>Hash</code>'s fast lookup.</p>
</div>
</div>
<div class="sect2">
<h3 id="symbols-as-keys"><a class="anchor" href="#symbols-as-keys"></a><a class="link" href="#symbols-as-keys">Symbols as Keys</a></h3>
<div class="paragraph">
<p>Prefer symbols instead of strings as hash keys.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'one'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'two'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'three'</span> <span class="o">=&gt;</span> <span class="mi">3</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">one: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">two: </span><span class="mi">2</span><span class="p">,</span> <span class="ss">three: </span><span class="mi">3</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-mutable-keys"><a class="anchor" href="#no-mutable-keys"></a><a class="link" href="#no-mutable-keys">No Mutable Keys</a></h3>
<div class="paragraph">
<p>Avoid the use of mutable objects as hash keys.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-mutable-defaults"><a class="anchor" href="#no-mutable-defaults"></a><a class="link" href="#no-mutable-defaults">No Mutable Defaults</a></h3>
<div class="paragraph">
<p>Avoid the use of shared mutable objects as hash default values.</p>
</div>
<div class="paragraph">
<p>Creating a Hash in such a way will share the default value
across all keys, causing unexpected behavior when modifying it.</p>
</div>
<div class="paragraph">
<p>For example, when the Hash was created with an Array as the argument,
calling <code>hash[:foo] &lt;&lt; 'bar'</code> will also change the value of all
other keys that have not been explicitly assigned to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">([])</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">({})</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">Array</span><span class="p">.</span><span class="nf">new</span><span class="p">)</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">)</span>

<span class="c1"># okay -- beware this will silently discard mutations and only remember assignments</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="no">Array</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="p">{}</span> <span class="p">}</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="p">[]</span> <span class="p">}</span>

<span class="c1"># good - frozen solution will raise an error when mutation is attempted</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">([].</span><span class="nf">freeze</span><span class="p">)</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span><span class="p">({}.</span><span class="nf">freeze</span><span class="p">)</span>

<span class="c1"># good - using a proc will create a new object for each key</span>
<span class="n">h</span> <span class="o">=</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span>
<span class="n">h</span><span class="p">.</span><span class="nf">default_proc</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span> <span class="p">[]</span> <span class="p">}</span>
<span class="n">h</span><span class="p">.</span><span class="nf">default_proc</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span> <span class="p">{}</span> <span class="p">}</span>

<span class="c1"># good - using a block will create a new object for each key</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="o">|</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">}</span>
<span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="o">|</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-literals"><a class="anchor" href="#hash-literals"></a><a class="link" href="#hash-literals">Hash Literals</a></h3>
<div class="paragraph">
<p>Use the Ruby 1.9 hash literal syntax when your hash keys are symbols.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:one</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">:two</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">:three</span> <span class="o">=&gt;</span> <span class="mi">3</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">one: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">two: </span><span class="mi">2</span><span class="p">,</span> <span class="ss">three: </span><span class="mi">3</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-literal-values"><a class="anchor" href="#hash-literal-values"></a><a class="link" href="#hash-literal-values">Hash Literal Values</a></h3>
<div class="paragraph">
<p>Use the Ruby 3.1 hash literal value syntax when your hash key and value are the same.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">one: </span><span class="n">one</span><span class="p">,</span> <span class="ss">two: </span><span class="n">two</span><span class="p">,</span> <span class="ss">three: </span><span class="n">three</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="n">one</span><span class="p">:,</span> <span class="n">two</span><span class="p">:,</span> <span class="ss">three: </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-literal-as-last-array-item"><a class="anchor" href="#hash-literal-as-last-array-item"></a><a class="link" href="#hash-literal-as-last-array-item">Hash Literal as Last Array Item</a></h3>
<div class="paragraph">
<p>Wrap hash literal in braces if it is a last array item.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">one: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">two: </span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{</span> <span class="ss">one: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">two: </span><span class="mi">2</span> <span class="p">}]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-mixed-hash-syntaxes"><a class="anchor" href="#no-mixed-hash-syntaxes"></a><a class="link" href="#no-mixed-hash-syntaxes">No Mixed Hash Syntaxes</a></h3>
<div class="paragraph">
<p>Don&#8217;t mix the Ruby 1.9 hash syntax with hash rockets in the same hash literal.
When you&#8217;ve got keys that are not symbols stick to the hash rockets syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="p">{</span> <span class="ss">a: </span><span class="mi">1</span><span class="p">,</span> <span class="s1">'b'</span> <span class="o">=&gt;</span> <span class="mi">2</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="p">{</span> <span class="ss">:a</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'b'</span> <span class="o">=&gt;</span> <span class="mi">2</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="avoid-hash-constructor"><a class="anchor" href="#avoid-hash-constructor"></a><a class="link" href="#avoid-hash-constructor">Avoid Hash[] constructor</a></h3>
<div class="paragraph">
<p><code>Hash::[]</code> was a pre-Ruby 2.1 way of constructing hashes from arrays of key-value pairs,
or from a flat list of keys and values. It has an obscure semantic and looks cryptic in code.
Since Ruby 2.1, <code>Enumerable#to_h</code> can be used to construct a hash from a list of key-value pairs,
and it should be preferred. Instead of <code>Hash[]</code> with a list of literal keys and values,
just a hash literal should be preferred.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Hash</span><span class="p">[</span><span class="n">ary</span><span class="p">]</span>
<span class="no">Hash</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="n">ary</span><span class="p">.</span><span class="nf">to_h</span>
<span class="p">{</span><span class="n">a</span> <span class="o">=&gt;</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=&gt;</span> <span class="n">d</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-key"><a class="anchor" href="#hash-key"></a><a class="link" href="#hash-key"><code>Hash#key?</code></a></h3>
<div class="paragraph">
<p>Use <code>Hash#key?</code> instead of <code>Hash#has_key?</code> and <code>Hash#value?</code> instead of <code>Hash#has_value?</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">has_key?</span><span class="p">(</span><span class="ss">:test</span><span class="p">)</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">has_value?</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">key?</span><span class="p">(</span><span class="ss">:test</span><span class="p">)</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">value?</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-each"><a class="anchor" href="#hash-each"></a><a class="link" href="#hash-each"><code>Hash#each</code></a></h3>
<div class="paragraph">
<p>Use <code>Hash#each_key</code> instead of <code>Hash#keys.each</code> and <code>Hash#each_value</code> instead of <code>Hash#values.each</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">keys</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="o">|</span> <span class="nb">p</span> <span class="n">k</span> <span class="p">}</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">values</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span> <span class="nb">p</span> <span class="n">v</span> <span class="p">}</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span> <span class="n">_v</span><span class="o">|</span> <span class="nb">p</span> <span class="n">k</span> <span class="p">}</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">_k</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span> <span class="nb">p</span> <span class="n">v</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">each_key</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="o">|</span> <span class="nb">p</span> <span class="n">k</span> <span class="p">}</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">each_value</span> <span class="p">{</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span> <span class="nb">p</span> <span class="n">v</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-fetch"><a class="anchor" href="#hash-fetch"></a><a class="link" href="#hash-fetch"><code>Hash#fetch</code></a></h3>
<div class="paragraph">
<p>Use <code>Hash#fetch</code> when dealing with hash keys that should be present.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">heroes</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">batman: </span><span class="s1">'Bruce Wayne'</span><span class="p">,</span> <span class="ss">superman: </span><span class="s1">'Clark Kent'</span> <span class="p">}</span>
<span class="c1"># bad - if we make a mistake we might not spot it right away</span>
<span class="n">heroes</span><span class="p">[</span><span class="ss">:batman</span><span class="p">]</span> <span class="c1"># =&gt; 'Bruce Wayne'</span>
<span class="n">heroes</span><span class="p">[</span><span class="ss">:supermann</span><span class="p">]</span> <span class="c1"># =&gt; nil</span>

<span class="c1"># good - fetch raises a KeyError making the problem obvious</span>
<span class="n">heroes</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="ss">:supermann</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-fetch-defaults"><a class="anchor" href="#hash-fetch-defaults"></a><a class="link" href="#hash-fetch-defaults"><code>Hash#fetch</code> defaults</a></h3>
<div class="paragraph">
<p>Introduce default values for hash keys via <code>Hash#fetch</code> as opposed to using custom logic.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">batman</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">name: </span><span class="s1">'Bruce Wayne'</span><span class="p">,</span> <span class="ss">is_evil: </span><span class="kp">false</span> <span class="p">}</span>

<span class="c1"># bad - if we just use || operator with falsey value we won't get the expected result</span>
<span class="n">batman</span><span class="p">[</span><span class="ss">:is_evil</span><span class="p">]</span> <span class="o">||</span> <span class="kp">true</span> <span class="c1"># =&gt; true</span>

<span class="c1"># good - fetch works correctly with falsey values</span>
<span class="n">batman</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="ss">:is_evil</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span> <span class="c1"># =&gt; false</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="use-hash-blocks"><a class="anchor" href="#use-hash-blocks"></a><a class="link" href="#use-hash-blocks">Use Hash Blocks</a></h3>
<div class="paragraph">
<p>Prefer the use of the block instead of the default value in <code>Hash#fetch</code> if the code that has to be evaluated may have side effects or be expensive.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">batman</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">name: </span><span class="s1">'Bruce Wayne'</span> <span class="p">}</span>

<span class="c1"># bad - if we use the default value, we eager evaluate it</span>
<span class="c1"># so it can slow the program down if done multiple times</span>
<span class="n">batman</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="ss">:powers</span><span class="p">,</span> <span class="n">obtain_batman_powers</span><span class="p">)</span> <span class="c1"># obtain_batman_powers is an expensive call</span>

<span class="c1"># good - blocks are lazy evaluated, so only triggered in case of KeyError exception</span>
<span class="n">batman</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="ss">:powers</span><span class="p">)</span> <span class="p">{</span> <span class="n">obtain_batman_powers</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-values-at-and-hash-fetch-values"><a class="anchor" href="#hash-values-at-and-hash-fetch-values"></a><a class="link" href="#hash-values-at-and-hash-fetch-values"><code>Hash#values_at</code> and <code>Hash#fetch_values</code></a></h3>
<div class="paragraph">
<p>Use <code>Hash#values_at</code> or <code>Hash#fetch_values</code> when you need to retrieve several values consecutively from a hash.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">email</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'email'</span><span class="p">]</span>
<span class="n">username</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'nickname'</span><span class="p">]</span>

<span class="c1"># bad</span>
<span class="n">keys</span> <span class="o">=</span> <span class="sx">%w[email nickname]</span><span class="p">.</span><span class="nf">freeze</span>
<span class="n">email</span><span class="p">,</span> <span class="n">username</span> <span class="o">=</span> <span class="n">keys</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">key</span><span class="o">|</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">email</span><span class="p">,</span> <span class="n">username</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">values_at</span><span class="p">(</span><span class="s1">'email'</span><span class="p">,</span> <span class="s1">'nickname'</span><span class="p">)</span>

<span class="c1"># also good</span>
<span class="n">email</span><span class="p">,</span> <span class="n">username</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">fetch_values</span><span class="p">(</span><span class="s1">'email'</span><span class="p">,</span> <span class="s1">'nickname'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-transform-methods"><a class="anchor" href="#hash-transform-methods"></a><a class="link" href="#hash-transform-methods"><code>Hash#transform_keys</code> and <code>Hash#transform_values</code></a></h3>
<div class="paragraph">
<p>Prefer <code>transform_keys</code> or <code>transform_values</code> over <code>each_with_object</code> or <code>map</code> when transforming just the keys or just the values of a hash.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="p">{</span><span class="ss">a: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">b: </span><span class="mi">2</span><span class="p">}.</span><span class="nf">each_with_object</span><span class="p">({})</span> <span class="p">{</span> <span class="o">|</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="n">h</span><span class="o">|</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">v</span> <span class="p">}</span>
<span class="p">{</span><span class="ss">a: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">b: </span><span class="mi">2</span><span class="p">}.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span> <span class="p">[</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="p">}.</span><span class="nf">to_h</span>

<span class="c1"># good</span>
<span class="p">{</span><span class="ss">a: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">b: </span><span class="mi">2</span><span class="p">}.</span><span class="nf">transform_values</span> <span class="p">{</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span> <span class="n">v</span> <span class="o">*</span> <span class="n">v</span> <span class="p">}</span>
<span class="p">{</span><span class="ss">a: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">b: </span><span class="mi">2</span><span class="p">}.</span><span class="nf">transform_keys</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="o">|</span> <span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ordered-hashes"><a class="anchor" href="#ordered-hashes"></a><a class="link" href="#ordered-hashes">Ordered Hashes</a></h3>
<div class="paragraph">
<p>Rely on the fact that as of Ruby 1.9 hashes are ordered.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-modifying-collections"><a class="anchor" href="#no-modifying-collections"></a><a class="link" href="#no-modifying-collections">No Modifying Collections</a></h3>
<div class="paragraph">
<p>Do not modify a collection while traversing it.</p>
</div>
</div>
<div class="sect2">
<h3 id="accessing-elements-directly"><a class="anchor" href="#accessing-elements-directly"></a><a class="link" href="#accessing-elements-directly">Accessing Elements Directly</a></h3>
<div class="paragraph">
<p>When accessing elements of a collection, avoid direct access via <code>[n]</code> by using an alternate form of the reader method if it is supplied.
This guards you from calling <code>[]</code> on <code>nil</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Regexp</span><span class="p">.</span><span class="nf">last_match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="no">Regexp</span><span class="p">.</span><span class="nf">last_match</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="provide-alternate-accessor-to-collections"><a class="anchor" href="#provide-alternate-accessor-to-collections"></a><a class="link" href="#provide-alternate-accessor-to-collections">Provide Alternate Accessor to Collections</a></h3>
<div class="paragraph">
<p>When providing an accessor for a collection, provide an alternate form to save users from checking for <code>nil</code> before accessing an element in the collection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">awesome_things</span>
  <span class="vi">@awesome_things</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">awesome_things</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">index</span> <span class="o">&amp;&amp;</span> <span class="vi">@awesome_things</span>
    <span class="vi">@awesome_things</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
  <span class="k">else</span>
    <span class="vi">@awesome_things</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="map-find-select-reduce-include-size"><a class="anchor" href="#map-find-select-reduce-include-size"></a><a class="link" href="#map-find-select-reduce-include-size"><code>map</code>/<code>find</code>/<code>select</code>/<code>reduce</code>/<code>include?</code>/<code>size</code></a></h3>
<div class="paragraph">
<p>Prefer <code>map</code> over <code>collect</code>, <code>find</code> over <code>detect</code>, <code>select</code> over <code>find_all</code>, <code>reduce</code> over <code>inject</code>, <code>include?</code> over <code>member?</code> and <code>size</code> over <code>length</code>.
This is not a hard requirement; if the use of the alias enhances readability, it&#8217;s ok to use it.
The rhyming methods are inherited from Smalltalk and are not common in other programming languages.
The reason the use of <code>select</code> is encouraged over <code>find_all</code> is that it goes together nicely with <code>reject</code> and its name is pretty self-explanatory.</p>
</div>
</div>
<div class="sect2">
<h3 id="count-vs-size"><a class="anchor" href="#count-vs-size"></a><a class="link" href="#count-vs-size"><code>count</code> vs <code>size</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>count</code> as a substitute for <code>size</code>.
For <code>Enumerable</code> objects other than <code>Array</code> it will iterate the entire collection in order to determine its size.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">some_hash</span><span class="p">.</span><span class="nf">count</span>

<span class="c1"># good</span>
<span class="n">some_hash</span><span class="p">.</span><span class="nf">size</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="flat-map"><a class="anchor" href="#flat-map"></a><a class="link" href="#flat-map"><code>flat_map</code></a></h3>
<div class="paragraph">
<p>Use <code>flat_map</code> instead of <code>map</code> + <code>flatten</code>.
This does not apply for arrays with a depth greater than 2, i.e. if <code>users.first.songs == ['a', ['b','c']]</code>, then use <code>map + flatten</code> rather than <code>flat_map</code>.
<code>flat_map</code> flattens the array by 1, whereas <code>flatten</code> flattens it all the way.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">all_songs</span> <span class="o">=</span> <span class="n">users</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:songs</span><span class="p">).</span><span class="nf">flatten</span><span class="p">.</span><span class="nf">uniq</span>

<span class="c1"># good</span>
<span class="n">all_songs</span> <span class="o">=</span> <span class="n">users</span><span class="p">.</span><span class="nf">flat_map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:songs</span><span class="p">).</span><span class="nf">uniq</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reverse-each"><a class="anchor" href="#reverse-each"></a><a class="link" href="#reverse-each"><code>reverse_each</code></a></h3>
<div class="paragraph">
<p>Prefer <code>reverse_each</code> to <code>reverse.each</code> because some classes that <code>include Enumerable</code> will provide an efficient implementation.
Even in the worst case where a class does not provide a specialized implementation, the general implementation inherited from <code>Enumerable</code> will be at least as efficient as using <code>reverse.each</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">array</span><span class="p">.</span><span class="nf">reverse</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">array</span><span class="p">.</span><span class="nf">reverse_each</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="object-yield-self-vs-object-then"><a class="anchor" href="#object-yield-self-vs-object-then"></a><a class="link" href="#object-yield-self-vs-object-then"><code>Object#yield_self</code> vs <code>Object#then</code></a></h3>
<div class="paragraph">
<p>The method <code>Object#then</code> is preferred over <code>Object#yield_self</code>, since the name <code>then</code> states the intention, not the behavior. This makes the resulting code easier to read.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">obj</span><span class="p">.</span><span class="nf">yield_self</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="p">.</span><span class="nf">do_something</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">obj</span><span class="p">.</span><span class="nf">then</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="p">.</span><span class="nf">do_something</span> <span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can read more about the rationale behind this guideline <a href="https://bugs.ruby-lang.org/issues/14594">here</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="slicing-with-ranges"><a class="anchor" href="#slicing-with-ranges"></a><a class="link" href="#slicing-with-ranges">Slicing with Ranges</a></h3>
<div class="paragraph">
<p>Slicing arrays with ranges to extract some of their elements (e.g <code>ary[2..5]</code>) is a popular technique. Below you&#8217;ll find a few small considerations to keep in mind when using it.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[0..-1]</code> in <code>ary[0..-1]</code> is redundant and simply synonymous with <code>ary</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - you're selecting all the elements of the array</span>
<span class="n">ary</span><span class="p">[</span><span class="mi">0</span><span class="o">..-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ary</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="kp">nil</span><span class="p">]</span>
<span class="n">ary</span><span class="p">[</span><span class="mi">0</span><span class="o">...</span><span class="kp">nil</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="n">ary</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Ruby 2.6 introduced endless ranges, which provide an easier way to describe a slice going all the way to the end of an array.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - hard to process mentally</span>
<span class="n">ary</span><span class="p">[</span><span class="mi">1</span><span class="o">..-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ary</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="kp">nil</span><span class="p">]</span>

<span class="c1"># good - easier to read and more concise</span>
<span class="n">ary</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Ruby 2.7 introduced beginless ranges, which are also handy in slicing. However, unlike the somewhat obscure <code>-1</code> in <code>ary[1..-1]</code>, the <code>0</code> in <code>ary[0..42]</code> is clear
as a starting point. In fact, changing it to <code>ary[..42]</code> could potentially make it less readable. Therefore, using code like <code>ary[0..42]</code>
is fine. On the other hand, <code>ary[nil..42]</code> should be replaced with <code>ary[..42]</code> or <code>arr[0..42]</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - hard to process mentally</span>
<span class="n">ary</span><span class="p">[</span><span class="kp">nil</span><span class="o">..</span><span class="mi">42</span><span class="p">]</span>

<span class="c1"># good - easier to read</span>
<span class="n">ary</span><span class="p">[</span><span class="o">..</span><span class="mi">42</span><span class="p">]</span>
<span class="n">ary</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">42</span><span class="p">]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="numbers"><a class="anchor" href="#numbers"></a><a class="link" href="#numbers">Numbers</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="underscores-in-numerics"><a class="anchor" href="#underscores-in-numerics"></a><a class="link" href="#underscores-in-numerics">Underscores in Numerics</a></h3>
<div class="paragraph">
<p>Add underscores to large numeric literals to improve their readability.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - how many 0s are there?</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">1000000</span>

<span class="c1"># good - much easier to parse for the human brain</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">1_000_000</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="numeric-literal-prefixes"><a class="anchor" href="#numeric-literal-prefixes"></a><a class="link" href="#numeric-literal-prefixes">Numeric Literal Prefixes</a></h3>
<div class="paragraph">
<p>Prefer lowercase letters for numeric literal prefixes.
<code>0o</code> for octal, <code>0x</code> for hexadecimal and <code>0b</code> for binary.
Do not use <code>0d</code> prefix for decimal literals.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">num</span> <span class="o">=</span> <span class="mo">01234</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="no">O1234</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="no">X12AB</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="no">B10101</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="no">D1234</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="n">d1234</span>

<span class="c1"># good - easier to separate digits from the prefix</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="n">o1234</span>
<span class="n">num</span> <span class="o">=</span> <span class="mh">0x12AB</span>
<span class="n">num</span> <span class="o">=</span> <span class="mb">0b10101</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">1234</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="integer-type-checking"><a class="anchor" href="#integer-type-checking"></a><a class="link" href="#integer-type-checking">Integer Type Checking</a></h3>
<div class="paragraph">
<p>Use <code>Integer</code> to check the type of an integer number.
Since <code>Fixnum</code> is platform-dependent, checking against it will return different results on 32-bit and 64-bit machines.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">timestamp</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_i</span>

<span class="c1"># bad</span>
<span class="n">timestamp</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Fixnum</span><span class="p">)</span>
<span class="n">timestamp</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Bignum</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">timestamp</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Integer</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="random-numbers"><a class="anchor" href="#random-numbers"></a><a class="link" href="#random-numbers">Random Numbers</a></h3>
<div class="paragraph">
<p>Prefer to use ranges when generating random numbers instead of integers with offsets, since it clearly states your intentions.
Imagine simulating a roll of a dice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">rand</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># good</span>
<span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">6</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="float-division"><a class="anchor" href="#float-division"></a><a class="link" href="#float-division">Float Division</a></h3>
<div class="paragraph">
<p>When performing float-division on two integers, either use <code>fdiv</code> or convert one-side integer to float.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">a</span><span class="p">.</span><span class="nf">to_f</span> <span class="o">/</span> <span class="n">b</span><span class="p">.</span><span class="nf">to_f</span>

<span class="c1"># good</span>
<span class="n">a</span><span class="p">.</span><span class="nf">to_f</span> <span class="o">/</span> <span class="n">b</span>
<span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">.</span><span class="nf">to_f</span>
<span class="n">a</span><span class="p">.</span><span class="nf">fdiv</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="float-comparison"><a class="anchor" href="#float-comparison"></a><a class="link" href="#float-comparison">Float Comparison</a></h3>
<div class="paragraph">
<p>Avoid (in)equality comparisons of floats as they are unreliable.</p>
</div>
<div class="paragraph">
<p>Floating point values are inherently inaccurate, and comparing them for exact equality is almost never the desired semantics. Comparison via the <code>==/!=</code> operators checks floating-point value representation to be exactly the same, which is very unlikely if you perform any arithmetic operations involving precision loss.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">x</span> <span class="o">==</span> <span class="mf">0.1</span>
<span class="n">x</span> <span class="o">!=</span> <span class="mf">0.1</span>

<span class="c1"># good - using BigDecimal</span>
<span class="n">x</span><span class="p">.</span><span class="nf">to_d</span> <span class="o">==</span> <span class="mf">0.1</span><span class="p">.</span><span class="nf">to_d</span>

<span class="c1"># good - not an actual float comparison</span>
<span class="n">x</span> <span class="o">==</span> <span class="no">Float</span><span class="o">::</span><span class="no">INFINITY</span>

<span class="c1"># good</span>
<span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">).</span><span class="nf">abs</span> <span class="o">&lt;</span> <span class="no">Float</span><span class="o">::</span><span class="no">EPSILON</span>

<span class="c1"># good</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">).</span><span class="nf">abs</span> <span class="o">&lt;</span> <span class="n">tolerance</span>

<span class="c1"># Or some other epsilon based type of comparison:</span>
<span class="c1"># https://www.embeddeduse.com/2019/08/26/qt-compare-two-floats/</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exponential-notation"><a class="anchor" href="#exponential-notation"></a><a class="link" href="#exponential-notation">Exponential Notation</a></h3>
<div class="paragraph">
<p>When using exponential notation for numbers, prefer using the normalized scientific notation, which uses a mantissa between 1 (inclusive) and 10 (exclusive). Omit the exponent altogether if it is zero.</p>
</div>
<div class="paragraph">
<p>The goal is to avoid confusion between powers of ten and exponential notation, as one quickly reading <code>10e7</code> could think it&#8217;s 10 to the power of 7 (one then 7 zeroes) when it&#8217;s actually 10 to the power of 8 (one then 8 zeroes). If you want 10 to the power of 7, you should do <code>1e7</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">power notation</th>
<th class="tableblock halign-left valign-top">exponential notation</th>
<th class="tableblock halign-left valign-top">output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 ** 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1e7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 ** 6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1e6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 ** 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10e6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000000</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>One could favor the alternative engineering notation, in which the exponent must always be a multiple of 3 for easy conversion to the thousand / million / &#8230;&#8203; system.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="mi">10</span><span class="n">e6</span>
<span class="mf">0.3e4</span>
<span class="mf">11.7e5</span>
<span class="mf">3.14e0</span>

<span class="c1"># good</span>
<span class="mi">1</span><span class="n">e7</span>
<span class="mi">3</span><span class="n">e3</span>
<span class="mf">1.17e6</span>
<span class="mf">3.14</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternative : engineering notation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="mf">3.2e7</span>
<span class="mf">0.1e5</span>
<span class="mi">12</span><span class="n">e4</span>

<span class="c1"># good</span>
<span class="mi">1</span><span class="n">e6</span>
<span class="mi">17</span><span class="n">e6</span>
<span class="mf">0.98e9</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="strings"><a class="anchor" href="#strings"></a><a class="link" href="#strings">Strings</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="string-interpolation"><a class="anchor" href="#string-interpolation"></a><a class="link" href="#string-interpolation">String Interpolation</a></h3>
<div class="paragraph">
<p>Prefer string interpolation and string formatting to string concatenation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">email_with_name</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="nf">name</span> <span class="o">+</span> <span class="s1">' &lt;'</span> <span class="o">+</span> <span class="n">user</span><span class="p">.</span><span class="nf">email</span> <span class="o">+</span> <span class="s1">'&gt;'</span>

<span class="c1"># good</span>
<span class="n">email_with_name</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">user</span><span class="p">.</span><span class="nf">name</span><span class="si">}</span><span class="s2"> &lt;</span><span class="si">#{</span><span class="n">user</span><span class="p">.</span><span class="nf">email</span><span class="si">}</span><span class="s2">&gt;"</span>

<span class="c1"># good</span>
<span class="n">email_with_name</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="s1">'%s &lt;%s&gt;'</span><span class="p">,</span> <span class="n">user</span><span class="p">.</span><span class="nf">name</span><span class="p">,</span> <span class="n">user</span><span class="p">.</span><span class="nf">email</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="consistent-string-literals"><a class="anchor" href="#consistent-string-literals"></a><a class="link" href="#consistent-string-literals">Consistent String Literals</a></h3>
<div class="paragraph">
<p>Adopt a consistent string literal quoting style.
There are two popular styles in the Ruby community, both of which are considered good - single quotes by default and double quotes by default.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The string literals in this guide are using single quotes by default.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="consistent-string-literals-single-quote"><a class="anchor" href="#consistent-string-literals-single-quote"></a><a class="link" href="#consistent-string-literals-single-quote">Single Quote</a></h4>
<div class="paragraph">
<p>Prefer single-quoted strings when you don&#8217;t need string interpolation or special symbols such as <code>\t</code>, <code>\n</code>, <code>'</code>, etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">name</span> <span class="o">=</span> <span class="s2">"Bozhidar"</span>

<span class="nb">name</span> <span class="o">=</span> <span class="s1">'De\'Andre'</span>

<span class="c1"># good</span>
<span class="nb">name</span> <span class="o">=</span> <span class="s1">'Bozhidar'</span>

<span class="nb">name</span> <span class="o">=</span> <span class="s2">"De'Andre"</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="consistent-string-literals-double-quote"><a class="anchor" href="#consistent-string-literals-double-quote"></a><a class="link" href="#consistent-string-literals-double-quote">Double Quote</a></h4>
<div class="paragraph">
<p>Prefer double-quotes unless your string literal contains " or escape characters you want to suppress.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">name</span> <span class="o">=</span> <span class="s1">'Bozhidar'</span>

<span class="n">sarcasm</span> <span class="o">=</span> <span class="s2">"I </span><span class="se">\"</span><span class="s2">like</span><span class="se">\"</span><span class="s2"> it."</span>

<span class="c1"># good</span>
<span class="nb">name</span> <span class="o">=</span> <span class="s2">"Bozhidar"</span>

<span class="n">sarcasm</span> <span class="o">=</span> <span class="s1">'I "like" it.'</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-character-literals"><a class="anchor" href="#no-character-literals"></a><a class="link" href="#no-character-literals">No Character Literals</a></h3>
<div class="paragraph">
<p>Don&#8217;t use the character literal syntax <code>?x</code>.
Since Ruby 1.9 it&#8217;s basically redundant - <code>?x</code> would be interpreted as <code>'x'</code> (a string with a single character in it).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">char</span> <span class="o">=</span> <span class="sc">?c</span>

<span class="c1"># good</span>
<span class="n">char</span> <span class="o">=</span> <span class="s1">'c'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="curlies-interpolate"><a class="anchor" href="#curlies-interpolate"></a><a class="link" href="#curlies-interpolate">Curlies Interpolate</a></h3>
<div class="paragraph">
<p>Don&#8217;t leave out <code>{}</code> around instance and global variables being interpolated into a string.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Person</span>
  <span class="nb">attr_reader</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">)</span>
    <span class="vi">@first_name</span> <span class="o">=</span> <span class="n">first_name</span>
    <span class="vi">@last_name</span> <span class="o">=</span> <span class="n">last_name</span>
  <span class="k">end</span>

  <span class="c1"># bad - valid, but awkward</span>
  <span class="k">def</span> <span class="nf">to_s</span>
    <span class="s2">"</span><span class="si">#@first_name</span><span class="s2"> </span><span class="si">#@last_name</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="c1"># good</span>
  <span class="k">def</span> <span class="nf">to_s</span>
    <span class="s2">"</span><span class="si">#{</span><span class="vi">@first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@last_name</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="vg">$global</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># bad</span>
<span class="nb">puts</span> <span class="s2">"$global = </span><span class="si">#$global</span><span class="s2">"</span>

<span class="c1"># good</span>
<span class="nb">puts</span> <span class="s2">"$global = </span><span class="si">#{</span><span class="vg">$global</span><span class="si">}</span><span class="s2">"</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-to-s"><a class="anchor" href="#no-to-s"></a><a class="link" href="#no-to-s">No <code>to_s</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>Object#to_s</code> on interpolated objects.
It&#8217;s called on them automatically.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">message</span> <span class="o">=</span> <span class="s2">"This is the </span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">."</span>

<span class="c1"># good</span>
<span class="n">message</span> <span class="o">=</span> <span class="s2">"This is the </span><span class="si">#{</span><span class="n">result</span><span class="si">}</span><span class="s2">."</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="concat-strings"><a class="anchor" href="#concat-strings"></a><a class="link" href="#concat-strings">String Concatenation</a></h3>
<div class="paragraph">
<p>Avoid using <code>String#+</code> when you need to construct large data chunks.
Instead, use <code>String#&lt;&lt;</code>.
Concatenation mutates the string instance in-place and is always faster than <code>String#+</code>, which creates a bunch of new string objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">html</span> <span class="o">=</span> <span class="s1">''</span>
<span class="n">html</span> <span class="o">+=</span> <span class="s1">'&lt;h1&gt;Page title&lt;/h1&gt;'</span>

<span class="n">paragraphs</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">paragraph</span><span class="o">|</span>
  <span class="n">html</span> <span class="o">+=</span> <span class="s2">"&lt;p&gt;</span><span class="si">#{</span><span class="n">paragraph</span><span class="si">}</span><span class="s2">&lt;/p&gt;"</span>
<span class="k">end</span>

<span class="c1"># good and also fast</span>
<span class="n">html</span> <span class="o">=</span> <span class="s1">''</span>
<span class="n">html</span> <span class="o">&lt;&lt;</span> <span class="s1">'&lt;h1&gt;Page title&lt;/h1&gt;'</span>

<span class="n">paragraphs</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">paragraph</span><span class="o">|</span>
  <span class="n">html</span> <span class="o">&lt;&lt;</span> <span class="s2">"&lt;p&gt;</span><span class="si">#{</span><span class="n">paragraph</span><span class="si">}</span><span class="s2">&lt;/p&gt;"</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dont-abuse-gsub"><a class="anchor" href="#dont-abuse-gsub"></a><a class="link" href="#dont-abuse-gsub">Don&#8217;t Abuse <code>gsub</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>String#gsub</code> in scenarios in which you can use a faster and more specialized alternative.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">url</span> <span class="o">=</span> <span class="s1">'http://example.com'</span>
<span class="n">str</span> <span class="o">=</span> <span class="s1">'lisp-case-rules'</span>

<span class="c1"># bad</span>
<span class="n">url</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="s1">'http://'</span><span class="p">,</span> <span class="s1">'https://'</span><span class="p">)</span>
<span class="n">str</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">url</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="s1">'http://'</span><span class="p">,</span> <span class="s1">'https://'</span><span class="p">)</span>
<span class="n">str</span><span class="p">.</span><span class="nf">tr</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="string-chars"><a class="anchor" href="#string-chars"></a><a class="link" href="#string-chars"><code>String#chars</code></a></h3>
<div class="paragraph">
<p>Prefer the use of <code>String#chars</code> over <code>String#split</code> with empty string or regexp literal argument.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These cases have the same behavior since Ruby 2.0.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">string</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sr">//</span><span class="p">)</span>
<span class="n">string</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">string</span><span class="p">.</span><span class="nf">chars</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sprintf"><a class="anchor" href="#sprintf"></a><a class="link" href="#sprintf"><code>sprintf</code></a></h3>
<div class="paragraph">
<p>Prefer the use of <code>sprintf</code> and its alias <code>format</code> over the fairly cryptic <code>String#%</code> method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="s1">'%d %d'</span> <span class="o">%</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="c1"># =&gt; '20 10'</span>

<span class="c1"># good</span>
<span class="nb">sprintf</span><span class="p">(</span><span class="s1">'%d %d'</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># =&gt; '20 10'</span>

<span class="c1"># good</span>
<span class="nb">sprintf</span><span class="p">(</span><span class="s1">'%&lt;first&gt;d %&lt;second&gt;d'</span><span class="p">,</span> <span class="ss">first: </span><span class="mi">20</span><span class="p">,</span> <span class="ss">second: </span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># =&gt; '20 10'</span>

<span class="nb">format</span><span class="p">(</span><span class="s1">'%d %d'</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># =&gt; '20 10'</span>

<span class="c1"># good</span>
<span class="nb">format</span><span class="p">(</span><span class="s1">'%&lt;first&gt;d %&lt;second&gt;d'</span><span class="p">,</span> <span class="ss">first: </span><span class="mi">20</span><span class="p">,</span> <span class="ss">second: </span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># =&gt; '20 10'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="named-format-tokens"><a class="anchor" href="#named-format-tokens"></a><a class="link" href="#named-format-tokens">Named Format Tokens</a></h3>
<div class="paragraph">
<p>When using named format string tokens, favor <code>%&lt;name&gt;s</code> over <code>%{name}</code> because it encodes information about the type of the value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">format</span><span class="p">(</span><span class="s1">'Hello, %{name}'</span><span class="p">,</span> <span class="ss">name: </span><span class="s1">'John'</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="nb">format</span><span class="p">(</span><span class="s1">'Hello, %&lt;name&gt;s'</span><span class="p">,</span> <span class="ss">name: </span><span class="s1">'John'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="heredoc-long-strings"><a class="anchor" href="#heredoc-long-strings"></a><a class="link" href="#heredoc-long-strings">Long Strings</a></h3>
<div class="paragraph">
<p>Break long strings into multiple lines but don&#8217;t concatenate them with <code>+</code>.
If you want to add newlines, use heredoc. Otherwise use <code>\</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="s2">"Lorem Ipsum is simply dummy text of the printing and typesetting industry. "</span> <span class="o">+</span>
<span class="s2">"Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, "</span> <span class="o">+</span>
<span class="s2">"when an unknown printer took a galley of type and scrambled it to make a type specimen book."</span>

<span class="c1"># good</span>
<span class="o">&lt;&lt;~</span><span class="no">LOREM</span><span class="sh">
  Lorem Ipsum is simply dummy text of the printing and typesetting industry.
  Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
  when an unknown printer took a galley of type and scrambled it to make a type specimen book.
</span><span class="no">LOREM</span>

<span class="c1"># good</span>
<span class="s2">"Lorem Ipsum is simply dummy text of the printing and typesetting industry. "</span><span class="p">\</span>
<span class="s2">"Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, "</span><span class="p">\</span>
<span class="s2">"when an unknown printer took a galley of type and scrambled it to make a type specimen book."</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heredocs"><a class="anchor" href="#heredocs"></a><a class="link" href="#heredocs">Heredocs</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="squiggly-heredocs"><a class="anchor" href="#squiggly-heredocs"></a><a class="link" href="#squiggly-heredocs">Squiggly Heredocs</a></h3>
<div class="paragraph">
<p>Use Ruby 2.3&#8217;s squiggly heredocs for nicely indented multi-line strings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - using Powerpack String#strip_margin</span>
<span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="no">RUBY</span><span class="p">.</span><span class="nf">strip_margin</span><span class="p">(</span><span class="s1">'|'</span><span class="p">)</span><span class="sh">
  |def test
  |  some_method
  |  other_method
  |end
</span><span class="no">RUBY</span>

<span class="c1"># also bad</span>
<span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="no">RUBY</span><span class="sh">
def test
  some_method
  other_method
end
</span><span class="no">RUBY</span>

<span class="c1"># good</span>
<span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">RUBY</span><span class="sh">
  def test
    some_method
    other_method
  end
</span><span class="no">RUBY</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="heredoc-delimiters"><a class="anchor" href="#heredoc-delimiters"></a><a class="link" href="#heredoc-delimiters">Heredoc Delimiters</a></h3>
<div class="paragraph">
<p>Use descriptive delimiters for heredocs.
Delimiters add valuable information about the heredoc content, and as an added bonus some editors can highlight code within heredocs if the correct delimiter is used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">END</span><span class="sh">
  def foo
    bar
  end
</span><span class="no">END</span>

<span class="c1"># good</span>
<span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">RUBY</span><span class="sh">
  def foo
    bar
  end
</span><span class="no">RUBY</span>

<span class="c1"># good</span>
<span class="n">code</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">SUMMARY</span><span class="sh">
  An imposing black structure provides a connection between the past and
  the future in this enigmatic adaptation of a short story by revered
  sci-fi author Arthur C. Clarke.
</span><span class="no">SUMMARY</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="heredoc-method-calls"><a class="anchor" href="#heredoc-method-calls"></a><a class="link" href="#heredoc-method-calls">Heredoc Method Calls</a></h3>
<div class="paragraph">
<p>Place method calls with heredoc receivers on the first line of the heredoc definition.
The bad form has significant potential for error if a new line is added or removed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">query</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">SQL</span><span class="sh">
  select foo from bar
</span><span class="no">SQL</span>
<span class="p">.</span><span class="nf">strip_indent</span>

<span class="c1"># good</span>
<span class="n">query</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">SQL</span><span class="p">.</span><span class="nf">strip_indent</span><span class="sh">
  select foo from bar
</span><span class="no">SQL</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="heredoc-argument-closing-parentheses"><a class="anchor" href="#heredoc-argument-closing-parentheses"></a><a class="link" href="#heredoc-argument-closing-parentheses">Heredoc Argument Closing Parentheses</a></h3>
<div class="paragraph">
<p>Place the closing parenthesis for method calls with heredoc arguments on the first line of the heredoc definition.
The bad form has potential for error if the new line before the closing parenthesis is removed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">foo</span><span class="p">(</span><span class="o">&lt;&lt;~</span><span class="no">SQL</span><span class="sh">
  select foo from bar
</span><span class="no">SQL</span>
<span class="p">)</span>

<span class="c1"># good</span>
<span class="n">foo</span><span class="p">(</span><span class="o">&lt;&lt;~</span><span class="no">SQL</span><span class="p">)</span><span class="sh">
  select foo from bar
</span><span class="no">SQL</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="date-time"><a class="anchor" href="#date-time"></a><a class="link" href="#date-time">Date &amp; Time</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="time-now"><a class="anchor" href="#time-now"></a><a class="link" href="#time-now"><code>Time.now</code></a></h3>
<div class="paragraph">
<p>Prefer <code>Time.now</code> over <code>Time.new</code> when retrieving the current system time.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-datetime"><a class="anchor" href="#no-datetime"></a><a class="link" href="#no-datetime">No <code>DateTime</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>DateTime</code> unless you need to account for historical calendar reform - and if you do, explicitly specify the <code>start</code> argument to clearly state your intentions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - uses DateTime for current time</span>
<span class="no">DateTime</span><span class="p">.</span><span class="nf">now</span>

<span class="c1"># good - uses Time for current time</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">now</span>

<span class="c1"># bad - uses DateTime for modern date</span>
<span class="no">DateTime</span><span class="p">.</span><span class="nf">iso8601</span><span class="p">(</span><span class="s1">'2016-06-29'</span><span class="p">)</span>

<span class="c1"># good - uses Date for modern date</span>
<span class="no">Date</span><span class="p">.</span><span class="nf">iso8601</span><span class="p">(</span><span class="s1">'2016-06-29'</span><span class="p">)</span>

<span class="c1"># good - uses DateTime with start argument for historical date</span>
<span class="no">DateTime</span><span class="p">.</span><span class="nf">iso8601</span><span class="p">(</span><span class="s1">'1751-04-23'</span><span class="p">,</span> <span class="no">Date</span><span class="o">::</span><span class="no">ENGLAND</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="regular-expressions"><a class="anchor" href="#regular-expressions"></a><a class="link" href="#regular-expressions">Regular Expressions</a></h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Some people, when confronted with a problem, think
"I know, I&#8217;ll use regular expressions." Now they have two problems.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Jamie Zawinski
</div>
</div>
<div class="sect2">
<h3 id="no-regexp-for-plaintext"><a class="anchor" href="#no-regexp-for-plaintext"></a><a class="link" href="#no-regexp-for-plaintext">Plain Text Search</a></h3>
<div class="paragraph">
<p>Don&#8217;t use regular expressions if you just need plain text search in string.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">foo</span> <span class="o">=</span> <span class="s1">'I am an example string'</span>

<span class="c1"># bad - using a regular expression is an overkill here</span>
<span class="n">foo</span> <span class="o">=~</span> <span class="sr">/example/</span>

<span class="c1"># good</span>
<span class="n">foo</span><span class="p">[</span><span class="s1">'example'</span><span class="p">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="regexp-string-index"><a class="anchor" href="#regexp-string-index"></a><a class="link" href="#regexp-string-index">Using Regular Expressions as String Indexes</a></h3>
<div class="paragraph">
<p>For simple constructions you can use regexp directly through string index.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">match</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="sr">/regexp/</span><span class="p">]</span>             <span class="c1"># get content of matched regexp</span>
<span class="n">first_group</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="sr">/text(grp)/</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># get content of captured group</span>
<span class="n">string</span><span class="p">[</span><span class="sr">/text (grp)/</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'replace'</span>  <span class="c1"># string =&gt; 'text replace'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="non-capturing-regexp"><a class="anchor" href="#non-capturing-regexp"></a><a class="link" href="#non-capturing-regexp">Prefer Non-capturing Groups</a></h3>
<div class="paragraph">
<p>Use non-capturing groups when you don&#8217;t use the captured result.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="sr">/(first|second)/</span>

<span class="c1"># good</span>
<span class="sr">/(?:first|second)/</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="do-not-mix-named-and-numbered-captures"><a class="anchor" href="#do-not-mix-named-and-numbered-captures"></a><a class="link" href="#do-not-mix-named-and-numbered-captures">Do not mix named and numbered captures</a></h3>
<div class="paragraph">
<p>Do not mix named captures and numbered captures in a Regexp literal.
Because numbered capture is ignored if they&#8217;re mixed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - There is no way to access `(BAR)` capturing.</span>
<span class="n">m</span> <span class="o">=</span> <span class="sr">/(?&lt;foo&gt;FOO)(BAR)/</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="s1">'FOOBAR'</span><span class="p">)</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="ss">:foo</span><span class="p">]</span> <span class="c1"># =&gt; "FOO"</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># =&gt; "FOO"</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>    <span class="c1"># =&gt; nil   - not "BAR"</span>

<span class="c1"># good - Both captures are accessible with names.</span>
<span class="n">m</span> <span class="o">=</span> <span class="sr">/(?&lt;foo&gt;FOO)(?&lt;bar&gt;BAR)/</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="s1">'FOOBAR'</span><span class="p">)</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="ss">:foo</span><span class="p">]</span> <span class="c1"># =&gt; "FOO"</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="ss">:bar</span><span class="p">]</span> <span class="c1"># =&gt; "BAR"</span>

<span class="c1"># good - `(?:BAR)` is non-capturing grouping.</span>
<span class="n">m</span> <span class="o">=</span> <span class="sr">/(?&lt;foo&gt;FOO)(?:BAR)/</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="s1">'FOOBAR'</span><span class="p">)</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="ss">:foo</span><span class="p">]</span> <span class="c1"># =&gt; "FOO"</span>

<span class="c1"># good - Both captures are accessible with numbers.</span>
<span class="n">m</span> <span class="o">=</span> <span class="sr">/(FOO)(BAR)/</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="s1">'FOOBAR'</span><span class="p">)</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># =&gt; "FOO"</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># =&gt; "BAR"</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="refer-named-regexp-captures-by-name"><a class="anchor" href="#refer-named-regexp-captures-by-name"></a><a class="link" href="#refer-named-regexp-captures-by-name">Refer named regexp captures by name</a></h3>
<div class="paragraph">
<p>Prefer using names to refer named regexp captures instead of numbers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">m</span> <span class="o">=</span> <span class="sr">/(?&lt;foo&gt;FOO)(?&lt;bar&gt;BAR)/</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="s1">'FOOBAR'</span><span class="p">)</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># =&gt; "FOO"</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># =&gt; "BAR"</span>

<span class="c1"># good</span>
<span class="n">m</span> <span class="o">=</span> <span class="sr">/(?&lt;foo&gt;FOO)(?&lt;bar&gt;BAR)/</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="s1">'FOOBAR'</span><span class="p">)</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="ss">:foo</span><span class="p">]</span> <span class="c1"># =&gt; "FOO"</span>
<span class="nb">p</span> <span class="n">m</span><span class="p">[</span><span class="ss">:bar</span><span class="p">]</span> <span class="c1"># =&gt; "BAR"</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-perl-regexp-last-matchers"><a class="anchor" href="#no-perl-regexp-last-matchers"></a><a class="link" href="#no-perl-regexp-last-matchers">Avoid Perl-style Last Regular Expression Group Matchers</a></h3>
<div class="paragraph">
<p>Don&#8217;t use the cryptic Perl-legacy variables denoting last regexp group matches (<code>$1</code>, <code>$2</code>, etc).
Use <code>Regexp.last_match(n)</code> instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="sr">/(regexp)/</span> <span class="o">=~</span> <span class="n">string</span>
<span class="o">...</span>

<span class="c1"># bad</span>
<span class="n">process</span> <span class="vg">$1</span>

<span class="c1"># good</span>
<span class="n">process</span> <span class="no">Regexp</span><span class="p">.</span><span class="nf">last_match</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-numbered-regexes"><a class="anchor" href="#no-numbered-regexes"></a><a class="link" href="#no-numbered-regexes">Avoid Numbered Groups</a></h3>
<div class="paragraph">
<p>Avoid using numbered groups as it can be hard to track what they contain.
Named groups can be used instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="sr">/(regexp)/</span> <span class="o">=~</span> <span class="n">string</span>
<span class="c1"># some code</span>
<span class="n">process</span> <span class="no">Regexp</span><span class="p">.</span><span class="nf">last_match</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="sr">/(?&lt;meaningful_var&gt;regexp)/</span> <span class="o">=~</span> <span class="n">string</span>
<span class="c1"># some code</span>
<span class="n">process</span> <span class="n">meaningful_var</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="limit-escapes"><a class="anchor" href="#limit-escapes"></a><a class="link" href="#limit-escapes">Limit Escapes</a></h3>
<div class="paragraph">
<p>Character classes have only a few special characters you should care about: <code>^</code>, <code>-</code>, <code>\</code>, <code>]</code>, so don&#8217;t escape <code>.</code> or brackets in <code>[]</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="caret-and-dollar-regexp"><a class="anchor" href="#caret-and-dollar-regexp"></a><a class="link" href="#caret-and-dollar-regexp">Caret and Dollar Regexp</a></h3>
<div class="paragraph">
<p>Be careful with <code>^</code> and <code>$</code> as they match start/end of line, not string endings.
If you want to match the whole string use: <code>\A</code> and <code>\z</code> (not to be confused with <code>\Z</code> which is the equivalent of <code>/\n?\z/</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">string</span> <span class="o">=</span> <span class="s2">"some injection</span><span class="se">\n</span><span class="s2">username"</span>
<span class="n">string</span><span class="p">[</span><span class="sr">/^username$/</span><span class="p">]</span>   <span class="c1"># matches</span>
<span class="n">string</span><span class="p">[</span><span class="sr">/\Ausername\z/</span><span class="p">]</span> <span class="c1"># doesn't match</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="multi-line-regexes"><a class="anchor" href="#multi-line-regexes"></a><a class="link" href="#multi-line-regexes">Multi-line Regular Expressions</a></h3>
<div class="paragraph">
<p>Use <code>x</code> (free-spacing) modifier for multi-line regexps.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
That&#8217;s known as <a href="https://www.regular-expressions.info/freespacing.html">free-spacing mode</a>. In this mode leading and trailing whitespace is ignored.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">regex</span> <span class="o">=</span> <span class="sr">/start\
\s\
(group)\
(?:alt1|alt2)\
end/</span>

<span class="c1"># good</span>
<span class="n">regexp</span> <span class="o">=</span> <span class="sr">/
  start
  \s
  (group)
  (?:alt1|alt2)
  end
/x</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="comment-regexes"><a class="anchor" href="#comment-regexes"></a><a class="link" href="#comment-regexes">Comment Complex Regular Expressions</a></h3>
<div class="paragraph">
<p>Use <code>x</code> modifier for complex regexps.
This makes them more readable and you can add some useful comments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">regexp</span> <span class="o">=</span> <span class="sr">/
  start         # some text
  \s            # white space char
  (group)       # first group
  (?:alt1|alt2) # some alternation
  end
/x</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gsub-blocks"><a class="anchor" href="#gsub-blocks"></a><a class="link" href="#gsub-blocks">Use <code>gsub</code> with a Block or a Hash for Complex Replacements</a></h3>
<div class="paragraph">
<p>For complex replacements <code>sub</code>/<code>gsub</code> can be used with a block or a hash.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">words</span> <span class="o">=</span> <span class="s1">'foo bar'</span>
<span class="n">words</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sr">/f/</span><span class="p">,</span> <span class="s1">'f'</span> <span class="o">=&gt;</span> <span class="s1">'F'</span><span class="p">)</span> <span class="c1"># =&gt; 'Foo bar'</span>
<span class="n">words</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="sr">/\w+/</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">word</span><span class="o">|</span> <span class="n">word</span><span class="p">.</span><span class="nf">capitalize</span> <span class="p">}</span> <span class="c1"># =&gt; 'Foo Bar'</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="percent-literals"><a class="anchor" href="#percent-literals"></a><a class="link" href="#percent-literals">Percent Literals</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="percent-q-shorthand"><a class="anchor" href="#percent-q-shorthand"></a><a class="link" href="#percent-q-shorthand"><code>%q</code> shorthand</a></h3>
<div class="paragraph">
<p>Use <code>%()</code> (it&#8217;s a shorthand for <code>%Q</code>) for single-line strings which require both interpolation and embedded double-quotes.
For multi-line strings, prefer heredocs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad (no interpolation needed)</span>
<span class="sx">%(&lt;div class="text"&gt;Some text&lt;/div&gt;)</span>
<span class="c1"># should be '&lt;div class="text"&gt;Some text&lt;/div&gt;'</span>

<span class="c1"># bad (no double-quotes)</span>
<span class="sx">%(This is #{quality} style)</span>
<span class="c1"># should be "This is #{quality} style"</span>

<span class="c1"># bad (multiple lines)</span>
<span class="sx">%(&lt;div&gt;\n&lt;span class="big"&gt;#{exclamation}&lt;/span&gt;\n&lt;/div&gt;)</span>
<span class="c1"># should be a heredoc.</span>

<span class="c1"># good (requires interpolation, has quotes, single line)</span>
<span class="sx">%(&lt;tr&gt;&lt;td class="name"&gt;#{name}&lt;/td&gt;)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="percent-q"><a class="anchor" href="#percent-q"></a><a class="link" href="#percent-q"><code>%q</code></a></h3>
<div class="paragraph">
<p>Avoid <code>%()</code> or the equivalent <code>%q()</code> unless you have a string with both <code>'</code> and <code>"</code> in it.
Regular string literals are more readable and should be preferred unless a lot of characters would have to be escaped in them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">name</span> <span class="o">=</span> <span class="sx">%q(Bruce Wayne)</span>
<span class="n">time</span> <span class="o">=</span> <span class="sx">%q(8 o'clock)</span>
<span class="n">question</span> <span class="o">=</span> <span class="sx">%q("What did you say?")</span>

<span class="c1"># good</span>
<span class="nb">name</span> <span class="o">=</span> <span class="s1">'Bruce Wayne'</span>
<span class="n">time</span> <span class="o">=</span> <span class="s2">"8 o'clock"</span>
<span class="n">question</span> <span class="o">=</span> <span class="s1">'"What did you say?"'</span>
<span class="n">quote</span> <span class="o">=</span> <span class="sx">%q(&lt;p class='quote'&gt;"What did you say?"&lt;/p&gt;)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="percent-r"><a class="anchor" href="#percent-r"></a><a class="link" href="#percent-r"><code>%r</code></a></h3>
<div class="paragraph">
<p>Use <code>%r</code> only for regular expressions matching <em>at least</em> one <code>/</code> character.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="sr">%r{</span><span class="se">\s</span><span class="sr">+}</span>

<span class="c1"># good</span>
<span class="sr">%r{^/(.*)$}</span>
<span class="sr">%r{^/blog/2011/(.*)$}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="percent-x"><a class="anchor" href="#percent-x"></a><a class="link" href="#percent-x"><code>%x</code></a></h3>
<div class="paragraph">
<p>Avoid the use of <code>%x</code> unless you&#8217;re going to execute a command with backquotes in it (which is rather unlikely).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">date</span> <span class="o">=</span> <span class="sx">%x(date)</span>

<span class="c1"># good</span>
<span class="n">date</span> <span class="o">=</span> <span class="sb">`date`</span>
<span class="n">echo</span> <span class="o">=</span> <span class="sx">%x(echo `date`)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="percent-s"><a class="anchor" href="#percent-s"></a><a class="link" href="#percent-s"><code>%s</code></a></h3>
<div class="paragraph">
<p>Avoid the use of <code>%s</code>.
It seems that the community has decided <code>:"some string"</code> is the preferred way to create a symbol with spaces in it.</p>
</div>
</div>
<div class="sect2">
<h3 id="percent-literal-braces"><a class="anchor" href="#percent-literal-braces"></a><a class="link" href="#percent-literal-braces">Percent Literal Braces</a></h3>
<div class="paragraph">
<p>Use the braces that are the most appropriate for the various kinds of percent literals.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>()</code> for string literals (<code>%q</code>, <code>%Q</code>).</p>
</li>
<li>
<p><code>[]</code> for array literals (<code>%w</code>, <code>%i</code>, <code>%W</code>, <code>%I</code>) as it is aligned with the standard array literals.</p>
</li>
<li>
<p><code>{}</code> for regexp literals (<code>%r</code>) since parentheses often appear inside regular expressions. That&#8217;s why a less common character with <code>{</code> is usually the best delimiter for <code>%r</code> literals.</p>
</li>
<li>
<p><code>()</code> for all other literals (e.g. <code>%s</code>, <code>%x</code>)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="sx">%q{"Test's king!", John said.}</span>

<span class="c1"># good</span>
<span class="sx">%q("Test's king!", John said.)</span>

<span class="c1"># bad</span>
<span class="sx">%w(one two three)</span>
<span class="sx">%i(one two three)</span>

<span class="c1"># good</span>
<span class="sx">%w[one two three]</span>
<span class="sx">%i[one two three]</span>

<span class="c1"># bad</span>
<span class="sr">%r((</span><span class="se">\w</span><span class="sr">+)-(</span><span class="se">\d</span><span class="sr">+))</span>
<span class="sr">%r{</span><span class="se">\w</span><span class="sr">{1,2}</span><span class="se">\d</span><span class="sr">{2,5}}</span>

<span class="c1"># good</span>
<span class="sr">%r{(</span><span class="se">\w</span><span class="sr">+)-(</span><span class="se">\d</span><span class="sr">+)}</span>
<span class="sr">%r|</span><span class="se">\w</span><span class="sr">{1,2}</span><span class="se">\d</span><span class="sr">{2,5}|</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="metaprogramming"><a class="anchor" href="#metaprogramming"></a><a class="link" href="#metaprogramming">Metaprogramming</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="no-needless-metaprogramming"><a class="anchor" href="#no-needless-metaprogramming"></a><a class="link" href="#no-needless-metaprogramming">No Needless Metaprogramming</a></h3>
<div class="paragraph">
<p>Avoid needless metaprogramming.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-monkey-patching"><a class="anchor" href="#no-monkey-patching"></a><a class="link" href="#no-monkey-patching">No Monkey Patching</a></h3>
<div class="paragraph">
<p>Do not mess around in core classes when writing libraries (do not monkey-patch them).</p>
</div>
</div>
<div class="sect2">
<h3 id="block-class-eval"><a class="anchor" href="#block-class-eval"></a><a class="link" href="#block-class-eval">Block <code>class_eval</code></a></h3>
<div class="paragraph">
<p>The block form of <code>class_eval</code> is preferable to the string-interpolated form.</p>
</div>
<div class="sect3">
<h4 id="class-eval-supply-location"><a class="anchor" href="#class-eval-supply-location"></a><a class="link" href="#class-eval-supply-location">Supply Location</a></h4>
<div class="paragraph">
<p>When you use the string-interpolated form, always supply <code>__FILE__</code> and <code>__LINE__</code>, so that your backtraces make sense:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="nb">class_eval</span> <span class="s1">'def use_relative_model_naming?; true; end'</span><span class="p">,</span> <span class="kp">__FILE__</span><span class="p">,</span> <span class="kp">__LINE__</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="class-eval-define_method"><a class="anchor" href="#class-eval-define_method"></a><a class="link" href="#class-eval-define_method"><code>define_method</code></a></h4>
<div class="paragraph">
<p><code>define_method</code> is preferable to <code>class_eval { def &#8230;&#8203; }</code></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="eval-comment-docs"><a class="anchor" href="#eval-comment-docs"></a><a class="link" href="#eval-comment-docs"><code>eval</code> Comment Docs</a></h3>
<div class="paragraph">
<p>When using <code>class_eval</code> (or other <code>eval</code>) with string interpolation, add a comment block showing its appearance if interpolated (a practice used in Rails code):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># from activesupport/lib/active_support/core_ext/string/output_safety.rb</span>
<span class="no">UNSAFE_STRING_METHODS</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">unsafe_method</span><span class="o">|</span>
  <span class="k">if</span> <span class="s1">'String'</span><span class="p">.</span><span class="nf">respond_to?</span><span class="p">(</span><span class="n">unsafe_method</span><span class="p">)</span>
    <span class="nb">class_eval</span> <span class="o">&lt;&lt;-</span><span class="no">EOT</span><span class="p">,</span> <span class="kp">__FILE__</span><span class="p">,</span> <span class="kp">__LINE__</span> <span class="o">+</span> <span class="mi">1</span><span class="sh">
      def </span><span class="si">#{</span><span class="n">unsafe_method</span><span class="si">}</span><span class="sh">(*params, &amp;block)       # def capitalize(*params, &amp;block)
        to_str.</span><span class="si">#{</span><span class="n">unsafe_method</span><span class="si">}</span><span class="sh">(*params, &amp;block)  #   to_str.capitalize(*params, &amp;block)
      end                                         # end

      def </span><span class="si">#{</span><span class="n">unsafe_method</span><span class="si">}</span><span class="sh">!(*params)              # def capitalize!(*params)
        @dirty = true                             #   @dirty = true
        super                                     #   super
      end                                         # end
</span><span class="no">    EOT</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-method-missing"><a class="anchor" href="#no-method-missing"></a><a class="link" href="#no-method-missing">No <code>method_missing</code></a></h3>
<div class="paragraph">
<p>Avoid using <code>method_missing</code> for metaprogramming because backtraces become messy, the behavior is not listed in <code>#methods</code>, and misspelled method calls might silently work, e.g. <code>nukes.luanch_state = false</code>.
Consider using delegation, proxy, or <code>define_method</code> instead.
If you must use <code>method_missing</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be sure to <a href="https://blog.marc-andre.ca/2010/11/15/methodmissing-politely/">also define <code>respond_to_missing?</code></a></p>
</li>
<li>
<p>Only catch methods with a well-defined prefix, such as <code>find_by_*</code>--make your code as assertive as possible.</p>
</li>
<li>
<p>Call <code>super</code> at the end of your statement</p>
</li>
<li>
<p>Delegate to assertive, non-magical methods:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="n">meth</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="k">if</span> <span class="sr">/^find_by_(?&lt;prop&gt;.*)/</span> <span class="o">=~</span> <span class="n">meth</span>
    <span class="c1"># ... lots of code to do a find_by</span>
  <span class="k">else</span>
    <span class="k">super</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="n">meth</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="k">if</span> <span class="sr">/^find_by_(?&lt;prop&gt;.*)/</span> <span class="o">=~</span> <span class="n">meth</span>
    <span class="n">find_by</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="k">super</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># best of all, though, would to define_method as each findable attribute is declared</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="prefer-public-send"><a class="anchor" href="#prefer-public-send"></a><a class="link" href="#prefer-public-send">Prefer <code>public_send</code></a></h3>
<div class="paragraph">
<p>Prefer <code>public_send</code> over <code>send</code> so as not to circumvent <code>private</code>/<code>protected</code> visibility.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># We have an ActiveModel Organization that includes concern Activatable</span>
<span class="k">module</span> <span class="nn">Activatable</span>
  <span class="kp">extend</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Concern</span>

  <span class="n">included</span> <span class="k">do</span>
    <span class="n">before_create</span> <span class="ss">:create_token</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">reset_token</span>
    <span class="c1"># some code</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">create_token</span>
    <span class="c1"># some code</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">activate!</span>
    <span class="c1"># some code</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Organization</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="kp">include</span> <span class="no">Activatable</span>
<span class="k">end</span>

<span class="n">linux_organization</span> <span class="o">=</span> <span class="no">Organization</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="c1"># bad - violates privacy</span>
<span class="n">linux_organization</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="ss">:reset_token</span><span class="p">)</span>
<span class="c1"># good - should throw an exception</span>
<span class="n">linux_organization</span><span class="p">.</span><span class="nf">public_send</span><span class="p">(</span><span class="ss">:reset_token</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="prefer-__send__"><a class="anchor" href="#prefer-__send__"></a><a class="link" href="#prefer-__send__">Prefer <code>__send__</code></a></h3>
<div class="paragraph">
<p>Prefer <code>__send__</code> over <code>send</code>, as <code>send</code> may overlap with existing methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="nb">require</span> <span class="s1">'socket'</span>

<span class="n">u1</span> <span class="o">=</span> <span class="no">UDPSocket</span><span class="p">.</span><span class="nf">new</span>
<span class="n">u1</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span><span class="s1">'127.0.0.1'</span><span class="p">,</span> <span class="mi">4913</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="no">UDPSocket</span><span class="p">.</span><span class="nf">new</span>
<span class="n">u2</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="s1">'127.0.0.1'</span><span class="p">,</span> <span class="mi">4913</span><span class="p">)</span>

<span class="c1"># bad - Won't send a message to the receiver object. Instead it will send a message via UDP socket.</span>
<span class="n">u2</span><span class="p">.</span><span class="nf">send</span> <span class="ss">:sleep</span><span class="p">,</span> <span class="mi">0</span>
<span class="c1"># good - Will actually send a message to the receiver object.</span>
<span class="n">u2</span><span class="p">.</span><span class="nf">__send__</span> <span class="o">...</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-documentation"><a class="anchor" href="#api-documentation"></a><a class="link" href="#api-documentation">API Documentation</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="yard"><a class="anchor" href="#yard"></a><a class="link" href="#yard">YARD</a></h3>
<div class="paragraph">
<p>Use <a href="https://yardoc.org/">YARD</a> and its conventions for API documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-block-comments"><a class="anchor" href="#no-block-comments"></a><a class="link" href="#no-block-comments">RD (Block) Comments</a></h3>
<div class="paragraph">
<p>Don&#8217;t use block comments.
They cannot be preceded by whitespace and are not as easy to spot as regular comments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="cm">=begin
comment line
another comment line
=end</span>

<span class="c1"># good</span>
<span class="c1"># comment line</span>
<span class="c1"># another comment line</span></code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">From Perl&#8217;s POD to RD</div>
<div class="paragraph">
<p>This is not really a block comment syntax, but more of
an attempt to emulate Perl&#8217;s <a href="https://perldoc.perl.org/perlpod.html">POD</a> documentation system.</p>
</div>
<div class="paragraph">
<p>There&#8217;s an <a href="https://github.com/uwabami/rdtool">rdtool</a> for Ruby that&#8217;s pretty similar to POD.
Basically <code>rdtool</code> scans a file for <code>=begin</code> and <code>=end</code> pairs, and extracts
the text between them all. This text is assumed to be documentation in
<a href="https://github.com/uwabami/rdtool/blob/master/doc/rd-draft.rd">RD format</a>.
You can read more about it
<a href="https://ruby-doc.com/docs/ProgrammingRuby/html/rdtool.html">here</a>.</p>
</div>
<div class="paragraph">
<p>RD predated the rise of RDoc and YARD and was effectively obsoleted by them.<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gemfile-and-gemspec"><a class="anchor" href="#gemfile-and-gemspec"></a><a class="link" href="#gemfile-and-gemspec">Gemfile and Gemspec</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="no-ruby-version-in-the-gemspec"><a class="anchor" href="#no-ruby-version-in-the-gemspec"></a><a class="link" href="#no-ruby-version-in-the-gemspec">No <code>RUBY_VERSION</code> in the gemspec</a></h3>
<div class="paragraph">
<p>The gemspec should not contain <code>RUBY_VERSION</code> as a condition to switch dependencies.
<code>RUBY_VERSION</code> is determined by <code>rake release</code>, so users may end up with wrong dependency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Gem</span><span class="o">::</span><span class="no">Specification</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="k">if</span> <span class="no">RUBY_VERSION</span> <span class="o">&gt;=</span> <span class="s1">'2.5'</span>
    <span class="n">s</span><span class="p">.</span><span class="nf">add_dependency</span> <span class="s1">'gem_a'</span>
  <span class="k">else</span>
    <span class="n">s</span><span class="p">.</span><span class="nf">add_dependency</span> <span class="s1">'gem_b'</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Fix by either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Post-install messages.</p>
</li>
<li>
<p>Add both gems as dependency (if permissible).</p>
</li>
<li>
<p>If development dependencies, move to Gemfile.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="add_dependency_vs_add_runtime_dependency"><a class="anchor" href="#add_dependency_vs_add_runtime_dependency"></a><a class="link" href="#add_dependency_vs_add_runtime_dependency"><code>add_dependency</code> vs <code>add_runtime_dependency</code></a></h3>
<div class="paragraph">
<p>Prefer <code>add_dependency</code> over <code>add_runtime_dependency</code> because <code>add_dependency</code> is considered soft-deprecated
and the Bundler team recommends <code>add_dependency</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Gem</span><span class="o">::</span><span class="no">Specification</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">add_runtime_dependency</span> <span class="s1">'gem_a'</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="no">Gem</span><span class="o">::</span><span class="no">Specification</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">add_dependency</span> <span class="s1">'gem_a'</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/rubygems/rubygems/issues/7799#issuecomment-2192720316" class="bare">https://github.com/rubygems/rubygems/issues/7799#issuecomment-2192720316</a> for details.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="misc"><a class="anchor" href="#misc"></a><a class="link" href="#misc">Misc</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="no-flip-flops"><a class="anchor" href="#no-flip-flops"></a><a class="link" href="#no-flip-flops">No Flip-flops</a></h3>
<div class="paragraph">
<p>Avoid the use of <a href="https://en.wikipedia.org/wiki/Flip-flop_(programming)">flip-flop operators</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-non-nil-checks"><a class="anchor" href="#no-non-nil-checks"></a><a class="link" href="#no-non-nil-checks">No non-<code>nil</code> Checks</a></h3>
<div class="paragraph">
<p>Don&#8217;t do explicit non-<code>nil</code> checks unless you&#8217;re dealing with boolean values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="o">!</span><span class="n">something</span><span class="p">.</span><span class="nf">nil?</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">something</span> <span class="o">!=</span> <span class="kp">nil</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">something</span>

<span class="c1"># good - dealing with a boolean</span>
<span class="k">def</span> <span class="nf">value_set?</span>
  <span class="o">!</span><span class="vi">@some_boolean</span><span class="p">.</span><span class="nf">nil?</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="global-stdout"><a class="anchor" href="#global-stdout"></a><a class="link" href="#global-stdout">Global Input/Output Streams</a></h3>
<div class="paragraph">
<p>Use <code>$stdout/$stderr/$stdin</code> instead of <code>STDOUT/STDERR/STDIN</code>.
<code>STDOUT/STDERR/STDIN</code> are constants, and while you can actually reassign (possibly to redirect some stream) constants in Ruby, you&#8217;ll get an interpreter warning if you do so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">STDOUT</span><span class="p">.</span><span class="nf">puts</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>

<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">out: </span><span class="no">STDOUT</span><span class="p">,</span> <span class="ss">key: </span><span class="n">value</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">m</span><span class="p">(</span><span class="n">out</span> <span class="o">=</span> <span class="no">STDOUT</span><span class="p">)</span>
  <span class="n">out</span><span class="p">.</span><span class="nf">puts</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="vg">$stdout</span><span class="p">.</span><span class="nf">puts</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>

<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">out: </span><span class="vg">$stdout</span><span class="p">,</span> <span class="ss">key: </span><span class="n">value</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">m</span><span class="p">(</span><span class="n">out</span> <span class="o">=</span> <span class="vg">$stdout</span><span class="p">)</span>
  <span class="n">out</span><span class="p">.</span><span class="nf">puts</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The only valid use-case for the stream constants is obtaining references to the original streams (assuming you&#8217;ve redirected some of the global vars).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="warn"><a class="anchor" href="#warn"></a><a class="link" href="#warn">Warn</a></h3>
<div class="paragraph">
<p>Use <code>warn</code> instead of <code>$stderr.puts</code>.
Apart from being more concise and clear, <code>warn</code> allows you to suppress warnings if you need to (by setting the warn level to 0 via <code>-W0</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="vg">$stderr</span><span class="p">.</span><span class="nf">puts</span> <span class="s1">'This is a warning!'</span>

<span class="c1"># good</span>
<span class="nb">warn</span> <span class="s1">'This is a warning!'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="array-join"><a class="anchor" href="#array-join"></a><a class="link" href="#array-join"><code>Array#join</code></a></h3>
<div class="paragraph">
<p>Prefer the use of <code>Array#join</code> over the fairly cryptic <code>Array#*</code> with a string argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="sx">%w[one two three]</span> <span class="o">*</span> <span class="s1">', '</span>
<span class="c1"># =&gt; 'one, two, three'</span>

<span class="c1"># good</span>
<span class="sx">%w[one two three]</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">', '</span><span class="p">)</span>
<span class="c1"># =&gt; 'one, two, three'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="array-coercion"><a class="anchor" href="#array-coercion"></a><a class="link" href="#array-coercion">Array Coercion</a></h3>
<div class="paragraph">
<p>Use <code>Array()</code> instead of explicit <code>Array</code> check or <code>[*var]</code>, when dealing with a variable you want to treat as an Array, but you&#8217;re not certain it&#8217;s an array.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">paths</span><span class="p">]</span> <span class="k">unless</span> <span class="n">paths</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Array</span><span class="p">)</span>
<span class="n">paths</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span> <span class="n">do_something</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">}</span>

<span class="c1"># bad (always creates a new Array instance)</span>
<span class="p">[</span><span class="o">*</span><span class="n">paths</span><span class="p">].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span> <span class="n">do_something</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">}</span>

<span class="c1"># good (and a bit more readable)</span>
<span class="no">Array</span><span class="p">(</span><span class="n">paths</span><span class="p">).</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">path</span><span class="o">|</span> <span class="n">do_something</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ranges-or-between"><a class="anchor" href="#ranges-or-between"></a><a class="link" href="#ranges-or-between">Ranges or <code>between</code></a></h3>
<div class="paragraph">
<p>Use ranges or <code>Comparable#between?</code> instead of complex comparison logic when possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1000</span> <span class="o">&amp;&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">2000</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="p">(</span><span class="mi">1000</span><span class="o">..</span><span class="mi">2000</span><span class="p">).</span><span class="nf">include?</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">do_something</span> <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="nf">between?</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="predicate-methods"><a class="anchor" href="#predicate-methods"></a><a class="link" href="#predicate-methods">Predicate Methods</a></h3>
<div class="paragraph">
<p>Prefer the use of predicate methods to explicit comparisons with <code>==</code>.
Numeric comparisons are OK.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kp">nil</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="nf">even?</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="nf">odd?</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="nf">nil?</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="nf">zero?</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bitwise-predicate-methods"><a class="anchor" href="#bitwise-predicate-methods"></a><a class="link" href="#bitwise-predicate-methods">Bitwise Predicate Methods</a></h3>
<div class="paragraph">
<p>Prefer bitwise predicate methods over direct comparison operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - checks any set bits</span>
<span class="p">(</span><span class="n">variable</span> <span class="o">&amp;</span> <span class="n">flags</span><span class="p">).</span><span class="nf">positive?</span>

<span class="c1"># good</span>
<span class="n">variable</span><span class="p">.</span><span class="nf">anybits?</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>

<span class="c1"># bad - checks all set bits</span>
<span class="p">(</span><span class="n">variable</span> <span class="o">&amp;</span> <span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="n">flags</span>

<span class="c1"># good</span>
<span class="n">variable</span><span class="p">.</span><span class="nf">allbits?</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>

<span class="c1"># bad - checks no set bits</span>
<span class="p">(</span><span class="n">variable</span> <span class="o">&amp;</span> <span class="n">flags</span><span class="p">).</span><span class="nf">zero?</span>
<span class="p">(</span><span class="n">variable</span> <span class="o">&amp;</span> <span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

<span class="c1"># good</span>
<span class="n">variable</span><span class="p">.</span><span class="nf">nobits?</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-cryptic-perlisms"><a class="anchor" href="#no-cryptic-perlisms"></a><a class="link" href="#no-cryptic-perlisms">No Cryptic Perlisms</a></h3>
<div class="paragraph">
<p>Avoid using Perl-style special variables (like <code>$:</code>, <code>$;</code>, etc).
They are quite cryptic and their use in anything but one-liner scripts is discouraged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="vg">$:</span><span class="p">.</span><span class="nf">unshift</span> <span class="no">File</span><span class="p">.</span><span class="nf">dirname</span><span class="p">(</span><span class="kp">__FILE__</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="vg">$LOAD_PATH</span><span class="p">.</span><span class="nf">unshift</span> <span class="no">File</span><span class="p">.</span><span class="nf">dirname</span><span class="p">(</span><span class="kp">__FILE__</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the human-friendly aliases provided by the <code>English</code> library if required.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">print</span> <span class="vg">$'</span><span class="p">,</span> <span class="vg">$$</span>

<span class="c1"># good</span>
<span class="nb">require</span> <span class="s1">'English'</span>
<span class="nb">print</span> <span class="vg">$POSTMATCH</span><span class="p">,</span> <span class="vg">$PID</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="use-require_relative-whenever-possible"><a class="anchor" href="#use-require_relative-whenever-possible"></a><a class="link" href="#use-require_relative-whenever-possible">Use <code>require_relative</code> whenever possible</a></h3>
<div class="paragraph">
<p>For all your internal dependencies, you should use <code>require_relative</code>.
Use of <code>require</code> should be reserved for external dependencies</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">require</span> <span class="s1">'set'</span>
<span class="nb">require</span> <span class="s1">'my_gem/spec/helper'</span>
<span class="nb">require</span> <span class="s1">'my_gem/lib/something'</span>

<span class="c1"># good</span>
<span class="nb">require</span> <span class="s1">'set'</span>
<span class="nb">require_relative</span> <span class="s1">'helper'</span>
<span class="nb">require_relative</span> <span class="s1">'../lib/something'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This way is more expressive (making clear which dependency is internal or not) and more efficient (as <code>require_relative</code> doesn&#8217;t have to try all of <code>$LOAD_PATH</code> contrary to <code>require</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="always-warn"><a class="anchor" href="#always-warn"></a><a class="link" href="#always-warn">Always Warn</a></h3>
<div class="paragraph">
<p>Write <code>ruby -w</code> safe code.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-optional-hash-params"><a class="anchor" href="#no-optional-hash-params"></a><a class="link" href="#no-optional-hash-params">No Optional Hash Params</a></h3>
<div class="paragraph">
<p>Avoid hashes as optional parameters.
Does the method do too much? (Object initializers are exceptions for this rule).</p>
</div>
</div>
<div class="sect2">
<h3 id="instance-vars"><a class="anchor" href="#instance-vars"></a><a class="link" href="#instance-vars">Instance Vars</a></h3>
<div class="paragraph">
<p>Use module instance variables instead of global variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="vg">$foo_bar</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># good</span>
<span class="k">module</span> <span class="nn">Foo</span>
  <span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span>
    <span class="nb">attr_accessor</span> <span class="ss">:bar</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">Foo</span><span class="p">.</span><span class="nf">bar</span> <span class="o">=</span> <span class="mi">1</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="optionparser"><a class="anchor" href="#optionparser"></a><a class="link" href="#optionparser"><code>OptionParser</code></a></h3>
<div class="paragraph">
<p>Use <code>OptionParser</code> for parsing complex command line options and <code>ruby -s</code> for trivial command line options.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-param-mutations"><a class="anchor" href="#no-param-mutations"></a><a class="link" href="#no-param-mutations">No Param Mutations</a></h3>
<div class="paragraph">
<p>Do not mutate parameters unless that is the purpose of the method.</p>
</div>
</div>
<div class="sect2">
<h3 id="three-is-the-number-thou-shalt-count"><a class="anchor" href="#three-is-the-number-thou-shalt-count"></a><a class="link" href="#three-is-the-number-thou-shalt-count">Three is the Number Thou Shalt Count</a></h3>
<div class="paragraph">
<p>Avoid more than three levels of block nesting.</p>
</div>
</div>
<div class="sect2">
<h3 id="functional-code"><a class="anchor" href="#functional-code"></a><a class="link" href="#functional-code">Functional Code</a></h3>
<div class="paragraph">
<p>Code in a functional way, avoiding mutation when that makes sense.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">a</span> <span class="o">=</span> <span class="p">[];</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">}</span>   <span class="c1"># bad</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">}</span>             <span class="c1"># good</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">{};</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">17</span> <span class="p">}</span>                <span class="c1"># bad</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">reduce</span><span class="p">({})</span> <span class="p">{</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">17</span><span class="p">;</span> <span class="n">h</span> <span class="p">}</span>        <span class="c1"># good</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">each_with_object</span><span class="p">({})</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="p">,</span> <span class="n">h</span><span class="o">|</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">17</span> <span class="p">}</span> <span class="c1"># good</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-explicit-rb-to-require"><a class="anchor" href="#no-explicit-rb-to-require"></a><a class="link" href="#no-explicit-rb-to-require">No explicit <code>.rb</code> to <code>require</code></a></h3>
<div class="paragraph">
<p>Omit the <code>.rb</code> extension for filename passed to <code>require</code> and <code>require_relative</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the extension is omitted, Ruby tries adding '.rb', '.so', and so on to the name
until found. If the file named cannot be found, a <code>LoadError</code> will be raised.
There is an edge case where <code>foo.so</code> file is loaded instead of a <code>LoadError</code>
if <code>foo.so</code> file exists when <code>require 'foo.rb'</code> will be changed to <code>require 'foo'</code>,
but that seems harmless.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="nb">require</span> <span class="s1">'foo.rb'</span>
<span class="nb">require_relative</span> <span class="s1">'../foo.rb'</span>

<span class="c1"># good</span>
<span class="nb">require</span> <span class="s1">'foo'</span>
<span class="nb">require</span> <span class="s1">'foo.so'</span>
<span class="nb">require_relative</span> <span class="s1">'../foo'</span>
<span class="nb">require_relative</span> <span class="s1">'../foo.so'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="avoid-tap"><a class="anchor" href="#avoid-tap"></a><a class="link" href="#avoid-tap">Avoid <code>tap</code></a></h3>
<div class="paragraph">
<p>The method <code>tap</code> can be helpful for debugging purposes but should not be left in production code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Config</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">path</span><span class="p">).</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">check</span> <span class="k">if</span> <span class="n">check</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">config</span> <span class="o">=</span> <span class="no">Config</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="n">config</span><span class="p">.</span><span class="nf">check</span> <span class="k">if</span> <span class="n">check</span>
<span class="n">config</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is simpler and more efficient.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tools"><a class="anchor" href="#tools"></a><a class="link" href="#tools">Tools</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here are some tools to help you automatically check Ruby code against this guide.</p>
</div>
<div class="sect2">
<h3 id="rubocop"><a class="anchor" href="#rubocop"></a><a class="link" href="#rubocop">RuboCop</a></h3>
<div class="paragraph">
<p><a href="https://github.com/rubocop/rubocop">RuboCop</a> is a Ruby static code analyzer and formatter, based on this style guide.
RuboCop already covers a significant portion of the guide and has <a href="https://docs.rubocop.org/rubocop/integration_with_other_tools.html">plugins</a> for most popular Ruby editors and IDEs.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
RuboCop&#8217;s cops (code checks) have links to the guidelines that they are based on, as part of their metadata.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="rubymine"><a class="anchor" href="#rubymine"></a><a class="link" href="#rubymine">RubyMine</a></h3>
<div class="paragraph">
<p><a href="https://www.jetbrains.com/ruby/">RubyMine</a>'s code inspections are <a href="https://confluence.jetbrains.com/display/RUBYDEV/RubyMine+Inspections">partially based</a> on this guide.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="history"><a class="anchor" href="#history"></a><a class="link" href="#history">History</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide started its life in 2011 as an internal company Ruby coding guidelines (written by <a href="https://github.com/bbatsov">Bozhidar Batsov</a>).
Bozhidar had always been bothered as a Ruby developer about one thing  - Python developers had a great programming style reference (<a href="https://www.python.org/dev/peps/pep-0008/">PEP-8</a>) and Rubyists never got an official guide, documenting Ruby coding style and best practices.
Bozhidar firmly believed that style matters.
He also believed that a great hacker community, such as Ruby has, should be quite capable of producing this coveted document.
The rest is history&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>At some point Bozhidar decided that the work he was doing might be interesting to members of the Ruby community in general and that the world had little need for another internal company guideline.
But the world could certainly benefit from a community-driven and community-sanctioned set of practices, idioms and style prescriptions for Ruby programming.</p>
</div>
<div class="paragraph">
<p>Bozhidar served as the guide&#8217;s only editor for a few years, before a team of editors was formed once the project transitioned to RuboCop HQ.</p>
</div>
<div class="paragraph">
<p>Since the inception of the guide we&#8217;ve received a lot of feedback from members of the exceptional Ruby community around the world.
Thanks for all the suggestions and the support! Together we can make a resource beneficial to each and every Ruby developer out there.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sources-of-inspiration"><a class="anchor" href="#sources-of-inspiration"></a><a class="link" href="#sources-of-inspiration">Sources of Inspiration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Many people, books, presentations, articles and other style guides influenced the community Ruby style guide. Here are some of them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/The_Elements_of_Style">"The Elements of Style"</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/The_Elements_of_Programming_Style">"The Elements of Programming Style"</a></p>
</li>
<li>
<p><a href="https://www.python.org/dev/peps/pep-0008/">The Python Style Guide (PEP-8)</a></p>
</li>
<li>
<p><a href="https://pragprog.com/book/ruby4/programming-ruby-1-9-2-0">"Programming Ruby"</a></p>
</li>
<li>
<p><a href="https://www.amazon.com/Ruby-Programming-Language-David-Flanagan/dp/0596516177">"The Ruby Programming Language"</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing"><a class="anchor" href="#contributing"></a><a class="link" href="#contributing">Contributing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The guide is still a work in progress - some guidelines are lacking examples, some guidelines don&#8217;t have examples that illustrate them clearly enough.
Improving such guidelines is a great (and simple way) to help the Ruby community!</p>
</div>
<div class="paragraph">
<p>In due time these issues will (hopefully) be addressed - just keep them in mind for now.</p>
</div>
<div class="paragraph">
<p>Nothing written in this guide is set in stone.
It&#8217;s our desire to work together with everyone interested in Ruby coding style, so that we could ultimately create a resource that will be beneficial to the entire Ruby community.</p>
</div>
<div class="paragraph">
<p>Feel free to open tickets or send pull requests with improvements.
Thanks in advance for your help!</p>
</div>
<div class="paragraph">
<p>You can also support the project (and RuboCop) with financial contributions via one of the following platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/sponsors/bbatsov">GitHub Sponsors</a></p>
</li>
<li>
<p><a href="https://ko-fi.com/bbatsov">ko-fi</a></p>
</li>
<li>
<p><a href="https://www.patreon.com/bbatsov">Patreon</a></p>
</li>
<li>
<p><a href="https://www.paypal.me/bbatsov">PayPal</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="how-to-contribute"><a class="anchor" href="#how-to-contribute"></a><a class="link" href="#how-to-contribute">How to Contribute?</a></h3>
<div class="paragraph">
<p>It&#8217;s easy, just follow the contribution guidelines below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://help.github.com/articles/fork-a-repo">Fork</a> <a href="https://github.com/rubocop/ruby-style-guide">rubocop/ruby-style-guide</a> on GitHub</p>
</li>
<li>
<p>Make your feature addition or bug fix in a feature branch.</p>
</li>
<li>
<p>Include a <a href="https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">good description</a> of your changes</p>
</li>
<li>
<p>Push your feature branch to GitHub</p>
</li>
<li>
<p>Send a <a href="https://help.github.com/articles/using-pull-requests">Pull Request</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="colophon"><a class="anchor" href="#colophon"></a><a class="link" href="#colophon">Colophon</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide is written in <a href="https://asciidoc.org/">AsciiDoc</a> and is published as HTML using <a href="https://asciidoctor.org/">AsciiDoctor</a>.
The HTML version of the guide is hosted on GitHub Pages.</p>
</div>
<div class="paragraph">
<p>Originally the guide was written in Markdown, but was converted to AsciiDoc in 2019.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="license"><a class="anchor" href="#license"></a><a class="link" href="#license">License</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="https://i.creativecommons.org/l/by/3.0/88x31.png" alt="Creative Commons License"></span> This work is licensed under a <a href="https://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spread-the-word"><a class="anchor" href="#spread-the-word"></a><a class="link" href="#spread-the-word">Spread the Word</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A community-driven style guide is of little use to a community that doesn&#8217;t know about its existence.
Tweet about the guide, share it with your friends and colleagues.
Every comment, suggestion or opinion we get makes the guide just a little bit better.
And we want to have the best possible guide, don&#8217;t we?</p>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Occasionally we might suggest to the reader to consider some alternatives, though.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. *BSD/Solaris/Linux/macOS users are covered by default, Windows users have to be extra careful.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. According to this <a href="https://en.wikipedia.org/wiki/Ruby_Document_format">Wikipedia article</a> the format used to be popular until the early 2000s when it was superseded by RDoc.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-03-31 18:25:47 UTC
</div>
</div>
</body>
</html>